/*! For license information please see 18f85342c3ce4312bd0a.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[107],{0:e=>{e.exports=React},11:e=>{e.exports=ReactDOM},114:(e,t,a)=>{a.d(t,{g:()=>r});const r=e=>{if(!e.requestContext.user)return 0;let t=e.requestContext.query&&e.requestContext.query.catalogid&&+e.requestContext.query.catalogid||0;return 0===t&&(t=e.requestContext.user.catalogId&&+e.requestContext.user.catalogId||0),t}},1641:(e,t,a)=>{var r=a(5);a(4);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){(0,r.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const i={modules:{},dataActions:{}},l=(e,t)=>{if(i.dataActions[e]=t,!i.dataActions[e].default)throw new Error("Data action path "+e+" does not have a default export");i.dataActions[e].default.prototype.RegistrationId=e,i.dataActions[e].default.prototype.id&&(i.dataActions[i.dataActions[e].default.prototype.id]=e)};i.modules["eve-catalog-checker"]={c:()=>a(1642),$type:"contentModule",da:[{name:"cart",path:"@msdyn365-commerce/global-state/dist/lib/data-actions/cart-state-data-action",runOn:0},{name:"customerInformation",path:"@msdyn365-commerce-modules/retail-actions/dist/lib/get-customer",runOn:0},{name:"orderTemplates",path:"@msdyn365-commerce-modules/retail-actions/dist/lib/order-templates/get-order-templates-preview",runOn:1}],iNM:!1,ns:"__local__",n:"eve-catalog-checker",p:"__local__",pdp:"",md:"src/modules/eve-catalog-checker"};{const e="@msdyn365-commerce-modules/retail-actions/dist/lib/get-customer";let t=a(24);l(e,t)}{const e="@msdyn365-commerce-modules/retail-actions/dist/lib/order-templates/get-order-templates-preview";let t=a(118);l(e,t)}{const e="@msdyn365-commerce/global-state/dist/lib/data-actions/cart-state-data-action";let t=a(56);l(e,t)}window.__bindings__=window.__bindings__||{},window.__bindings__.modules=n(n({},window.__bindings__.modules||{}),i.modules),window.__bindings__.dataActions=n(n({},window.__bindings__.dataActions||{}),i.dataActions);const s={};s["__local__|__local__|modules|eve-catalog-checker|eve-catalog-checker"]={c:()=>a(1643),cn:"__local__-__local__-eve-catalog-checker"},window.__bindings__=window.__bindings__||{},window.__bindings__.viewDictionary=n(n({},window.__bindings__.viewDictionary||{}),s)},1642:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});a(15),a(12),a(51),a(4),a(9),a(22),a(23),a(21);var r=a(10),o=a(0),n=a(114),i=a(13),l=a(6),s=a(2),c=a(1);class d extends o.PureComponent{constructor(e){super(e),this.state={displayModal:!1,isInitialized:!1},console.log("Init")}get catalogId(){return(0,n.g)(this.props.context.actionContext)}get cartCatalogId(){const{data:{cart:{result:e}}}=this.props;return null!=e&&e.cart&&l.ArrayExtensions.hasElements(e.cart.CartLines)&&e.cart.CartLines[0].CatalogId||0}componentDidMount(){this.catalogId>0&&0!==this.cartCatalogId&&this.cartCatalogId!==this.catalogId&&this.setState({displayModal:!0})}_doesLinkHaveCatalogIdQueryParam(e){return e.toLowerCase().indexOf(d._catalogIdQueryParamKey)>-1}_rebuildLinkWithCatalogIdQueryParam(e){let t="?";return e.indexOf(t)>-1&&(t="&"),`${e}${t}${d._catalogIdQueryParamKey}=${this.catalogId}`}_addAnchorToTagChildren(e){e.nextElementSibling&&this._addAnchorToTagChildren(e.nextElementSibling);for(let t=0;t<e.children.length;t++){const a=e.children[t];if(a.children.length&&this._addAnchorToTagChildren(a),"a"===a.tagName.toLowerCase()){const e=a;this._doesLinkHaveCatalogIdQueryParam(e.href)||(e.href=this._rebuildLinkWithCatalogIdQueryParam(e.href))}}}_isExternalUrl(e){return new URL(e).origin!==location.origin}_initialize(){if(this.catalogId>0){const e=document.querySelectorAll("a");e.forEach((e=>{e.href&&(this._isExternalUrl(e)||this._doesLinkHaveCatalogIdQueryParam(e.href)||(e.href=this._rebuildLinkWithCatalogIdQueryParam(e.href)))}));const t=document.querySelectorAll('button[aria-expanded="false"]');t.forEach((e=>{e.addEventListener("click",(()=>{setTimeout((()=>{this._addAnchorToTagChildren(e.parentElement)}),50)}))}))}}_renderCatalogPromptModal(){const{resources:{catalogPromptBodyText:e,catalogPromptHeading:t,changeCatalogButtonText:a}}=this.props;return o.createElement(c.Modal,{isOpen:this.state.displayModal},o.createElement(c.ModalHeader,null,o.createElement("span",null,t)),o.createElement(c.ModalBody,null,e),o.createElement(c.ModalFooter,null,o.createElement(c.Button,{className:"change-catalog-button"},o.createElement("a",{href:this._buildUrlToNewCatalog()},a))))}_buildUrlToNewCatalog(){if(!s.default.isBrowser)return"";const e=new URL(window.location.href);return e.searchParams.set(d._catalogIdQueryParamKey,this.cartCatalogId.toString()),`${e.pathname}${e.search}`}render(){return!this.state.isInitialized&&s.default.isBrowser&&(this.setState({isInitialized:!0}),this._initialize()),o.createElement(o.Fragment,null,this._renderCatalogPromptModal())}}d._catalogIdQueryParamKey="catalogid",(0,r.Cg)([i.EW],d.prototype,"catalogId",null),(0,r.Cg)([i.EW],d.prototype,"cartCatalogId",null);const u=d},1643:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var r=a(0);const o=e=>r.createElement("div",{className:"row"})}},e=>{e.O(0,[0,3,2,4,5,6,7,8,9],(()=>{return t=1641,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=18f85342c3ce4312bd0a.bundle.js.map