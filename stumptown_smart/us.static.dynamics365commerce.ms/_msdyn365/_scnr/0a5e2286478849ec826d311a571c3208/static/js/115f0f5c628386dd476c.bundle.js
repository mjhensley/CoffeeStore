/*! For license information please see 115f0f5c628386dd476c.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[37],{1044:(e,t,n)=>{n.r(t),n.d(t,{ProductComponent:()=>b,default:()=>h});var r=n(5),a=(n(37),n(3),n(15),n(12),n(18),n(51),n(9),n(4),n(22),n(23),n(21),n(17)),i=n(2),o=n(6),c=n(1),l=n(0),s=n.n(l);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){var t,n,r;if(!e||!e.AttributeValues)return null;const a=e.AttributeValues.find((e=>{var t;return(null===(t=e.KeyName)||void 0===t?void 0:t.toLocaleLowerCase())===o.DimensionTypes.color}));if(!a)return null;const i=null!==(t=null===(n=a.Swatches)||void 0===n?void 0:n.find((e=>!0===e.IsDefault)))&&void 0!==t?t:null===(r=a.Swatches)||void 0===r?void 0:r[0];return null!=i?i:null}function d(e,t,n){const r=new URL(e,t.request.apiSettings.baseUrl);r.search?r.search+=`&${n}`:r.search+=n;const a=new URL(r.href);return a.pathname+r.search}function p(e){return e?s().createElement("div",{className:"msc-product__unit-of-measure"},s().createElement("span",null,e)):null}function g(e,t,n,r,a,i){const o=v(a,null!=i?i:"");return`${null!=e?e:""} ${null!=t?t:""} ${f(n,r)}${o?` ${o}`:""}`}function f(e,t){if(e&&t){const n=e.toFixed(2);return(0,c.format)(t||"",n,"5")}return""}function v(e,t){return e&&t?(0,c.format)(t||"",e):""}function y(e,t,n,r,i,o,c,l,u,m,d){const p={BasePrice:r,AdjustedPrice:i,CustomerContextualPrice:i};return s().createElement(a.PriceComponent,{context:e,id:n,typeName:t,data:{price:p},savingsText:o,freePriceText:c,originalPriceText:l,isPriceMinMaxEnabled:m,priceResources:d})}function P(e,t,n,r,a,o){var c;if(!n||!t||!e)return null;const l=null==o||null===(c=o.app.config)||void 0===c?void 0:c.placeholderImageName,u=l;let m=r;u&&r&&(m=`${r},${u}`);const d={src:n,altText:a||"",fallBackSrc:m},p={gridSettings:t,imageSettings:e};return p.imageSettings.cropFocalRegion=!0,s().createElement(i.Image,Object.assign({requestContext:null==o?void 0:o.actionContext.requestContext},d,p,{loadFailureBehavior:"empty",bypassHideOnFailure:!0}))}const b=i.msdyn365Commerce.createComponentOverride("Product",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({component:e=>{var t,n,r,i;let{data:u,context:b,imageSettings:h,savingsText:C,freePriceText:E,originalPriceText:S,currentPriceText:I,ratingAriaLabel:x,ratingCountAriaLabel:N,allowBack:w,typeName:T,id:_,telemetryContent:O,quickViewButton:D,isEnabledProductDescription:U,isPriceMinMaxEnabled:A,priceResources:R,inventoryLabel:V,dimensionAvailabilities:L,swatchItemAriaLabel:j}=e;const k=u.product;let $=(0,o.getProductPageUrlSync)(null!==(t=null==k?void 0:k.Name)&&void 0!==t?t:"",null!==(n=null==k?void 0:k.RecordId)&&void 0!==n?n:Number.MIN_VALUE,b.actionContext,void 0);w&&($=d($,b,"back=true"));const M=null!==(r=function(e,t){const n=e,r=n.app.config.dimensionToPreSelectInProductCard;if(r===o.DimensionTypes.none)return null==t?void 0:t.PrimaryImageUrl;const a=m(t);return a&&o.ArrayExtensions.hasElements(a.ProductImageUrls)?(0,o.generateImageUrl)(a.ProductImageUrls[0],e.request.apiSettings):null==t?void 0:t.PrimaryImageUrl}(b,k))&&void 0!==r?r:null==k?void 0:k.PrimaryImageUrl,q=null!==(i=function(e,t,n){const r=e,a=r.app.config.dimensionToPreSelectInProductCard;if(a===o.DimensionTypes.none)return t;const i=m(n);if(!i||!i.SwatchValue)return t;const c=`color=${i.SwatchValue}`;return d(t,e,c)}(b,$,k))&&void 0!==i?i:$,[B,F]=(0,l.useState)(q),[H,K]=(0,l.useState)(M);s().useEffect((()=>{F(q),K(M)}),[$,q,M]);const[W]=(0,l.useState)(new o.Dictionary),z=b.app.config.enableStockCheck,G=s().useCallback(((e,t)=>{const n=t.dimensionType;if(W.setValue(n,t),o.StringExtensions.isNullOrWhitespace(t.value))return;const r=`${n}=${t.value}`;let a="";if(B.includes(n)){const t=new URL(B,e.request.apiSettings.baseUrl);t.searchParams.delete(n),a=d(t.toString(),b,r)}else a=d(B,b,r);if(F(a),n===o.DimensionTypes.color){const n=o.ArrayExtensions.hasElements(t.productImageUrls)?t.productImageUrls[0]:void 0,r=(0,o.generateImageUrl)(n,e.request.apiSettings);K(r)}}),[W,b,B]);if(!k)return null;const J=(0,c.getPayloadObject)("click",O,"",k.RecordId.toString()),Q=(0,c.getTelemetryAttributes)(O,J),X=b.app.config&&"buyboxAndBrowse"===b.app.config.unitOfMeasureDisplayType;return s().createElement(s().Fragment,null,U?s().createElement("a",Object.assign({href:B,onClick:(0,c.onTelemetryClick)(O,J,k.Name),"aria-label":g(k.Name,b.cultureFormatter.formatCurrency(k.Price),k.AverageRating,x,k.TotalRatings,N),className:"msc-product"},Q),s().createElement("div",{className:"msc-product__image__description"},s().createElement("div",{className:"msc-product__image"},P(h,b.request.gridSettings,H,k.PrimaryImageUrl,k.Name,b)),s().createElement("div",{className:"msc-product__title_description"},s().createElement("h5",{className:"msc-product__title__text"},k.Name),y(b,T,_,k.BasePrice,k.Price,C,E,S,I,A,R),X&&p(k.DefaultUnitOfMeasure),(ee=k.Description,s().createElement("p",{className:"msc-product__text"},ee))))):s().createElement("a",Object.assign({href:B,onClick:(0,c.onTelemetryClick)(O,J,k.Name),"aria-label":g(k.Name,b.cultureFormatter.formatCurrency(k.Price),k.AverageRating,x),className:"msc-product"},Q),s().createElement("div",{className:"msc-product__image"},P(h,b.request.gridSettings,H,k.PrimaryImageUrl,k.Name,b)),s().createElement("div",{className:"msc-product__details"},s().createElement("h5",{className:"msc-product__title"},k.Name),y(b,T,_,k.BasePrice,k.Price,C,E,S,I),X&&p(k.DefaultUnitOfMeasure))),(Z=k.AttributeValues,Z?s().createElement("div",{className:"msc-product__dimensions"},Z.map((e=>{var t,n,r,i;const l=null!==(t=null===(n=e.KeyName)||void 0===n?void 0:n.toLocaleLowerCase())&&void 0!==t?t:"";if(!function(e){const t=b,n=t.app.config.dimensionsInProductCard;return o.ArrayExtensions.hasElements(n)&&!n.includes(o.DimensionTypes.none)&&n.includes(e.toLocaleLowerCase())}(l))return null;const u=b,m=u.app.config.dimensionToPreSelectInProductCard,d=l,p=null!==(r=null===(i=e.Swatches)||void 0===i?void 0:i.map((t=>{var n,r,a,i;return{itemId:`${null!==(n=e.RecordId)&&void 0!==n?n:""}-${l}-${null!==(r=t.SwatchValue)&&void 0!==r?r:""}`,value:null!==(a=t.SwatchValue)&&void 0!==a?a:"",dimensionType:d,colorHexCode:t.SwatchColorHexCode,imageUrl:t.SwatchImageUrl,productImageUrls:t.ProductImageUrls,isDefault:t.IsDefault,swatchItemAriaLabel:j?(0,c.format)(j,d):"",isDisabled:z&&(null==L||null===(i=L.find((e=>{var n;return e.value===(null!==(n=t.SwatchValue)&&void 0!==n?n:"")})))||void 0===i?void 0:i.isDisabled)}})))&&void 0!==r?r:[];return m!==o.DimensionTypes.none&&o.ArrayExtensions.hasElements(p)&&!p.some((e=>e.isDefault))&&d===o.DimensionTypes.color&&(p[0].isDefault=!0),s().createElement(a.ProductComponentSwatchComponent,{context:b,swatches:p,onSelectDimension:G,key:e.RecordId})}))):null),!b.app.config.hideRating&&function(e,t,n,r,i,o,c){if(!r)return null;const l=(null==i?void 0:i.toString())||void 0,u=f(r,o),m=v(Number(l),c);return s().createElement(a.RatingComponent,{context:e,id:n,typeName:t,avgRating:r,ratingCount:l,readOnly:!0,ariaLabel:u,ratingCountAriaLabel:m,data:{}})}(b,T,_,k.AverageRating,k.TotalRatings,x,N),(Y=V,Y&&""!==Y?s().createElement("div",{className:"msc-product__availability"},s().createElement("span",null,Y)):null),D&&function(e,t){if(null===e)return;const n=W.getValues().map((e=>({DimensionTypeValue:(0,o.convertDimensionTypeToProductDimensionType)(e.dimensionType),DimensionValue:{RecordId:0,Value:e.value}})));return s().cloneElement(e,{selectedProductId:t,selectedDimensions:n})}(D,k.RecordId));var Y,Z,ee}},{})),h=b},1045:(e,t,n)=>{n.r(t),n.d(t,{ProductComponent:()=>h,default:()=>C});var r=n(5),a=(n(37),n(3),n(15),n(12),n(18),n(51),n(9),n(4),n(22),n(23),n(21),n(17)),i=n(2),o=n(14),c=n(6),l=n(1),s=n(0),u=n.n(s);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t){var n,r;if(!t||!t.AttributeValues)return null;const a=e,i=a.app.config.dimensionToPreSelectInProductCard,o=null===(n=t.AttributeValues.find((e=>{var t;return(null===(t=e.KeyName)||void 0===t?void 0:t.toLocaleLowerCase())===i})))||void 0===n?void 0:n.Swatches;if(!c.ArrayExtensions.hasElements(o))return null;const l=null!==(r=o.find((e=>!0===e.IsDefault)))&&void 0!==r?r:o[0];return l}function p(e,t,n){const r=new URL(e,t.request.apiSettings.baseUrl);r.search?r.search+=`&${n}`:r.search+=n;const a=new URL(r.href);return a.pathname+r.search}function g(e){return e?u().createElement("div",{className:"msc-product__unit-of-measure"},u().createElement("span",null,e)):null}function f(e,t,n,r,a,i){const o=y(a,null!=i?i:"");return`${null!=e?e:""} ${null!=t?t:""} ${v(n,r)}${o?` ${o}`:""}`}function v(e,t){if(e&&t){const n=e.toFixed(2);return(0,l.format)(t||"",n,"5")}return""}function y(e,t){return e&&t?(0,l.format)(t||"",e):""}function P(e,t,n,r,i,c,l,s,m,d,p){const g={ProductTypeValue:r.IsMasterProduct?o.ProductType.Master:o.ProductType.Standalone},f=null!=p?p:{BasePrice:r.BasePrice,AdjustedPrice:r.Price,CustomerContextualPrice:r.Price,MaxVariantPrice:r.MaxVariantPrice?r.MaxVariantPrice:r.Price,MinVariantPrice:r.MinVariantPrice?r.MinVariantPrice:r.Price};return u().createElement(a.PriceComponent,{context:e,id:n,typeName:t,product:g,data:{price:f},savingsText:i,freePriceText:c,originalPriceText:l,isPriceMinMaxEnabled:m,priceResources:d})}function b(e,t,n,r,a,o){var c;if(!n||!t||!e)return null;const l=null==o||null===(c=o.app.config)||void 0===c?void 0:c.placeholderImageName,s=l;let m=r;s&&r&&(m=`${r},${s}`);const d={src:n,altText:a||"",fallBackSrc:m},p={gridSettings:t,imageSettings:e};return p.imageSettings.cropFocalRegion=!0,u().createElement(i.Image,Object.assign({requestContext:null==o?void 0:o.actionContext.requestContext},d,p,{loadFailureBehavior:"empty",bypassHideOnFailure:!0}))}const h=i.msdyn365Commerce.createComponentOverride("Product",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({component:e=>{var t,n,r,o;let{data:m,context:h,imageSettings:C,savingsText:E,freePriceText:S,originalPriceText:I,currentPriceText:x,ratingAriaLabel:N,ratingCountAriaLabel:w,allowBack:T,typeName:_,id:O,telemetryContent:D,quickViewButton:U,productComparisonButton:A,isEnabledProductDescription:R,isPriceMinMaxEnabled:V,priceResources:L,inventoryLabel:j,dimensionAvailabilities:k,swatchItemAriaLabel:$}=e;const M=m.product,q=m.productPrice;let B=(0,c.getProductPageUrlSync)(null!==(t=null==M?void 0:M.Name)&&void 0!==t?t:"",null!==(n=null==M?void 0:M.RecordId)&&void 0!==n?n:Number.MIN_VALUE,h.actionContext,void 0);T&&(B=p(B,h,"back=true"));const F=null!==(r=function(e,t){const n=d(e,t),r=null==n?void 0:n.ProductImageUrls;return c.ArrayExtensions.hasElements(r)?(0,c.generateImageUrl)(r[0],e.request.apiSettings):null==t?void 0:t.PrimaryImageUrl}(h,M))&&void 0!==r?r:null==M?void 0:M.PrimaryImageUrl,H=null!==(o=function(e,t,n){const r=d(e,n);if(null==r||!r.SwatchValue)return t;const a=e,i=a.app.config.dimensionToPreSelectInProductCard,o=encodeURIComponent(r.SwatchValue),c=`${i}=${o}`;return p(t,e,c)}(h,B,M))&&void 0!==o?o:B,[K,W]=(0,s.useState)(H),[z,G]=(0,s.useState)(F);u().useEffect((()=>{W(H),G(F)}),[B,H,F]);const[J]=(0,s.useState)(new c.Dictionary),Q=h.app.config.enableStockCheck,X=h,Y=X.app.config.dimensionToPreSelectInProductCard,Z=u().useCallback(((e,t)=>{const n=t.dimensionType;if(J.setValue(n,t),c.StringExtensions.isNullOrWhitespace(t.value))return;const r=`${n}=${t.value}`;let a="";if(K.includes(n)){const t=new URL(K,e.request.apiSettings.baseUrl);t.searchParams.delete(n),a=p(t.toString(),h,r)}else a=p(K,h,r);if(W(a),n===Y){const n=c.ArrayExtensions.hasElements(t.productImageUrls)?t.productImageUrls[0]:void 0,r=(0,c.generateImageUrl)(n,e.request.apiSettings);G(r)}}),[J,h,K]);if(!M)return null;const ee=(0,l.getPayloadObject)("click",D,"",M.RecordId.toString()),te=(0,l.getTelemetryAttributes)(D,ee),ne=h.app.config&&"buyboxAndBrowse"===h.app.config.unitOfMeasureDisplayType;return u().createElement(u().Fragment,null,R?u().createElement("a",Object.assign({href:K,onClick:(0,l.onTelemetryClick)(D,ee,M.Name),"aria-label":f(M.Name,h.cultureFormatter.formatCurrency(M.Price),M.AverageRating,N,M.TotalRatings,w),className:"msc-product"},te),u().createElement("div",{className:"msc-product__image__description"},u().createElement("div",{className:"msc-product__image"},b(C,h.request.gridSettings,z,M.PrimaryImageUrl,M.Name,h)),u().createElement("div",{className:"msc-product__title_description"},u().createElement("h2",{className:"msc-product__title__text"},M.Name),P(h,_,O,M,E,S,I,x,V,L,q),ne&&g(M.DefaultUnitOfMeasure),(ie=M.Description,u().createElement("p",{className:"msc-product__text"},ie))))):u().createElement("a",Object.assign({href:K,onClick:(0,l.onTelemetryClick)(D,ee,M.Name),"aria-label":f(M.Name,h.cultureFormatter.formatCurrency(M.Price),M.AverageRating,N),className:"msc-product"},te),u().createElement("div",{className:"msc-product__image"},b(C,h.request.gridSettings,z,M.PrimaryImageUrl,M.Name,h)),u().createElement("div",{className:"msc-product__details"},u().createElement("h2",{className:"msc-product__title"},M.Name),P(h,_,O,M,E,S,I,x,V,L,q),ne&&g(M.DefaultUnitOfMeasure))),(ae=M.AttributeValues,ae?u().createElement("div",{className:"msc-product__dimensions"},ae.map((e=>{var t,n,r,i;const o=null!==(t=null===(n=e.KeyName)||void 0===n?void 0:n.toLocaleLowerCase())&&void 0!==t?t:"";if(!function(e){const t=h,n=t.app.config.dimensionsInProductCard;return c.ArrayExtensions.hasElements(n)&&!n.includes(c.DimensionTypes.none)&&n.includes(e.toLocaleLowerCase())}(o))return null;const s=h,m=s.app.config.dimensionToPreSelectInProductCard,d=o,p=null!==(r=null===(i=e.Swatches)||void 0===i?void 0:i.map((t=>{var n,r,a,i;return{itemId:`${null!==(n=e.RecordId)&&void 0!==n?n:""}-${o}-${null!==(r=t.SwatchValue)&&void 0!==r?r:""}`,value:null!==(a=t.SwatchValue)&&void 0!==a?a:"",dimensionType:d,colorHexCode:t.SwatchColorHexCode,imageUrl:t.SwatchImageUrl,productImageUrls:t.ProductImageUrls,isDefault:t.IsDefault,swatchItemAriaLabel:$?(0,l.format)($,d):"",isDisabled:Q&&(null==k||null===(i=k.find((e=>{var n;return e.value===(null!==(n=t.SwatchValue)&&void 0!==n?n:"")})))||void 0===i?void 0:i.isDisabled)}})))&&void 0!==r?r:[];return d===m&&c.ArrayExtensions.hasElements(p)&&!p.some((e=>e.isDefault))&&(p[0].isDefault=!0),u().createElement(a.ProductComponentSwatchComponent,{context:h,swatches:p,onSelectDimension:Z,key:e.RecordId})}))):null),!h.app.config.hideRating&&function(e,t,n,r,i,o,c){if(!r)return null;const l=(null==i?void 0:i.toString())||void 0,s=v(r,o),m=y(Number(l),c);return u().createElement(a.RatingComponent,{context:e,id:n,typeName:t,avgRating:r,ratingCount:l,readOnly:!0,ariaLabel:s,ratingCountAriaLabel:m,data:{}})}(h,_,O,M.AverageRating,M.TotalRatings,N,w),(re=j,re&&""!==re?u().createElement("div",{className:"msc-product__availability"},u().createElement("span",null,re)):null),U&&function(e,t){if(null===e)return;const n=J.getValues().map((e=>({DimensionTypeValue:(0,c.convertDimensionTypeToProductDimensionType)(e.dimensionType),DimensionValue:{RecordId:0,Value:e.value}})));return u().cloneElement(e,{selectedProductId:t,selectedDimensions:n})}(U,M.RecordId),A&&function(e,t,n){return(0,c.validateCatalogId)(n),u().cloneElement(e,{product:t,catalogId:n})}(A,M,(0,i.getCatalogId)(h.request)));var re,ae,ie}},{})),C=h}}]);
//# sourceMappingURL=115f0f5c628386dd476c.bundle.js.map