/*! For license information please see 68066ce484ea2404f739.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[41],{0:e=>{e.exports=React},11:e=>{e.exports=ReactDOM},260:(e,t,n)=>{n.d(t,{i:()=>o.createAccordionStateInput});var o=n(600);n(341),n(302)},302:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(4);var o=n(5),r=n(10),i=n(1),s=n(8),a=n.n(s),c=n(16),l=n(0),d=n(260);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let u=class extends l.Component{constructor(e){super(e),this.moduleClassName="ms-accordion-item",this.handleHeadingChange=e=>this.props.config.accordionItemTitle=e.target.value,this._onToggle=this._onToggle.bind(this),this.telemetryContent=(0,i.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry)}shouldComponentUpdate(e){return this.props.data!==e.data}render(){const{slots:e,renderView:t,config:n,data:o}=this.props,r=o&&o.accordionExpandedState&&o.accordionExpandedState.result,s=r&&void 0===r.isAllExpanded?o&&n.isExpandedOnInitialLoad:r&&r.isAllExpanded,c=m(m({},this.props),{},{AccordionItemContainer:{moduleProps:this.props,className:a()(this.moduleClassName,n.className)},AccordionItemContent:{className:"ms-accordion-item-content"},drawer:{tag:i.ControlledDrawer,className:`${this.moduleClassName}__drawer`,toggleButtonText:n.accordionItemTitle&&n.accordionItemTitle||"",collapseProps:{isOpen:s},onToggle:this._onToggle,onTextChange:this.handleHeadingChange,requestContext:this.props.context.request,telemetryContent:this.telemetryContent},accordionSlots:e});return t(c)}_onToggle(e){if(!e.isOpen&&"ExpandOneItemOnly"===this.props.interactionStyle){const e={isAllExpanded:!1};this.props.context.actionContext.update((0,d.i)(e),e)}}};u=(0,r.Cg)([c.PA],u);const h=u},341:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});n(4);var o=n(5),r=(n(3),n(10)),i=n(2),s=n(1),a=n(8),c=n.n(a),l=n(16),d=n(0),p=n(260);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let h=class extends d.PureComponent{constructor(e){super(e),this.expandAllButtonRef=d.createRef(),this.collapseAllButtonRef=d.createRef(),this.handleHeadingChange=e=>this.props.config.heading.text=e.target.value,this._onExpandAll=this._onExpandAll.bind(this),this._onCollapseAll=this._onCollapseAll.bind(this),this.telemetryContent=(0,s.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry),this.payLoad=(0,s.getPayloadObject)("click",this.telemetryContent,""),this.state={isDisabled:!1}}render(){const{slots:e}=this.props,{heading:t,className:n}=this.props.config,o=t&&t.text&&d.createElement(i.Text,{className:"ms-accordion-header-section__heading",tag:t.tag||"h1",text:t.text,editProps:{onEdit:this.handleHeadingChange,requestContext:this.props.context.request}}),r=u(u({},this.props),{},{AccordionContainer:{moduleProps:this.props,className:c()("ms-accordion",n)},HeaderSection:{className:"ms-accordion-header-section"},HeadingWrapper:{className:"ms-accordion-header-section-container"},heading:o,config:this.props&&this.props.config,accordianButtonsContainer:{tag:"div",className:"ms-accordion-header-section-toggle-button-container"},accordionButtons:this._renderAccordionButton(),accordionItemContainer:{tag:"div",className:"ms-accordion-item-section"},accordionItems:e&&e.accordionItems&&e.accordionItems.length>0&&e.accordionItems.map(((e,t)=>this._getAccordionItem(e,t)))});return this.props.renderView(r)}_renderAccordionButton(){const{config:e,resources:t}=this.props,{heading:n}=e;this.payLoad.contentAction.etext=s.TelemetryConstant.ExpandAll;const o=(0,s.getTelemetryAttributes)(this.telemetryContent,this.payLoad);this.payLoad.contentAction.etext=s.TelemetryConstant.CollapseAll;const r=(0,s.getTelemetryAttributes)(this.telemetryContent,this.payLoad);return e.showToggleAll?d.createElement(d.Fragment,null,d.createElement("button",Object.assign({disabled:this.state.isDisabled,className:"ms-accordion_ExpandAll","aria-label":`${t.expandAllText} ${null!=n&&n.text?n.text:""}`,onClick:this._onExpandAll,ref:this.expandAllButtonRef},o),t.expandAllText),"Â ",t.toggleAllSeparator,"Â ",d.createElement("button",Object.assign({className:"ms-accordion_CollapseAll","aria-label":`${t.collapseAllText} ${null!=n&&n.text?n.text:""}`,onClick:this._onCollapseAll,ref:this.collapseAllButtonRef},r,{disabled:!this.state.isDisabled}),t.collapseAllText)):(this.props.context.telemetry.error("Accordion button content is empty, module wont render"),null)}_onExpandAll(){const e={isAllExpanded:!0};this.props.context.actionContext.update((0,p.i)(e),e),e.isAllExpanded&&(this.setState({isDisabled:!0}),setTimeout((()=>{var e;null===(e=this.collapseAllButtonRef.current)||void 0===e||e.focus()}),50))}_onCollapseAll(){const e={isAllExpanded:!1};this.props.context.actionContext.update((0,p.i)(e),e),e.isAllExpanded||(this.setState({isDisabled:!1}),setTimeout((()=>{var e;null===(e=this.expandAllButtonRef.current)||void 0===e||e.focus()}),50))}_getAccordionItem(e,t){return d.createElement(d.Fragment,{key:t},d.cloneElement(e,{interactionStyle:this.props.config.interactionStyle}))}};h=(0,r.Cg)([l.PA],h);const g=h},600:(e,t,n)=>{n.r(t),n.d(t,{createAccordionStateInput:()=>i,default:()=>a,getGenericActionDataAction:()=>s});var o=n(2),r=n(6);function i(e){return new r.GenericInput("accordionExpandedState",e,"IAccordionExpandedState")}const s=(0,o.createObservableDataAction)({action:r.getGenericAction,input:()=>i({})}),a=s},1185:(e,t,n)=>{var o=n(5);n(4);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const s={modules:{},dataActions:{}};s.modules["accordion-item"]={c:()=>n(302),$type:"moduleDefinition",da:[{name:"accordionExpandedState",path:"@msdyn365-commerce-modules/accordion/dist/lib/data-actions/accordion-state-data-action",runOn:0}],iNM:!0,ns:"@msdyn365-commerce-modules",n:"accordion-item",p:"accordion",pdp:"",md:"node_modules/@msdyn365-commerce-modules/accordion/dist/lib/modules/accordion-item"};{const e="@msdyn365-commerce-modules/accordion/dist/lib/data-actions/accordion-state-data-action";let t=n(600);((e,t)=>{if(s.dataActions[e]=t,!s.dataActions[e].default)throw new Error("Data action path "+e+" does not have a default export");s.dataActions[e].default.prototype.RegistrationId=e,s.dataActions[e].default.prototype.id&&(s.dataActions[s.dataActions[e].default.prototype.id]=e)})(e,t)}window.__bindings__=window.__bindings__||{},window.__bindings__.modules=i(i({},window.__bindings__.modules||{}),s.modules),window.__bindings__.dataActions=i(i({},window.__bindings__.dataActions||{}),s.dataActions);const a={};a["@msdyn365-commerce-modules|accordion|modules|accordion-item|accordion-item"]={c:()=>n(1263),cn:"@msdyn365-commerce-modules-accordion-accordion-item"},window.__bindings__=window.__bindings__||{},window.__bindings__.viewDictionary=i(i({},window.__bindings__.viewDictionary||{}),a)},1263:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});n(3);var o=n(1),r=n(0);const i=e=>r.createElement(r.Fragment,null,e&&e.length>0?e.map(((e,t)=>r.createElement(r.Fragment,{key:t},e))):null),s=e=>{const{drawer:t,accordionSlots:n,AccordionItemContainer:s,AccordionItemContent:a}=e;return r.createElement(o.Module,Object.assign({},s),r.createElement(o.Node,Object.assign({},t),r.createElement(o.Node,Object.assign({},a),n&&n.accordionItemContent&&n.accordionItemContent.length&&i(n.accordionItemContent))))}}},e=>{e.O(0,[0,3,2,4,5,6,7,8,9],(()=>{return t=1185,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=68066ce484ea2404f739.bundle.js.map