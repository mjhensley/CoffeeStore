/*! For license information please see f2ea799dbc61edd6fa41.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[160],{0:t=>{t.exports=React},11:t=>{t.exports=ReactDOM},1542:(t,e,o)=>{var s=o(5);o(4);function r(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,s)}return o}function i(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){(0,s.A)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}const n={modules:{},dataActions:{}};n.modules["product-collection"]={c:()=>o(1543),$type:"containerModule",da:[{name:"featureState",path:"@msdyn365-commerce-modules/retail-actions/dist/lib/get-feature-state",runOn:0}],iNM:!0,ns:"@msdyn365-commerce-modules",n:"product-collection",p:"product-collection",pdp:"",md:"node_modules/@msdyn365-commerce-modules/product-collection/dist/lib/modules/product-collection"};{const t="@msdyn365-commerce-modules/retail-actions/dist/lib/get-feature-state";let e=o(29);((t,e)=>{if(n.dataActions[t]=e,!n.dataActions[t].default)throw new Error("Data action path "+t+" does not have a default export");n.dataActions[t].default.prototype.RegistrationId=t,n.dataActions[t].default.prototype.id&&(n.dataActions[n.dataActions[t].default.prototype.id]=t)})(t,e)}window.__bindings__=window.__bindings__||{},window.__bindings__.modules=i(i({},window.__bindings__.modules||{}),n.modules),window.__bindings__.dataActions=i(i({},window.__bindings__.dataActions||{}),n.dataActions);const c={};c["@msdyn365-commerce-modules|product-collection|modules|product-collection|product-collection"]={c:()=>o(1544),cn:"@msdyn365-commerce-modules-product-collection-product-collection"},window.__bindings__=window.__bindings__||{},window.__bindings__.viewDictionary=i(i({},window.__bindings__.viewDictionary||{}),c)},1543:(t,e,o)=>{o.r(e),o.d(e,{default:()=>h});var s=o(5),r=(o(7),o(12),o(18),o(4),o(9),o(22),o(23),o(21),o(17)),i=o(2),n=o(6),c=o(1),a=o(8),l=o.n(a),p=o(0);function d(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,s)}return o}function u(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?d(Object(o),!0).forEach((function(e){(0,s.A)(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}class m extends p.PureComponent{constructor(t){super(t),this.handleHeadingChange=t=>this.props.config.heading.text=t.target.value,this._getProductsDimensionsAvailabilities=async t=>{const e=this.props.context,o=e.app.config.dimensionsInProductCard,s=e.app.config.dimensionsAsSwatchType,r=n.ArrayExtensions.validValues(t);if(n.ArrayExtensions.hasElements(r)&&n.ArrayExtensions.hasElements(o)&&!o.includes(n.DimensionTypes.none)&&n.ArrayExtensions.hasElements(s)&&!s.includes(n.DimensionTypes.none)){const t=await(0,n.getDimensionAvailabilitiesForProductSearchResultAction)(new n.DimensionAvailabilitiesForProductSearchResultInput(r,this.props.context,n.DimensionSwatchDisplayTypes.productCard),this.props.context.actionContext);n.ArrayExtensions.hasElements(t)&&this.setState({productsDimensionAvailabilities:t})}},this.initProductState=async t=>{let e=this.state.products,o=this.state.productPrices;const s=t.products;!n.ArrayExtensions.hasElements(e)&&n.ArrayExtensions.hasElements(s)||n.ArrayExtensions.hasElements(e)&&n.ArrayExtensions.hasElements(s)&&!n.ArrayExtensions.equals(e,s)?(e=s,this.setState({products:e})):void 0===s&&n.ArrayExtensions.hasElements(this.state.products)&&(e=[],this.setState({products:e})),i.msdyn365Commerce.isBrowser&&!n.ArrayExtensions.hasElements(this.state.productsDimensionAvailabilities)&&await this._getProductsDimensionsAvailabilities(e),"promotional"===this.props.config.productCollection.listType&&(o=await(0,n.getProductPriceForSelectedProducts)(new n.ProductPriceForSelectedProductsInput(e.filter((t=>!t.IsMasterProduct)).map((t=>t.RecordId))),this.props.context.actionContext),this.setState({productPrices:o}))},this._getProduct=(t,e,o)=>{var s,i;if(!t||!t.Name)return this.props.telemetry.trace("[product-collection] Product or product name is null"),null;const a=(0,c.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry),{imageSettings:l,allowBackNavigation:d}=this.props.config,u=this.props.resources,m=this.props.context.app.config.breadcrumbType,h=d&&("back"===m||"categoryAndBack"===m),g=this.props.slots&&this.props.slots.quickview&&this.props.slots.quickview.length>0?this.props.slots.quickview[0]:null,y=n.ArrayExtensions.hasElements(this.props.slots.productComparisonButton)?this.props.slots.productComparisonButton[0]:null,P=Number(t.TotalRatings),f=P>1?u.ratingCountAriaLabel:u.ratingCountAriaLabelSingleUser,b=null===(s=this.props.data.featureState.result)||void 0===s?void 0:s.find((t=>"Dynamics.AX.Application.RetailSearchPriceRangeFeature"===t.Name)),_={priceRangeSeparator:u.priceRangeSeparator};return{ProductContainer:{tag:"li",className:"ms-product-collection__item",role:"listitem",key:e},productComponent:p.createElement(r.ProductComponent,{context:this.props.context,telemetryContent:a,imageSettings:l,freePriceText:u.priceFree,originalPriceText:u.originalPriceText,currentPriceText:u.currentPriceText,ratingAriaLabel:u.ratingAriaLabel,ratingCountAriaLabel:f,allowBack:h,id:this.props.id,typeName:this.props.typeName,data:{product:t,productPrice:o},quickViewButton:g,productComparisonButton:y,isPriceMinMaxEnabled:null==b?void 0:b.IsEnabled,priceResources:_,dimensionAvailabilities:null===(i=this.state.productsDimensionAvailabilities)||void 0===i?void 0:i.find((e=>{var o;return n.ArrayExtensions.hasElements(e)&&e[0].masterProductId===(null!==(o=t.MasterProductId)&&void 0!==o?o:t.RecordId)}))})}},this._getActivePrice=async()=>{const t=this.state.products,e=await(0,n.getPriceForProductSearchResult)(new n.PriceForProductSearchResultInput(t),this.props.context.actionContext);i.msdyn365Commerce.isBrowser&&await this._getProductsDimensionsAvailabilities(e),this.setState({products:e})},this._getSeeAllButton=(t,e,o)=>{if(!i.msdyn365Commerce.isBrowser)return null;if(!e&&!o)return null;const s=(0,i.getCatalogId)(this.props.context.request);(0,n.validateCatalogId)(s);const r=(0,i.getUrlSync)("search",this.props.context.actionContext);if(!r)return null;const a=new URL(r,window.location.href);return o?(a.searchParams.set("discountIds",o.toString()),a.searchParams.set("title",t),a.searchParams.set("catalogid",`${s}`)):e&&(a.searchParams.set("recommendation",e),a.searchParams.set("title",t),a.searchParams.set("catalogid",`${s}`)),p.createElement(c.Button,{className:"ms-product-collection__see-all-btn msc-cta__primary",title:this.props.resources.seeAllButtonText,href:a.href},this.props.resources.seeAllButtonText)},this.productPrices=[],this.state={products:this.props.config.productCollection.products||[],productPrices:this.productPrices||[]},this.telemetryContent=(0,c.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry)}async componentDidMount(){this.props.config.enableAffiliationBasedPricing&&this.props.context.actionContext.requestContext.user.isAuthenticated&&await this._getActivePrice()}render(){const{heading:t,className:e,shouldDisplaySeeAllButton:o}=this.props.config,{resources:s}=this.props,r=this.props.config.productCollection.recommendationListId,a=this.props.config.productCollection.discountIds;this.initProductState(this.props.config.productCollection);const d=this.state.products,m=this.state.productPrices,h="carousel"===this.props.config.layout,g=t?t.text:"",y=t&&p.createElement(i.Text,{className:"ms-product-collection__heading",tag:t.tag||"h1",text:g,editProps:{onEdit:this.handleHeadingChange,requestContext:this.props.context.request}}),P=null==d?void 0:d.map(((t,e)=>{const o=this._getProduct(t,e,m?m.find((e=>e.ProductId===t.RecordId)):void 0);return n.ObjectExtensions.isNullOrUndefined(o)?void 0:o})),f=u(u({},this.props),{},{heading:y,SingleSlideCarouselComponentProps:{tag:c.SingleSlideCarousel,className:"",flipperPrevLabel:`${g} ${s.flipperPrevious}`,flipperNextLabel:`${g} ${s.flipperNext}`,parentId:this.props.id,telemetryContent:this.telemetryContent},ProductCollectionContainer:{moduleProps:this.props,className:l()("ms-product-collection",e)},GridComponentProps:{tag:"ul",className:"ms-product-collection__items"},isCarousel:h,products:n.ArrayExtensions.hasElements(P)&&P.filter((t=>void 0!==t)),productPrices:this.productPrices,seeAllButton:(r||a)&&o&&(n.ArrayExtensions.hasElements(P)||"promotional"===this.props.config.productCollection.listType)?this._getSeeAllButton(g,r,a):void 0,resources:s});return this.props.renderView(f)}}const h=m},1544:(t,e,o)=>{o.r(e),o.d(e,{default:()=>l});o(3);var s=o(1),r=o(0);const i=(t,e)=>r.createElement(s.Node,Object.assign({},t),e&&e.map(a)),n=(t,e)=>r.createElement(s.Node,Object.assign({},t),e&&e.map(a)),c=t=>r.createElement(s.Node,{className:""},r.createElement("p",null,t.noProductToRenderText)),a=t=>{const{ProductContainer:e,productComponent:o}=t;return r.createElement(s.Node,Object.assign({},e),o)},l=t=>{const{heading:e,ProductCollectionContainer:o,products:a,SingleSlideCarouselComponentProps:l,GridComponentProps:p,isCarousel:d,seeAllButton:u,resources:m}=t;return a?r.createElement(s.Module,Object.assign({},o),e,u,d?i(l,a):n(p,a)):"promotional"===t.config.productCollection.listType?r.createElement(s.Module,Object.assign({},o),e,u,c(m)):(t.context.telemetry.error("Product collection content is empty, module wont render."),null)}}},t=>{t.O(0,[0,3,2,4,5,6,7,8,9,10,11],(()=>{return e=1542,t(t.s=e);var e}));t.O()}]);
//# sourceMappingURL=f2ea799dbc61edd6fa41.bundle.js.map