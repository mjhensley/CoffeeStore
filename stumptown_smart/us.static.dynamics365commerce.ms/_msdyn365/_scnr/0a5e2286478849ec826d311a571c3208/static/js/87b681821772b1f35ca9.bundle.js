/*! For license information please see 87b681821772b1f35ca9.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[166],{0:e=>{e.exports=React},11:e=>{e.exports=ReactDOM},1553:(e,t,n)=>{n(4);var s=n(5);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,s.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const i={modules:{},dataActions:{}};i.modules["promo-banner"]={c:()=>n(1554),$type:"contentModule",da:[],iNM:!0,ns:"@msdyn365-commerce-modules",n:"promo-banner",p:"promo-banner",pdp:"",md:"node_modules/@msdyn365-commerce-modules/promo-banner/dist/lib/modules/promo-banner"},window.__bindings__=window.__bindings__||{},window.__bindings__.modules=o(o({},window.__bindings__.modules||{}),i.modules),window.__bindings__.dataActions=o(o({},window.__bindings__.dataActions||{}),i.dataActions);const a={};a["@msdyn365-commerce-modules|promo-banner|modules|promo-banner|promo-banner"]={c:()=>n(1555),cn:"@msdyn365-commerce-modules-promo-banner-promo-banner"},window.__bindings__=window.__bindings__||{},window.__bindings__.viewDictionary=o(o({},window.__bindings__.viewDictionary||{}),a)},1554:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});n(4);var s=n(5),r=(n(3),n(9),n(17)),o=n(1),i=n(8),a=n.n(i),l=n(0);const c=e=>{let{closeButtonAriaLabel:t,label:n,telemetryContent:s,onClose:r}=e;const i=(0,o.getPayloadObject)("click",s,o.TelemetryConstant.PromoBannerClose),a=(0,o.getTelemetryAttributes)(s,i);return l.createElement("button",Object.assign({className:"ms-promo-banner__close-button","aria-label":t,onClick:r},a),l.createElement("span",{className:"ms-promo-banner__close-button__label","aria-hidden":!0},n))};var p=n(2);const m=e=>{let{links:t,requestContext:n,onTextChange:s,telemetryContent:r}=e;const o=b(t,r);return l.createElement("span",{className:"ms-promo-banner__links"},o&&o.length>0?l.createElement(p.Links,{links:o,editProps:{onTextChange:s,requestContext:n}}):null)},b=(e,t)=>{if(!e||0===e.length)return null;const n=[];return e.forEach(((e,s)=>{const r=(0,o.getPayloadObject)("click",t,"",""),i=e.linkText?e.linkText:"";r.contentAction.etext=i;const a=(0,o.getTelemetryAttributes)(t,r),l={ariaLabel:e.ariaLabel,className:"ms-promo-banner__link",linkText:e.linkText,linkUrl:e.linkUrl.destinationUrl,openInNewTab:e.openInNewTab,role:"link",additionalProperties:a,onClick:(0,o.onTelemetryClick)(t,r,i)};n.push(l)})),n},d=e=>{let{text:t,onTextChange:n,requestContext:s}=e;return l.createElement(p.Text,{className:"ms-promo-banner__text",tag:"span",text:t,editProps:{onEdit:n,requestContext:s}})};function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,s.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class g extends l.PureComponent{constructor(){super(...arguments),this.state={animating:!1,isVisible:!0,activeIndex:0},this.telemetryContent=(0,o.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry),this.handleTextChange=e=>{this.props.config.bannerMessages&&this.props.config.bannerMessages[0]&&(this.props.config.bannerMessages[0].text=e.target.value)},this.handleLinkTextChange=e=>t=>{if(this.props.config.bannerMessages&&this.props.config.bannerMessages[1]){const n=this.props.config.bannerMessages[1].links;n&&(n[e].linkText=t.target.value)}},this._next=()=>{const e=this._isLastItem()?0:this.state.activeIndex+1;this._goToIndex(e)},this._previous=()=>{const e=this._isFirstItem()?this.props.config.bannerMessages?this.props.config.bannerMessages.length-1:0:this.state.activeIndex-1;this._goToIndex(e)},this._goToIndex=e=>{this.state.animating||this.setState({activeIndex:e})},this._isFirstItem=()=>0===this.state.activeIndex,this._isLastItem=()=>this.props.config.bannerMessages&&this.state.activeIndex===this.props.config.bannerMessages.length-1,this._onDismiss=()=>{this.setState({isVisible:!1})}}render(){const{bannerMessages:e,dismissEnabled:t,interval:n,hideFlipper:s,autoplay:o,className:i=""}=this.props.config,{closeButtonAriaLabel:p,closeButtonLabel:b,bannerText:u,bannerAriaLabel:g}=this.props.resources,{isVisible:_,activeIndex:y}=this.state;if(!_)return this.props.context.telemetry.error("Promo banner content is empty, module wont render."),null;const x=h(h({},this.props),{},{className:a()("ms-promo-banner",i),isVisible:_,onDismiss:this._onDismiss,handleLinks:this.handleLinkTextChange,handleText:this.handleTextChange,promoBannerProps:{className:a()("ms-promo-banner",i),moduleProps:this.props,role:"banner","aria-label":g},promoBannerTextProps:{tag:d},promoBannerLinksProps:{tag:m,telemetryContent:this.telemetryContent},contentProps:{className:"ms-promo-banner__content"},promoBannerText:u,bannerMessages:e,activeIndex:y,carouselProps:{tag:r.Carousel,className:"ms-promo-banner__carousel",activeIndex:y,next:this._next,previous:this._previous,onIndicatorsClickHandler:this._goToIndex,hideIndicator:s,interval:n,hideFlipper:s,autoplay:o},closeButton:t&&l.createElement(c,Object.assign({},{onClose:this._onDismiss,label:b,closeButtonAriaLabel:p,telemetryContent:this.telemetryContent}))});return this.props.renderView(x)}}const _=g},1555:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});n(3);var s=n(1),r=n(0);const o=e=>{const{promoBannerProps:t,contentProps:n,closeButton:o,bannerMessages:i,promoBannerTextProps:a,promoBannerLinksProps:l,carouselProps:c,promoBannerText:p,handleLinks:m,handleText:b}=e,d=i&&i.map(((e,t)=>r.createElement(s.Node,Object.assign({},n,{key:t,"aria-live":"off",role:"marquee"}),r.createElement("span",{className:"sr-only"},p),e.text&&r.createElement(s.Node,Object.assign({},a,{text:e.text,onClick:b})),e.links&&e.links.length>0&&r.createElement(s.Node,Object.assign({},l,{links:e.links,onClick:m})))));return r.createElement(s.Module,Object.assign({},t),r.createElement(s.Node,Object.assign({},c,{items:d})),o)}}},e=>{e.O(0,[0,3,2,4,5,6,7,8,9,10,11],(()=>{return t=1553,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=87b681821772b1f35ca9.bundle.js.map