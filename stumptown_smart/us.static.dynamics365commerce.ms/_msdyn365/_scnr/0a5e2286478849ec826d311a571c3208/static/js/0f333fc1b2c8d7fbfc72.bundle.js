/*! For license information please see 0f333fc1b2c8d7fbfc72.bundle.js.LICENSE.txt */
(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[38],{0:t=>{"use strict";t.exports=React},11:t=>{"use strict";t.exports=ReactDOM},84:(t,e,r)=>{"use strict";r.d(e,{$J:()=>g,Sl:()=>y,BE:()=>E,BU:()=>w,yQ:()=>O,TF:()=>P,Ml:()=>b,Gw:()=>C});var n=r(14),a=(r(70),r(63),r(67));class i{constructor(t){if(t=t||{},this.ContactPersonId=t.ContactPersonId,this.PersonId=t.PersonId,this.BusinessPartnerId=t.BusinessPartnerId,this.FirstName=t.FirstName,this.LastName=t.LastName,this.Email=t.Email,this.SpendingLimit=t.SpendingLimit?parseFloat(t.SpendingLimit):0,this.IsAdmin=t.IsAdmin,this.AccountNumber=t.AccountNumber,this.B2BUserId=t.B2BUserId,this.ExtensionProperties=void 0,t.ExtensionProperties){this.ExtensionProperties=[];for(var e=0;e<t.ExtensionProperties.length;e++)if(t.ExtensionProperties[e])if(t.ExtensionProperties[e]["@odata.type"]){var r=t.ExtensionProperties[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ExtensionProperties[e]=new a[r](t.ExtensionProperties[e]))}else this.ExtensionProperties[e]=new a.CommercePropertyClass(t.ExtensionProperties[e]);else this.ExtensionProperties[e]=void 0}}}class s{constructor(t){if(t=t||{},this.Name=t.Name,this.AccountNumber=t.AccountNumber,this.ContactPersonID=t.ContactPersonID,this.IsSelected=t.IsSelected,this.ExtensionProperties=void 0,t.ExtensionProperties){this.ExtensionProperties=[];for(var e=0;e<t.ExtensionProperties.length;e++)if(t.ExtensionProperties[e])if(t.ExtensionProperties[e]["@odata.type"]){var r=t.ExtensionProperties[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ExtensionProperties[e]=new a[r](t.ExtensionProperties[e]))}else this.ExtensionProperties[e]=new a.CommercePropertyClass(t.ExtensionProperties[e]);else this.ExtensionProperties[e]=void 0}}}class o{constructor(t){if(t=t||{},this.BusinessPartnerId=t.BusinessPartnerId,this.B2BUserId=t.B2BUserId,this.IsB2BAdmin=t.IsB2BAdmin,this.ContactPersonID=t.ContactPersonID,this.FirstName=t.FirstName,this.LastName=t.LastName,this.AccountNumber=t.AccountNumber,this.Email=t.Email,this.Phone=t.Phone,this.VatNumber=t.VatNumber,this.ExtensionProperties=void 0,t.ExtensionProperties){this.ExtensionProperties=[];for(var e=0;e<t.ExtensionProperties.length;e++)if(t.ExtensionProperties[e])if(t.ExtensionProperties[e]["@odata.type"]){var r=t.ExtensionProperties[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ExtensionProperties[e]=new a[r](t.ExtensionProperties[e]))}else this.ExtensionProperties[e]=new a.CommercePropertyClass(t.ExtensionProperties[e]);else this.ExtensionProperties[e]=void 0}}}class c{constructor(t){t=t||{},this.Success=t.Success}}class l{constructor(t){t=t||{},this.Success=t.Success}}class u{constructor(t){t=t||{},this.Success=t.Success}}class d{constructor(t){t=t||{},this.Message=t.Message}}class p{constructor(t){t=t||{},this.Total=t.Total,this.ChargeOverriden=t.ChargeOverriden}}class h{constructor(t){if(t=t||{},null===t.UserInfo)this.UserInfo=void 0;else if(null==t.UserInfo["@odata.type"])this.UserInfo=new o(t.UserInfo);else{var e=t.UserInfo["@odata.type"];e=e.substr(e.lastIndexOf(".")+1).concat("Class"),a[e]&&(this.UserInfo=new a[e](t.UserInfo))}}}function v(t){const e=(new n.DataServiceQuery).resultSettings(t);return e.createDataServiceRequestForOperation("GetContacts",!1,i,"true",{bypassCache:"get",returnEntity:"DataServiceEntities.IContactEntity"},{})}function y(t){const e=v(t.queryResultSettings||{});return(0,n.callActionOrExecute)(e,t.callerContext)}function I(t,e,r,a){const i=new n.DataServiceQuery;return i.createDataServiceRequestForOperation("CreateContact",!1,c,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.ICreateContactResponse"},{accountNum:t,firstName:e,lastName:r,email:a})}function g(t,e,r,a,i){const s=I(e,r,a,i);return(0,n.callActionOrExecute)(s,t.callerContext)}function m(t,e,r,a){const i=new n.DataServiceQuery;return i.createDataServiceRequestForOperation("UpdateContact",!1,l,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.IUpdateContactResponse"},{contactPersonId:t,personId:e,firstName:r,lastName:a})}function C(t,e,r,a,i){const s=m(e,r,a,i);return(0,n.callActionOrExecute)(s,t.callerContext)}function f(t,e){const r=new n.DataServiceQuery;return r.createDataServiceRequestForOperation("RemoveContact",!1,u,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.IRemoveContactResponse"},{contactPersonId:t,personId:e})}function P(t,e,r){const a=f(e,r);return(0,n.callActionOrExecute)(a,t.callerContext)}function A(t){const e=(new n.DataServiceQuery).resultSettings(t);return e.createDataServiceRequestForOperation("GetEligibleCustomers",!1,s,"true",{bypassCache:"get",returnEntity:"DataServiceEntities.IEligibleCustomerEntity"},{})}function E(t){const e=A(t.queryResultSettings||{});return(0,n.callActionOrExecute)(e,t.callerContext)}function x(t,e,r){const a=new n.DataServiceQuery;return a.createDataServiceRequestForOperation("SaveSessionCustomer",!1,d,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.ISaveSessionCustomerResponse"},{accountNum:t,contactPersonId:e,cartId:r})}function b(t,e,r,a){const i=x(e,r,a);return(0,n.callActionOrExecute)(i,t.callerContext)}function D(t,e){const r=new n.DataServiceQuery;return r.createDataServiceRequestForOperation("GetEligibleCustomersTotal",!1,p,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.IGetEligibleCustomersTotalResponse"},{cartId:t,checkoutCartId:e})}function w(t,e,r){const a=D(e,r);return(0,n.callActionOrExecute)(a,t.callerContext)}function L(){const t=new n.DataServiceQuery;return t.createDataServiceRequestForOperation("GetUserInfo",!1,h,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.IGetUserInfoResponse"},{})}function O(t){const e=L();return(0,n.callActionOrExecute)(e,t.callerContext)}},114:(t,e,r)=>{"use strict";r.d(e,{g:()=>n});const n=t=>{if(!t.requestContext.user)return 0;let e=t.requestContext.query&&t.requestContext.query.catalogid&&+t.requestContext.query.catalogid||0;return 0===e&&(e=t.requestContext.user.catalogId&&+t.requestContext.user.catalogId||0),e}},137:(t,e,r)=>{"use strict";r.d(e,{$r:()=>d,Mb:()=>h,DW:()=>y,Zz:()=>C,Nh:()=>g});var n=r(14),a=(r(70),r(63),r(67)),i=r(255);class s{constructor(t){t=t||{},this.ProductListId=t.ProductListId}}class o{constructor(t){if(t=t||{},this.Id=t.Id,this.Name=t.Name,this.CustomerId=t.CustomerId,this.CreatedDateTime=t.CreatedDateTime instanceof Date?t.CreatedDateTime:t.CreatedDateTime?(0,i.Wd)(t.CreatedDateTime,"Edm.DateTimeOffset",!1):void 0,this.LastUpdated=t.LastUpdated instanceof Date?t.LastUpdated:t.LastUpdated?(0,i.Wd)(t.LastUpdated,"Edm.DateTimeOffset",!1):void 0,this.DeletedDateTime=t.DeletedDateTime instanceof Date?t.DeletedDateTime:t.DeletedDateTime?(0,i.Wd)(t.DeletedDateTime,"Edm.DateTimeOffset",!1):void 0,this.ProductListTypeValue=t.ProductListTypeValue,this.DataAreaId=t.DataAreaId,this.ProductListLines=void 0,t.ProductListLines){this.ProductListLines=[];for(var e=0;e<t.ProductListLines.length;e++)if(t.ProductListLines[e])if(t.ProductListLines[e]["@odata.type"]){var r=t.ProductListLines[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ProductListLines[e]=new a[r](t.ProductListLines[e]))}else this.ProductListLines[e]=new a.ProductListLineClass(t.ProductListLines[e]);else this.ProductListLines[e]=void 0}if(this.ExtensionProperties=void 0,t.ExtensionProperties){this.ExtensionProperties=[];for(e=0;e<t.ExtensionProperties.length;e++)if(t.ExtensionProperties[e])if(t.ExtensionProperties[e]["@odata.type"]){r=t.ExtensionProperties[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ExtensionProperties[e]=new a[r](t.ExtensionProperties[e]))}else this.ExtensionProperties[e]=new a.CommercePropertyClass(t.ExtensionProperties[e]);else this.ExtensionProperties[e]=void 0}}}class c{constructor(t){if(t=t||{},this.ItemId=t.ItemId,this.RecId=t.RecId?parseInt(t.RecId,10):0,this.UpperBoundInclusive=t.UpperBoundInclusive?parseFloat(t.UpperBoundInclusive):0,this.Label=t.Label,this.LanguageId=t.LanguageId,this.Txt=t.Txt,this.ProductId=t.ProductId?parseInt(t.ProductId,10):0,this.Code=t.Code,this.Quantity=t.Quantity?parseFloat(t.Quantity):0,this.ExtensionProperties=void 0,t.ExtensionProperties){this.ExtensionProperties=[];for(var e=0;e<t.ExtensionProperties.length;e++)if(t.ExtensionProperties[e])if(t.ExtensionProperties[e]["@odata.type"]){var r=t.ExtensionProperties[e]["@odata.type"];r=r.substr(r.lastIndexOf(".")+1).concat("Class"),a[r]&&(this.ExtensionProperties[e]=new a[r](t.ExtensionProperties[e]))}else this.ExtensionProperties[e]=new a.CommercePropertyClass(t.ExtensionProperties[e]);else this.ExtensionProperties[e]=void 0}}}class l{constructor(t){t=t||{},this.CatalogWarehouse=t.CatalogWarehouse,this.IsDefaultWarehouse=t.IsDefaultWarehouse}}function u(t,e){const r=new n.DataServiceQuery;return r.createDataServiceRequestForOperation("CreateCatalogProductList",!0,s,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.ICreateCatalogResponseEntity"},{productList:t,catalogId:e})}function d(t,e,r){const a=u(e,r);return(0,n.callActionOrExecute)(a,t.callerContext)}function p(t,e){const r=new n.DataServiceQuery;return r.createDataServiceRequestForOperation("DeleteCatalogProductList",!0,"","false",{bypassCache:"get",returnEntity:""},{productListId:t,catalogId:e})}function h(t,e,r){const a=p(e,r);return(0,n.callActionOrExecute)(a,t.callerContext)}function v(t,e,r){const a=(new n.DataServiceQuery).resultSettings(t);return a.createDataServiceRequestForOperation("GetCatalogProductList",!0,o,"true",{bypassCache:"get",returnEntity:"DataServiceEntities.IEveProductList"},{catalogId:e,productListSearchCriteria:r})}function y(t,e,r){const a=v(t.queryResultSettings||{},e,r);return(0,n.callActionOrExecute)(a,t.callerContext)}function I(t,e){const r=(new n.DataServiceQuery).resultSettings(t);return r.createDataServiceRequestForOperation("GetInventoryLabel",!0,c,"true",{bypassCache:"get",returnEntity:"DataServiceEntities.IInventoryLabelEntity"},{availabilities:e})}function g(t,e){const r=I(t.queryResultSettings||{},e);return(0,n.callActionOrExecute)(r,t.callerContext)}function m(t){const e=new n.DataServiceQuery;return e.createDataServiceRequestForOperation("GetCatalogWarehouse",!1,l,"false",{bypassCache:"get",returnEntity:"DataServiceEntities.IGetCatalogWarehouseResponse"},{catalogId:t})}function C(t,e){const r=m(e);return(0,n.callActionOrExecute)(r,t.callerContext)}},638:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ContactsInput:()=>s,createGetContactsInput:()=>o,default:()=>u,getContactUsers:()=>c,getContactsDataAction:()=>l});r(7);var n=r(6),a=r(2),i=r(84);class s{constructor(t){this.getCacheKey=()=>(0,n.buildCacheKey)("Contacts",this.apiSettings),this.getCacheObjectType=()=>"Contacts",this.dataCacheType=()=>"request",this.apiSettings=t}}const o=t=>{const{requestContext:e}=t;if(!e.user.isAuthenticated)throw new Error("User is not logged in.");return new s(e.apiSettings)};async function c(t,e){return(0,i.Sl)({callerContext:e}).then((t=>t)).catch((t=>{throw e.telemetry.exception(t),e.trace("[get-customer-contacts] Unable to load users"),new Error("[get-customer-contacts] Unable to load users")}))}const l=(0,a.createObservableDataAction)({id:"get-customer-contacts",action:c,input:o}),u=l},641:(t,e,r)=>{"use strict";r.d(e,{l:()=>a});var n=r(114);const a=t=>{const e=i(t),r=t.get("CART",e);let n;var a,s;r&&(n=Array.isArray(r)?null===(a=r[0].result)||void 0===a?void 0:a.cart:null===(s=r.result)||void 0===s?void 0:s.cart);return n},i=t=>{const e=(0,n.g)(t),r=t.requestContext.channel.RecordId;return`GETCART-CHANNELID:${r}-CATALOGID:${e}`}},1712:(t,e,r)=>{var n=r(55);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}r(4);const s={modules:{},dataActions:{}},o=t=>{s.dataActions[t]&&s.dataActions[t].default&&s.dataActions[t].default.prototype&&s.dataActions[t].default.prototype.id?s.dataActions[s.dataActions[t].default.prototype.id]=s.dataActions[t]:Object.keys(s.dataActions[t]||{}).forEach((e=>{s.dataActions[t][e]&&s.dataActions[t][e].prototype&&s.dataActions[t][e].prototype.Action&&(s.dataActions[s.dataActions[t][e].prototype.id]=s.dataActions[t][e])}))};{const t="actions/add-order-template-to-cart-override.action";s.dataActions[t]=r(1713),o(t)}{const t="actions/create-order-template-override.action";s.dataActions[t]=r(1714),o(t)}{const t="actions/get-availabilities-cartlines-override.action";s.dataActions[t]=r(1715),o(t)}{const t="actions/get-customer-contacts.action";s.dataActions[t]=r(638),o(t)}{const t="actions/get-order-templates-preview-override.action";s.dataActions[t]=r(1716),o(t)}{const t="actions/get-product-availabilities-for-selected-variant-override.action";s.dataActions[t]=r(1717),o(t)}window.__bindings__=window.__bindings__||{},window.__bindings__.modules=i(i({},window.__bindings__.modules||{}),s.modules),window.__bindings__.packageDataActions={},window.__bindings__.packageDataActions.__local__=i({},s.dataActions)},1713:(t,e,r)=>{"use strict";r.r(e),r.d(e,{AddOrderTemplateToCartInput:()=>c,addOrderTemplateToCartAction:()=>u,addOrderTemplateToCartActionDataAction:()=>d,addOrderTemplateToCartInput:()=>l,default:()=>p});r(7);var n=r(2),a=r(26),i=r(32),s=r(6),o=r(114);class c{constructor(t){this.getCacheKey=()=>"AddOrderTemplateToCartInput",this.getCacheObjectType=()=>"AddOrderTemplateToCartInput",this.dataCacheType=()=>"none",this.orderTemplateId=t}}const l=(t,e)=>{const{requestContext:r}=t;if(!r.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new c(e)};async function u(t,e){const r=await(0,a.getCartState)(e),n=(0,o.g)(e),c=1e3,l={Paging:{Top:c,Skip:0}},u=new s.GetPaginatedOrderTemplateLinesInput(t.orderTemplateId,l);let d=await(0,s.getPaginatedOrderTemplateLinesAction)(u,e),p=[];for(let t=c;d.lines.length>0;t+=c){const a=d.lines.map((t=>{var e;const r={ItemId:null===(e=t.fullProduct)||void 0===e?void 0:e.ProductDetails.ItemId,ProductId:t.productListLine.ProductId,Quantity:t.productListLine.Quantity,TrackingId:"",UnitOfMeasureSymbol:t.productListLine.UnitOfMeasure,CatalogId:n};return r}));await(0,i.addCartLinesAsync)({callerContext:e},r.cart.Id,a,r.cart.Version).catch((t=>{var r,n;throw e.telemetry.trace(null===(r=t.data)||void 0===r?void 0:r.ValidationResults),e.telemetry.trace("Unable to add order template to cart."),null===(n=t.data)||void 0===n?void 0:n.ValidationResults})),p=p.concat(a),u.queryResultSettings.Paging.Skip=t,d=await(0,s.getPaginatedOrderTemplateLinesAction)(u,e)}return await r.refreshCart({}),p}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/add-order-template-to-cart",action:u,input:l}),p=d},1714:(t,e,r)=>{"use strict";r.r(e),r.d(e,{CreateOrderTemplateInput:()=>l,createOrderTemplateAction:()=>d,createOrderTemplateActionDataAction:()=>p,createOrderTemplateInput:()=>u,default:()=>h});r(7);var n=r(2),a=r(14),i=r(137),s=r(114),o=r(641),c=r(6);class l{constructor(t){this.getCacheKey=()=>"CreateOrderTemplateInput",this.getCacheObjectType=()=>"CreateOrderTemplateInput",this.dataCacheType=()=>"none",this.templateName=t}}const u=(t,e)=>{const{requestContext:r}=t;if(!r.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new l(e)};async function d(t,e){try{const r=(0,o.l)(e);let n;n=r&&c.ArrayExtensions.hasElements(null==r?void 0:r.CartLines)?r.CartLines[0].CatalogId||0:(0,s.g)(e);const l={Id:"",Name:t.templateName,ProductListTypeValue:a.ProductListType.OrderTemplate},u=await(0,i.$r)({callerContext:e},l,n);if(null!=u&&u.ProductListId){const t={ProductListId:u.ProductListId,CustomerId:e.requestContext.user.customerAccountNumber},r=await(0,i.DW)({callerContext:e},n,t);if(r&&r&&r.length)return r[0]}throw e.telemetry.error("Created product list was null"),new Error("Created product list was null")}catch(t){throw e.telemetry.error("Not able to create order template",t),t}}const p=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/create-order-template",action:d,input:u}),h=p},1715:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ProductAvailabilitiesForCartLineItems:()=>p,default:()=>I,getAvailabilitiesForCartLineItems:()=>v,getAvailabilitiesForCartLineItemsDataAction:()=>y});r(7),r(9);var n=r(2),a=r(26),i=r(88),s=r(34),o=r(30),c=r(6),l=r(29),u=r(114),d=r(137);class p{constructor(t){this.getCacheKey=()=>(0,c.buildCacheKey)("ActiveCartLineItemsAvailability",this.apiSettings),this.getCacheObjectType=()=>"ActiveCartLineItemsAvailability",this.dataCacheType=()=>"none",this.apiSettings=t}}const h=function(t){var e;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return r?t.DeliveryMode===(null==n||null===(e=n.PickupDeliveryModeCodes)||void 0===e?void 0:e.find((e=>e===t.DeliveryMode))):t.DeliveryMode===a};async function v(t,e){var r,n;if(!t)throw new Error("[getAvailabilitiesForCartLineItems]No valid Input was provided, failing");const p=[],v=[];let y=[];let I;const g=await(0,a.getCartState)(e),m=g.cart,C=await(0,i.getOrgUnitConfigurationAsync)({callerContext:e}),f=await(0,c.getActiveCartProductsAction)(new c.ActiveCartProductsInput,e);const P=await async function(t){return(0,l.getFeatureStateActionDataAction)(new l.FeatureStateInput,t)}(e),A=null==P||null===(r=P.find((t=>"Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature"===t.Name)))||void 0===r?void 0:r.IsEnabled;A&&(I=await(0,o.getChannelDeliveryOptionConfigurationAsync)({callerContext:e}));const E=C.PickupDeliveryModeCode,x=C.EmailDeliveryModeCode;if(!m||!C||!f||0===f.length)return e.trace("[getAvailabilitiesForCartLineItems] Not able to get cart OR channelConfiguration or no products in cart"),[];if(m&&m.Id&&m.CartLines&&m.CartLines.length>0&&C)for(const t of m.CartLines)t.DeliveryMode&&""!==t.DeliveryMode&&h(t,A,I,E)?v.push(t):""!==x&&t.DeliveryMode===x||p.push(t);const b=(0,u.g)(e);var D=(null===(n=e.requestContext.channel)||void 0===n?void 0:n.InventLocation)||"";if(b>0){const t=await(0,d.Zz)({callerContext:e},b);null!=t&&t.IsDefaultWarehouse||(D=t.CatalogWarehouse||D)}if(p&&p.length>0){let t=p.map((t=>t.ProductId));t=c.ArrayExtensions.unique(t);const r=[];for(const n of t){const t={ProductId:n,InventLocationId:D};e.requestContext.channel&&e.requestContext.channel.InventLocationDataAreaId&&(t.DataAreaId=e.requestContext.channel.InventLocationDataAreaId),r.push(t)}const n=2,a=await(0,s.getEstimatedProductWarehouseAvailabilityAsync)({callerContext:e,bypassCache:"get",queryResultSettings:{}},r,n);a&&a.ProductWarehouseInventoryAvailabilities&&a.ProductWarehouseInventoryAvailabilities.length>0&&(y=(0,c.mapAggregatedProductInventoryInformation)(e,a))}if(v&&v.length>0){const t=[];for(const r of v){const n={ProductId:r.ProductId,InventLocationId:r.WarehouseId};e.requestContext.channel&&e.requestContext.channel.InventLocationDataAreaId&&(n.DataAreaId=e.requestContext.channel.InventLocationDataAreaId),t.push(n)}const r=2,n=await(0,s.getEstimatedProductWarehouseAvailabilityAsync)({callerContext:e,bypassCache:"get",queryResultSettings:{}},t,r);if(n&&n.ProductWarehouseInventoryAvailabilities&&n.ProductWarehouseInventoryAvailabilities.length>0){const t=(0,c.mapProductInventoryInformation)(e,null==n?void 0:n.ProductWarehouseInventoryAvailabilities);if(t&&t.length>0)for(const e of t)y.push(e)}}return y&&y.length>0?y:(e.trace("[getAvailabilitiesForCartLineItems] unable to get availabilities for product"),[])}const y=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-availabilities-cartlines",action:v,input:t=>new p(t.requestContext.apiSettings)}),I=y},1716:(t,e,r)=>{"use strict";r.r(e),r.d(e,{GetOrderTemplatesPreviewInput:()=>c,createGetOrderTemplatesPreviewInput:()=>l,default:()=>p,getOrderTemplatesPreview:()=>u,getOrderTemplatesPreviewDataAction:()=>d});r(7),r(9);var n=r(2),a=r(35),i=r(6),s=r(114),o=r(137);class c{constructor(t){this.getCacheKey=()=>"GetOrderTemplatesPreview",this.getCacheObjectType=()=>"GetOrderTemplatesPreview",this.dataCacheType=()=>"none",this.queryResultSettings=t,this.queryResultSettings.count=!0,this.queryResultSettings.Paging.Top=4}}const l=t=>{const e=i.QueryResultSettingsProxy.fromInputData(t).QueryResultSettings;return new c(e)};async function u(t,e){try{const r={ProductListId:"",ProductListType:`${a.ProductListType.OrderTemplate}`},n=(0,s.g)(e),c=i.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(e),l=await(0,o.DW)({callerContext:e,queryResultSettings:c},+n||0,r),u=[],d=[],p=l;for(const r of p){const n=new i.GetPaginatedOrderTemplateLinesInput(r.Id,t.queryResultSettings,void 0);d.push((0,i.getPaginatedOrderTemplateLinesAction)(n,e))}const h=await Promise.all(d);for(const t of p){const e=h.filter((e=>e.lines.length>0&&e.lines[0].productListLine.ProductListId===t.Id));e.length>0?u.push(new i.OrderTemplate(t,e[0].lines,e[0].totalCount)):u.push(new i.OrderTemplate(t,[],0))}return u}catch(t){throw e.telemetry.error("Not able to get order template(s)",t),t}}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-order-templates-preview",action:u,input:l}),p=d},1717:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ProductAvailabilitiesForSelectedVariantInput:()=>c,createProductAvailabilitiesForSelectedVariantInput:()=>l,default:()=>h,getProductAvailabilitiesForSelectedVariantAction:()=>u,getProductAvailabilitiesForSelectedVariantActionDataAction:()=>p,mergeProductWarehouseToProductAvailabities:()=>d});r(7),r(4),r(9);var n=r(2),a=r(14),i=r(6),s=r(114),o=r(137);class c{constructor(t,e){this.getCacheKey=()=>"ProductAvailabilitiesForSelectedVariant",this.getCacheObjectType=()=>"ProductAvailabilities",this.dataCacheType=()=>"none",this.productId="string"==typeof t?+t:t,this.channelId=e}}const l=t=>{const e=(0,i.getSelectedProductIdFromActionInput)(t);if(e)return new c(+e,+t.requestContext.apiSettings.channelId);throw new Error("Unable to create ProductAvailabilitiesForSelectedVariantInput, no productId found on module config or query")};async function u(t,e){const r=new i.SelectedVariantInput(t.productId,t.channelId,void 0,void 0,e.requestContext);let n=[];try{const l=await(0,i.getSelectedVariant)(r,e);if(e.requestContext.app.config.enableStockCheck&&l&&l.ItemTypeValue!==a.ReleasedProductType.Service&&l.ProductTypeValue!==a.ProductType.Master){var c;const r=(0,s.g)(e);let u=(null===(c=e.requestContext.channel)||void 0===c?void 0:c.InventLocation)||"";const d=!0;if(d&&r>0){const t=await(0,o.Zz)({callerContext:e},r);null!=t&&t.IsDefaultWarehouse||(u=t.CatalogWarehouse||u)}const p=(0,i.createInventoryAvailabilitySearchCriteria)(e,[l.RecordId],!0,void 0,void 0,i.DeliveryMode.shipping),h=(0,i.createInventoryAvailabilitySearchCriteria)(e,[t.productId],!1,!0,void 0,i.DeliveryMode.pickup),v=await a.ProductsDataActions.getEstimatedAvailabilityAsync({callerContext:e},p),y=[];if(v.ProductWarehouseInventoryAvailabilities){const t=(0,i.mapAggregatedProductInventoryInformation)(e,v);i.ArrayExtensions.hasElements(t)&&(y.push(...t),t[0].deliveryType=i.DeliveryMode.shipping,n.push(t[0]))}const I=await a.ProductsDataActions.getEstimatedAvailabilityAsync({callerContext:e},h);if(I.ProductWarehouseInventoryAvailabilities){const t=(0,i.mapAggregatedProductInventoryInformation)(e,I);i.ArrayExtensions.hasElements(t)&&(y.push(...t),t[0].deliveryType=i.DeliveryMode.pickup,n.push(t[0]))}if(d&&0!==r&&i.ArrayExtensions.hasElements(y)){const t=y.filter((t=>t.InventLocationId===u));if(0===t.length){const r={ItemId:l.ItemId,Quantity:0},n=await(0,o.Nh)({callerContext:e},[r]);if(null!=n&&n.length){const e=n[0];t.push({IsProductAvailable:!1,ProductAvailableQuantity:{ProductId:e.ProductId,AvailableQuantity:e.Quantity},InventLocationId:u,deliveryType:i.DeliveryMode.shipping,StockLevelCode:e.Code,StockLevelLabel:e.Label})}}else t.forEach((t=>t.deliveryType=i.DeliveryMode.shipping));n=[...t]}return n}return}catch(t){return e.telemetry.exception(t),void e.telemetry.debug("[getPriceForSelectedVariantAction]Error executing action")}}function d(t){const e=[];if(i.ArrayExtensions.hasElements(t))for(const r of t)void 0!==r.TotalAvailable&&void 0!==r.ProductId&&e.push({ProductId:r.ProductId,AvailableQuantity:r.TotalAvailable});return e}const p=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-availabilities-for-selected-variant",action:u,input:l}),h=p}},t=>{t.O(0,[0,3,2,4,5,6,7,8,13],(()=>{return e=1712,t(t.s=e);var e}));t.O()}]);
//# sourceMappingURL=0f333fc1b2c8d7fbfc72.bundle.js.map