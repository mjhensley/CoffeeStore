/*! For license information please see 7d649b45701bd8cd922d.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[173],{0:e=>{e.exports=React},11:e=>{e.exports=ReactDOM},671:(e,t,s)=>{s.r(t),s.d(t,{createSearchStateInput:()=>n,default:()=>c,getGenericActionDataAction:()=>o});var a=s(2),r=s(6);function n(e){return new r.GenericInput("searchState",e,"SearchState")}const o=(0,a.createObservableDataAction)({action:r.getGenericAction,input:e=>n({searchText:""})}),c=o},1588:(e,t,s)=>{var a=s(5);s(15),s(51),s(4);function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){(0,a.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}const o={modules:{},dataActions:{}};o.modules.search={c:()=>s(1589),$type:"contentModule",da:[{name:"searchState",path:"@msdyn365-commerce-modules/search-utilities/dist/lib/search-state-data-action",runOn:1}],iNM:!0,ns:"@msdyn365-commerce-modules",n:"search",p:"search",pdp:"",md:"node_modules/@msdyn365-commerce-modules/search/dist/lib/modules/search"};{const e="@msdyn365-commerce-modules/search-utilities/dist/lib/search-state-data-action";let t=s(671);((e,t)=>{if(o.dataActions[e]=t,!o.dataActions[e].default)throw new Error("Data action path "+e+" does not have a default export");o.dataActions[e].default.prototype.RegistrationId=e,o.dataActions[e].default.prototype.id&&(o.dataActions[o.dataActions[e].default.prototype.id]=e)})(e,t)}window.__bindings__=window.__bindings__||{},window.__bindings__.modules=n(n({},window.__bindings__.modules||{}),o.modules),window.__bindings__.dataActions=n(n({},window.__bindings__.dataActions||{}),o.dataActions);const c={};c["__local__|__local__|themes|peetsaw|views|search"]={c:()=>s(1590),cn:"__local__-__local__-search"},c["@msdyn365-commerce-modules|search|modules|search|search"]={c:()=>s(1591),cn:"@msdyn365-commerce-modules-search-search"},c["@msdyn365-commerce-theme|adventureworks-theme-kit|modules|adventureworks|views|search"]={c:()=>s(1592),cn:"@msdyn365-commerce-theme-adventureworks-theme-kit-search"},window.__bindings__=window.__bindings__||{},window.__bindings__.viewDictionary=n(n({},window.__bindings__.viewDictionary||{}),c)},1589:(e,t,s)=>{s.r(t),s.d(t,{default:()=>oe});var a=s(5),r=s(73),n=s.n(r),o=(s(7),s(4),s(9),s(22),s(23),s(21),s(2)),c=s(14),i=s(6),u=s(671),l=s(10),g=s(13);class m{}(0,l.Cg)([g.sH],m.prototype,"searchText",void 0),(0,l.Cg)([g.sH],m.prototype,"defaultBasicSearchUrl",void 0),(0,l.Cg)([g.sH],m.prototype,"searchQueryStringParameter",void 0);var h,d,p=s(1),S=s(8),y=s.n(S),b=s(642),f=s(643),_=s(0),x=s(30);function E(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function N(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?E(Object(s),!0).forEach((function(t){(0,a.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):E(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}!function(e){e.Category="ScopedCategory",e.Keyword="Keyword",e.Product="Product",e.None="None"}(h||(h={})),function(e){e.HideOOS="hideOOS",e.SortOOS="sortOOS",e.Default="default"}(d||(d={}));class C{constructor(e,t,s,a,r){this.getCacheKey=()=>"AutoSuggestSearchSuggestions",this.getCacheObjectType=()=>"AutoSuggestSearchSuggestions",this.dataCacheType=()=>"none",this.searchQuery=e,this.topResultsCount=t,this.suggestionType=s,this.hitPrefix=a,this.hitSuffix=r}}async function R(e,t,s){var a;const r=(0,o.getCatalogId)(s.requestContext);let n={SearchCondition:e.searchQuery&&e.searchQuery.length>0?e.searchQuery:"",Context:{ChannelId:+s.requestContext.apiSettings.channelId,CatalogId:r}};if((null===(a=s.requestContext.app.config)||void 0===a?void 0:a.productListInventoryDisplay)===d.HideOOS){const e=await(0,x.getInventoryConfigurationAsync)({callerContext:s}),t=!0,a=((e,t)=>{if(e&&e.ProductAvailabilitySortableAttributeRecordId)return{RefinerRecordId:e.ProductAvailabilitySortableAttributeRecordId,DataTypeValue:c.AttributeDataType.TrueFalse,LeftValueBoundString:t?"true":"false",RightValueBoundString:t?"true":"false",UnitText:"",RowNumber:0,Count:0,ExtensionProperties:[],RefinerSourceValue:c.ProductRefinerSource.Attribute}})(e,t);a&&(n=N(N({},n),{},{Refinement:[a]}))}const u={ProductSearchCriteria:n,HitPrefix:e.hitPrefix,HitSuffix:e.hitSuffix,SuggestionType:e.suggestionType},l=await(0,x.getSearchSuggestionsAsync)({callerContext:s,queryResultSettings:{Paging:{Top:e.topResultsCount}}},u);l&&l.length>0?(l.map((e=>e.ImageUrl=e.ImageUrl?(0,i.generateImageUrl)(e.ImageUrl,s.requestContext.apiSettings):"")),t.AllSearchResults=l):s.telemetry.error(`[getSearchSuggestionsAction] unable to get availabilites for search with suggestion type ${u.SuggestionType}`)}const O=(0,o.createObservableDataAction)({id:"@msdyn365-commerce-modules/search/get-auto-suggest-suggestions",action:async function(e,t){if(!e||!e.searchQuery)throw new Error("[getSearchSuggestionsAction]No valid Input was provided, failing");const s={},a=[R(e,s,t)];return Promise.all(a).then((()=>s))},input:e=>new C}),w=O;s(25),s(3),s(45),s(15),s(12),s(19);let v;const P=e=>{const{suggestions:t,searchText:s,autoSuggestProps:{resources:{categorySuggestionHeading:a}}}=e,r=[];v=(0,p.getPayloadObject)("click",e.telemetryContent,""),null==t||t.map((t=>{r.push(A(t,e))}));const n=T(a,s);return{title:n,text:r}},T=(e,t)=>{const s=e?(0,p.format)(e,t):`Search "${t}" in categories`;return _.createElement("li",{className:"msc-autoSuggest__categoryResults-title"},s)},A=(e,t)=>{const{searchText:s,hitPrefix:a,hitSuffix:r,shouldShowFullPath:n}=t,o=n?e.Value:e.Value&&e.Value.split("|").pop(),c=o?o.replace(new RegExp(`[${a}]`,"gi"),"").replace(new RegExp(`[${r}]`,"gi"),""):e.Value&&e.Value.replace(new RegExp(`[${a}]`,"gi"),"").replace(new RegExp(`[${r}]`,"gi"),"");v.contentAction.etext=e.Value;const i=(0,p.getTelemetryAttributes)(t.telemetryContent,v);return _.createElement("li",{className:"msc-autoSuggest__categoryResults-item",key:e.Id},_.createElement("a",Object.assign({"aria-label":c,href:j(e,s,t)},i),j(e,s,t)&&I(o||"",a,r)))},j=(e,t,s)=>e&&e.Id?L(e.Id,t,s):"",L=(e,t,s)=>{var a;const{searchPageURL:r,searchQsp:n,searchRefiners:i}=s;if(!o.default.isBrowser)return"";const u=new URL(r,window.location.href);n&&t&&u.searchParams.set(n,t);const l=null==i?void 0:i.find((e=>e.SourceValue===c.ProductRefinerSource.Category)),g=null==l||null===(a=l.Values)||void 0===a?void 0:a.find((t=>t.RefinerRecordId===Number.parseInt(e,10))),m=g&&JSON.stringify(k([g]));return m&&u.searchParams.set("refiners",m),u.href},I=(e,t,s)=>{const a=e.replace(new RegExp(`[${t}]`,"gi"),"<strong>").replace(new RegExp(`[${s}]`,"gi"),"</strong>");return _.createElement("span",{dangerouslySetInnerHTML:(0,o.getRichTextHtml)(a)})},F=["DataTypeValue","LeftValueBoundString","RefinerRecordId","RefinerSourceValue","RightValueBoundString","UnitText"],k=e=>{const t=[];return e.forEach((e=>{const s=[];F.forEach((t=>{s.push(e[t])})),t.push(s)})),t},D=e=>{const{searchQsp:t,searchPlaceholder:s,hideSearchLabel:a,searchTextInput:r,handleInputChange:n,maxChars:o,disableSubmitSearch:c,handleCancelSearchChange:i,query:u,ariaLabelCancel:l,ariaLabelSearch:g,ariaLabelSubmit:m}=e,h=(e=>t=>{e(t.target.value||"")})(n),d=a?_.createElement("input",{className:"ms-search__form-control",type:"text","aria-label":g,name:t,placeholder:s,ref:r,onChange:h,value:u}):_.createElement("input",{className:"ms-search__form-control",type:"text","aria-label":g,name:t,placeholder:s,ref:r,onChange:h,maxLength:o,value:u}),S=!c&&_.createElement(p.Button,{className:"ms-search__form-submitSearch","aria-label":m}),y=_.createElement(p.Button,{className:c?"ms-search__form-cancelSearchNoSumbit":"ms-search__form-cancelSearch","aria-label":l,onClick:i,type:"button"});return{input:d,cancelBtn:y,submitBtn:S}};let B;const V=e=>{const{suggestions:t,hitPrefix:s,hitSuffix:a}=e;B=(0,p.getPayloadObject)("click",e.telemetryContent,"");const r=[];return null==t||t.map((t=>{r.push(U(t,s,a,e))})),{text:r}},U=(e,t,s,a)=>{const r=e.Value&&e.Value.replace(new RegExp(`[${t}]`,"gi"),"").replace(new RegExp(`[${s}]`,"gi"),"");B.contentAction.etext=r;const n=(0,p.getTelemetryAttributes)(a.telemetryContent,B);return _.createElement("li",{className:"msc-autoSuggest__keywordResults-item",key:e.Id},_.createElement("a",Object.assign({"aria-label":r,href:q(e,t,s,a)},n),q(e,t,s,a)&&$(e.Value?e.Value:"",t,s)))},q=(e,t,s,a)=>{const{searchPageURL:r,searchQsp:n}=a,c=e.Value.replace(new RegExp(`[${t}]`,"gi"),"").replace(new RegExp(`[${s}]`,"gi"),"");if(!o.default.isBrowser)return"";const i=new URL(r,window.location.href);return n&&c&&i.searchParams.set(n,c),i.href},$=(e,t,s)=>{const a=e.replace(new RegExp(`[${t}]`,"gi"),"<strong>").replace(new RegExp(`[${s}]`,"gi"),"</strong>");return _.createElement("span",{dangerouslySetInnerHTML:(0,o.getRichTextHtml)(a)})},H=e=>{const{searchLabelClass:t,searchLabelArialLabel:s,isSearchFormExpanded:a,searchtext:r,searchCollapsedLabel:n,hideSearchLabel:o,handleCancelSearchChange:c,telemetryContent:i}=e,u=(0,p.getPayloadObject)("click",i,r,""),l=(0,p.getTelemetryAttributes)(i,u);return _.createElement("div",{className:t},_.createElement(p.Button,Object.assign({className:"ms-search__icon","aria-expanded":a,"aria-label":s,onClick:c,innerRef:n},l),!o&&_.createElement("span",{className:"ms-search__icon-text","aria-hidden":!0},r)))};var M=s(17);function K(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}let Q,W;const z=e=>{const{suggestions:t,hitSuffix:s,hitPrefix:a,autoSuggestProps:{context:{actionContext:r},resources:{productSuggestionHeading:n}},moduleType:o,moduleId:c}=e,i=[];W=e.telemetryContent,Q=(0,p.getPayloadObject)("click",e.telemetryContent,""),null==t||t.map((t=>{i.push(J(t,a,s,r,e,o,c))}));const u=G(n);return{title:u,items:i}},G=e=>{const t=e||"Go to products";return _.createElement("li",{className:"msc-autoSuggest__productResults-title"},t)},J=(e,t,s,a,r,n,o)=>{var c;const u=e.Value&&e.Value.replace(new RegExp(`[${t}]`,"gi"),"").replace(new RegExp(`[${s}]`,"gi"),""),l=null===(c=e.Value3)||void 0===c||null===(c=c.Value)||void 0===c?void 0:c.DecimalValue;return{text:ee(e.Value?e.Value:"",t,s),thumbnail:se(e,u||"",r),price:!i.ObjectExtensions.isNullOrUndefined(l)&&te(l,l,o,n,r),LiProduct:X(),AProduct:Y(e,t,s,a,r),id:e.Id}},X=()=>({className:"msc-autoSuggest__productResults-item",tag:"li"}),Y=(e,t,s,r,n)=>{const{autoSuggestProps:{context:o}}=n,c=e.Value&&e.Value.replace(new RegExp(`[${t}]`,"gi"),"").replace(new RegExp(`[${s}]`,"gi"),"");Q.contentAction.recid=e.Id;const i=(0,p.getTelemetryAttributes)(W,Q),u=o.cultureFormatter.formatCurrency(e.Value3.Value.DecimalValue);return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?K(Object(s),!0).forEach((function(t){(0,a.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):K(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({className:"msc-autoSuggest__productResults-item",tag:"a","aria-label":`${c} ${u}`,href:Z(e,t,s,r)},i)},Z=(e,t,s,a)=>{const r=e.Value.replace(new RegExp(`[${t}]`,"gi"),"").replace(new RegExp(`[${s}]`,"gi"),"");return e.Value&&e.Id?(0,i.getProductPageUrlSync)(r,e.Id,a,void 0):""},ee=(e,t,s)=>{const a=e.replace(new RegExp(`[${t}]`,"gi"),"<strong>").replace(new RegExp(`[${s}]`,"gi"),"</strong>");return _.createElement("span",{className:"msc-price msc-autoSuggest__productResults-item-text",dangerouslySetInnerHTML:(0,o.getRichTextHtml)(a)})},te=(e,t,s,a,r)=>{var n;const{autoSuggestProps:{context:o}}=r;return _.createElement(M.PriceComponent,{id:s,typeName:a,context:o,data:{price:{CustomerContextualPrice:e,BasePrice:t}},className:"msc-autoSuggest__productResults-item-price",freePriceText:null===(n=r.resources)||void 0===n?void 0:n.freePriceText})},se=(e,t,s)=>{const{autoSuggestProps:{context:{request:{gridSettings:a}},config:{imageSettings:r}}}=s;if(r&&(r.cropFocalRegion=!0),!e||!e.ImageUrl)return s.telemetry.error("Search suggestion content is empty, module wont render."),null;return _.createElement(o.Image,{requestContext:s.autoSuggestProps.context.actionContext.requestContext,altText:t,className:"msc-autoSuggest__productResults-item-img",src:e.ImageUrl,gridSettings:a,imageSettings:r||{viewports:{xs:{q:"w=40&h=40&m=6",w:0,h:0},lg:{q:"w=40&h=40&m=6",w:0,h:0},xl:{q:"w=40&h=40&m=6",w:0,h:0}},lazyload:!0,cropFocalRegion:!0},loadFailureBehavior:"empty"})};function ae(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function re(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(s),!0).forEach((function(t){(0,a.A)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ae(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}class ne extends _.Component{constructor(e){super(e),this.hitPrefix="{",this.hitSuffix="}",this.waitTime=500,this._isLoadingNode=()=>{const e=this.props.resources.autoSuggestResultLoadingMessage;return _.createElement(b.y,{className:"msc-autoSuggest__loadingResult",label:e,size:f.H.medium,labelPosition:"right"})},this._focusOutTarget=e=>{const{suggestions:t}=this.state;t&&t.AllSearchResults&&null===e.target.closest(".ms-search")&&this._clearAutoSuggestState()},this._keyup=e=>{const{suggestions:t}=this.state;t&&t.AllSearchResults&&e.keyCode===p.KeyCodes.Escape?this._clearAutoSuggestState():this.state.isSearchFormExpanded&&e.keyCode===p.KeyCodes.Escape&&this.state.isSearchFormExpanded&&this.setState({isSearchFormExpanded:!1}),this.formReference.current&&this.formReference.current.contains(e.target)||this.autoSuggestResultDiv.current&&this.autoSuggestResultDiv.current.contains(e.target)||(t&&t.AllSearchResults&&this._clearAutoSuggestState(),this.state.isSearchFormExpanded&&this.setState({isSearchFormExpanded:!1}))},this._clearAutoSuggestState=()=>{const{context:{actionContext:e},data:{searchState:t}}=this.props;this.searchTextInput.current&&this.searchTextInput.current.value.length>0&&(t.searchText="",t.defaultBasicSearchUrl="",t.searchQueryStringParameter="",e&&e.update((0,u.createSearchStateInput)(t),t),this.searchTextInput.current.value=""),this.setState({searchText:"",suggestions:void 0,searchRefiners:void 0})},this._handleInputChange=e=>{(!e||e.length<=this.maxChars)&&this.setState({searchText:e}),this.cancellabelDebounce&&this.cancellabelDebounce.cancel();const{context:t,data:{searchState:s}}=this.props;if(t){if(e&&e.length>0){if(e.length>this.maxChars)return;i.ArrayExtensions.hasElements(this.inputSuggestionType)&&this._loadSuggestions(e),s.searchText=e}else this.setState({suggestions:void 0,searchRefiners:void 0}),s.searchText="";t.actionContext.update((0,u.createSearchStateInput)(s),s)}},this._handleSubmit=e=>{const{config:{disableSubmitSearch:t},context:{actionContext:s,app:{config:{searchQueryStringParameter:a}}}}=this.props,r=this.searchTextInput.current&&this.searchTextInput.current.value;if(e.preventDefault(),!r||r&&0===r.length||t)this.searchTextInput&&this.searchTextInput.current&&this.searchTextInput.current.focus();else{const e=a||"q",t=this._appendQueryParams((0,o.getUrlSync)("search",s)||"",r,e);document.location.href=t}},this._handleCancelSearchChange=()=>{const{isSearchFormExpanded:e,suggestions:t}=this.state;e?(t&&t.AllSearchResults&&this._clearAutoSuggestState(),this.setState({isSearchFormExpanded:!1})):this.setState({isSearchFormExpanded:!0,searchText:"",isInitialState:!1})},this._handleCancelSearchFocused=()=>{const{suggestions:e}=this.state;e&&e.AllSearchResults||(this._clearAutoSuggestState(),this.setState({isSearchFormExpanded:!1}))},this._appendQueryParams=(e,t,s)=>{if(!o.default.isBrowser)return"";const a=new URL(e,window.location.href);return s&&t&&a.searchParams.set(s,t),a.href},this._setAutoSuggestResultCount=e=>{if(null!==this.autoSuggestResultScreenReaderDiv.current){const t=this.autoSuggestResultScreenReaderDiv.current,s=this.props.resources.autoSuggestFoundMessage,a=this.props.resources.noAutoSuggestionMessage;return t.innerText=e&&e.AllSearchResults&&e.AllSearchResults.length>0?s:a,t.setAttribute("aria-live","assertive"),t.innerText}return""},this.searchTextInput=_.createRef(),this.searchCollapsedLabel=_.createRef(),this.autoSuggestResultScreenReaderDiv=_.createRef(),this.autoSuggestResultDiv=_.createRef(),this.formReference=_.createRef(),this.state={isSearchFormExpanded:!1,searchText:"",searchKeywordSuggestClass:"ms-search__autoSuggest__keyword",searchProductSuggestClass:"ms-search__autoSuggest__product",searchCategorySuggestClass:"ms-search__autoSuggest__category",suggestions:void 0,searchRefiners:void 0,autoSuggestAriaLabel:"",isInitialState:!0,isLoadingAutoSuggest:!1},this.maxChars=this.props.context&&this.props.context.app&&this.props.context.app.config&&this.props.context.app.config.searchInputMaxLength||50,this.inputSuggestionType=[],this.topResultsCount=this.props.config&&this.props.config.topResultsCount?this.props.config.topResultsCount:5,this.searchFormClass="ms-search__form",this.searchLabelClass="ms-search__label",this.telemetryContent=(0,p.getTelemetryObject)(this.props.context.request.telemetryPageName,this.props.friendlyName,this.props.telemetry),this._initSuggestionTypes()}async componentDidMount(){document.body&&document.body.addEventListener("mousedown",this._focusOutTarget),window&&window.addEventListener("keyup",this._keyup)}componentWillUnmount(){document.body&&document.body.removeEventListener("mousedown",this._focusOutTarget,!1),window&&window.removeEventListener("keyup",this._keyup,!1)}componentDidUpdate(){const{config:{hideSearchLabel:e}}=this.props,{isSearchFormExpanded:t,isInitialState:s}=this.state;this.props.context.request.params.isEditor||(!e&&t?this.searchTextInput&&this.searchTextInput.current&&this.searchTextInput.current.focus():s||this.searchCollapsedLabel&&this.searchCollapsedLabel.current&&this.searchCollapsedLabel.current.focus())}shouldComponentUpdate(e,t){return this.state!==t||this.props!==e}render(){var e,t,s;const{context:a,resources:{searchtext:r,searchLabelArialLabel:n,cancelBtnAriaLabel:u,searchBtnAriaLabel:l,submitBtnAriaLabel:g},config:{hideSearchLabel:m,disableSubmitSearch:d,searchplaceholderText:p,shouldShowFullCategoryPath:S,className:b=""}}=this.props,{isSearchFormExpanded:f,searchText:_,searchKeywordSuggestClass:x,searchProductSuggestClass:E,searchCategorySuggestClass:N,suggestions:C,searchRefiners:R,isLoadingAutoSuggest:O}=this.state,w=a&&a.app&&a.app.config&&a.app.config.searchQueryStringParameter||"q",v=(0,o.getUrlSync)("search",a&&a.actionContext)||"",T=this._appendQueryParams(v,_,w),A=p&&p.length>0?p:"Search in Fabrikam",j=null==C||null===(e=C.AllSearchResults)||void 0===e?void 0:e.filter((e=>e.SuggestionType===h.Keyword||e.SuggestionType===h.None)),L=null==C||null===(t=C.AllSearchResults)||void 0===t?void 0:t.filter((e=>e.SuggestionType===h.Product)),I=null==R?void 0:R.find((e=>e.SourceValue===c.ProductRefinerSource.Category)),F=null==C||null===(s=C.AllSearchResults)||void 0===s?void 0:s.filter((e=>{var t;if(e.SuggestionType!==h.Category)return!1;const s=null==I||null===(t=I.Values)||void 0===t?void 0:t.find((t=>{var s;return`${null!==(s=t.RefinerRecordId)&&void 0!==s?s:0}`===e.Id}));return!i.ObjectExtensions.isNullOrUndefined(s)})),k=re(re({},this.props),{},{Search:{moduleProps:this.props,className:`${y()("ms-search",b)} ${d?"no-submit":"with-submit"}`},AutoSuggestAriaLabel:{tag:"div",className:"msc-autoSuggest__screen-reader","aria-live":"assertive",ref:this.autoSuggestResultScreenReaderDiv},AutoSuggestAriaLabelText:this.state.autoSuggestAriaLabel,searchText:this.state.searchText,AutoSuggest:{ref:this.autoSuggestResultDiv,className:"ms-search__autoSuggest"},KeywordSuggest:{className:x},ProductSuggest:{className:E},CategorySuggest:{className:N},SearchForm:{className:`${this.searchFormClass} ${f?"bx-show":"bx-hide"}`},FormWrapper:{tag:"form",ref:this.formReference,className:"ms-search__searchForm","aria-label":"Search",name:"searchForm",role:"search",action:T,autoComplete:"off",onSubmit:this._handleSubmit},UlKeyword:{tag:"ul",className:y()("msc-autoSuggest__keywordResults-items",b)},UlProduct:{tag:"ul",className:y()("msc-autoSuggest__productResults-items",b)},UlCategory:{tag:"ul",className:y()("msc-autoSuggest__categoryResults-items",b)},label:H({isSearchFormExpanded:f,searchLabelClass:`${this.searchLabelClass} ${f?"bx-hide":"bx-show"}`,searchtext:r,searchLabelArialLabel:n,searchCollapsedLabel:this.searchCollapsedLabel,hideSearchLabel:m,handleCancelSearchChange:this._handleCancelSearchChange,telemetryContent:this.telemetryContent}),form:D({ariaLabelCancel:u,ariaLabelSearch:l,ariaLabelSubmit:g,hideSearchLabel:m,searchTextInput:this.searchTextInput,disableSubmitSearch:d,handleInputChange:this._handleInputChange,handleCancelSearchChange:this._handleCancelSearchChange,maxChars:this.maxChars,searchQsp:w,searchPlaceholder:A,query:_}),autosuggestKeyword:_&&_.length>0&&(O||j&&i.ArrayExtensions.hasElements(j))?V({searchKeywordSuggestClass:x,searchPageURL:v,searchQsp:w,hitPrefix:this.hitPrefix,hitSuffix:this.hitSuffix,autoSuggestProps:this.props,searchText:_,suggestions:j,telemetryContent:this.telemetryContent}):void 0,autosuggestProduct:_&&_.length>0&&(O||L&&i.ArrayExtensions.hasElements(L))?z({searchProductSuggestClass:E,searchPageURL:v,searchQsp:w,hitPrefix:this.hitPrefix,hitSuffix:this.hitSuffix,autoSuggestProps:this.props,searchText:_,suggestions:L,telemetry:this.props.telemetry,moduleType:this.props.typeName,moduleId:this.props.id,telemetryContent:this.telemetryContent,resources:this.props.resources}):void 0,autosuggestCategory:_&&_.length>0&&(O||F&&i.ArrayExtensions.hasElements(F))?P({searchCategorySuggestClass:N,searchPageURL:v,searchQsp:w,hitPrefix:this.hitPrefix,hitSuffix:this.hitSuffix,autoSuggestProps:this.props,searchText:_,suggestions:F,searchRefiners:R,telemetryContent:this.telemetryContent,shouldShowFullPath:S}):void 0,callbacks:{handleCancelSearchChange:this._handleCancelSearchChange,handleCancelSearchFocused:this._handleCancelSearchFocused},isSearchFormExpanded:this.state.isSearchFormExpanded,isLoadingAutoSuggest:O,isLoadingNode:this._isLoadingNode()});return this.props.renderView(k)}_initSuggestionTypes(){const e=this.props.config.suggestionTypeCriterion,t=i.ArrayExtensions.unique(i.ArrayExtensions.validValues(e));if(!i.ArrayExtensions.hasElements(t))return void(this.inputSuggestionType=[{SuggestionType:"keyword"},{SuggestionType:"product"},{SuggestionType:"scopedCategory"}]);const s=t.filter((e=>e.SuggestionType));i.ArrayExtensions.hasElements(s)?this.inputSuggestionType=s:this.inputSuggestionType=[]}async _getSearchSuggestions(e,t){try{const s=await w(new C(t,this.topResultsCount,this._getSuggestionType(),this.hitPrefix,this.hitSuffix),this.props.context.actionContext);if(e!==this.loadSuggestionsRequestId)return;return s}catch(t){if(e!==this.loadSuggestionsRequestId)return;return this.setState({suggestions:void 0,searchRefiners:void 0,autoSuggestAriaLabel:this._setAutoSuggestResultCount()}),this.props.telemetry.exception(t),void this.props.telemetry.debug("Unable to get auto suggest results")}}async _updateSearchRefiners(e,t,s){try{const a=await this._getSearchRefiners(t);if(e!==this.loadSuggestionsRequestId)return;this.setState({suggestions:s,searchRefiners:a,autoSuggestAriaLabel:this._setAutoSuggestResultCount(s),isLoadingAutoSuggest:!1})}catch(t){if(e!==this.loadSuggestionsRequestId)return;this.setState({suggestions:s,searchRefiners:void 0,autoSuggestAriaLabel:this._setAutoSuggestResultCount(s)}),this.props.telemetry.exception(t),this.props.telemetry.debug("Unable to get refiners results")}}_loadSuggestions(e){this.cancellabelDebounce=n()((async()=>{this.setState({isLoadingAutoSuggest:!0});const t=i.Random.Guid.generateGuid();this.loadSuggestionsRequestId=t;const s=await this._getSearchSuggestions(t,e);await this._updateSearchRefiners(t,e,s)}),this.waitTime),setTimeout((()=>{this.cancellabelDebounce()}),0)}_getSuggestionType(){const e=this.inputSuggestionType.map((e=>e.SuggestionType.charAt(0).toUpperCase()+e.SuggestionType.slice(1)));return e.join(",")}async _getSearchRefiners(e){const{actionContext:t}=this.props.context,s=(0,o.getCatalogId)(t.requestContext);return(0,i.validateCatalogId)(s),c.ProductsDataActions.getProductSearchRefinersAsync({callerContext:t},{SearchCondition:e,Context:{ChannelId:+t.requestContext.apiSettings.channelId,CatalogId:s}})}}const oe=ne},1590:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});s(3),s(9);var a=s(6),r=s(1),n=s(0),o=s.n(n);const c=e=>{const t=e||"In categories";return o().createElement("div",{className:"msc-autoSuggest__categoryResults-title"},t)},i=(e,t,s,a,n)=>s.autosuggestCategory?o().createElement(r.Node,Object.assign({},s.CategorySuggest),c(e),o().createElement(r.Node,Object.assign({},s.UlCategory),a&&n,!a&&s.autosuggestCategory.text.map((e=>e)))):o().createElement(r.Node,Object.assign({},s.CategorySuggest),c(e),o().createElement(r.Node,Object.assign({},s.UlCategory),o().createElement("li",{className:"msc-autoSuggest__categoryResults-no-results"},t)));var u=s(2);const l=e=>o().createElement(r.Node,{className:"msc-autoSuggest__productResults-empty-mobile-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-no-results-image"},(e=>{const t=e.config.noSearchResultImage;return t&&t.src?o().createElement(u.Image,{altText:t.altText,className:"msc-autoSuggest__productResults-no-results-image-img",gridSettings:e.context.request.gridSettings,src:t.src,requestContext:e.context.request,imageSettings:{lazyload:!0,viewports:{xs:{w:100,h:100,q:"w=100&h=100&q=60&m=6"}}}}):null})(e)),o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-text-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-heading"},e.resources.emptyMobileSearchTextHeading),o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-text"},e.resources.emptyMobileSearchText))),g=(e,t,s,a,n,c,i,u)=>{const g=o().createElement(r.Button,{className:"ms-search__form-cancelSearch","aria-label":c.resources.cancelBtnAriaLabel,onClick:u,type:"button"});return a?o().createElement(r.Node,Object.assign({},t),e.cancelBtn,o().createElement(r.Node,Object.assign({},s),e.input,i&&((e,t)=>o().createElement(r.Button,{className:"ms-search__form-control__clear",title:e||"Clear",onClick:t},e||"Clear"))(n,u),i?null:l(c))):o().createElement(r.Node,Object.assign({},t),o().createElement(r.Node,Object.assign({},s),e.submitBtn,e.input,i&&g))},m=e=>{const t=e||"Products";return o().createElement("div",{className:"msc-autoSuggest__productResults-title"},t)},h=e=>o().createElement(r.Node,{className:"msc-autoSuggest__productResults-no-results-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-image"},(e=>{const t=e.config.noSearchResultImage;return t&&t.src?o().createElement(u.Image,{altText:t.altText,className:"msc-autoSuggest__productResults-no-results-image-img",gridSettings:e.context.request.gridSettings,src:t.src}):null})(e)),o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-content-title"},e.resources.noResultContentHeadingText),o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-content-paragraph"},e.resources.noResultContentParagraphText)),d=(e,t,s,a,n,c)=>a?o().createElement(r.Node,Object.assign({},e),m(s.resources.productSuggestionHeading),o().createElement(r.Node,Object.assign({},t),n&&c,!n&&a.items.map(((e,t)=>{var s;return o().createElement(r.Node,Object.assign({},e.LiProduct,{key:null!==(s=e.id)&&void 0!==s?s:t}),o().createElement(r.Node,Object.assign({},e.AProduct),e.thumbnail,e.text,e.price))})))):o().createElement(r.Node,Object.assign({},e),m(s.resources.productSuggestionHeading),o().createElement(r.Node,Object.assign({},t),o().createElement(r.Node,Object.assign({},{tag:"li",className:"msc-no-result-content"}),h(s)))),p=(e,t)=>{const s='"'.concat(t.concat('"')),a=e?(0,r.format)(e,s):`Search for ${s}`;return o().createElement(r.Node,{className:"msc-autoSuggest__search-title"},a)},S=e=>{const{Search:t,AutoSuggestAriaLabel:s,AutoSuggestAriaLabelText:c,searchText:u,AutoSuggest:l,ProductSuggest:m,UlProduct:h,form:S,autosuggestProduct:y,SearchForm:b,FormWrapper:f,label:_,context:x,isLoadingAutoSuggest:E,isLoadingNode:N}=e,{searchSuggestionHeading:C,categorySuggestionHeading:R,noResultText:O,clearSearchButtonText:w}=e.resources,[v,P]=(0,n.useState)(),[T,A]=(0,n.useState)(!1);(0,n.useEffect)((()=>{P(u)}),[u]);const j=()=>{P("");const t=e.form,s=t.input,a=s.ref.current;a&&(a.value=""),s.value="",e.searchText="",e.FormWrapper.action=""},L=(0,n.useCallback)((()=>{const e="xs"===(0,r.isMobile)({variant:r.VariantType.Browser,context:x.request});A(e)}),[x]);(0,n.useEffect)((()=>{window.addEventListener("resize",L),L()}),[L]);const I=(0,r.isMobile)({variant:r.VariantType.Browser,context:x.request}),F="sm"===I||"xs"===I;l.className=a.StringExtensions.isNullOrEmpty(v)?`${l.className} hide`:`${l.className} show`;const k=!a.StringExtensions.isNullOrEmpty(v);return o().createElement(r.Module,Object.assign({},t),_,g(S,b,f,T,w,e,k,j),!F&&o().createElement(r.Node,Object.assign({},l),a.StringExtensions.isNullOrEmpty(v)?"":o().createElement(r.Node,Object.assign({},s),c),a.StringExtensions.isNullOrEmpty(v)?null:o().createElement(o().Fragment,null,o().createElement(r.Node,{className:"msc-autoSuggest__search-title-container"},o().createElement(r.Button,{className:"ms-search__form-cancelSearch","aria-label":e.resources.cancelBtnAriaLabel,onClick:j,type:"button"}),p(C,u)),o().createElement(r.Node,{className:"msc-autoSuggest__results-container"},o().createElement(r.Node,{className:"msc-autoSuggest__results"},i(R,O,e,E,N)),d(m,h,e,y,E,N)))),F&&e.isSearchFormExpanded&&o().createElement(r.Node,Object.assign({},l),a.StringExtensions.isNullOrEmpty(v)?"":o().createElement(r.Node,Object.assign({},s),c),a.StringExtensions.isNullOrEmpty(v)?null:o().createElement(o().Fragment,null,o().createElement(r.Node,{className:"msc-autoSuggest__search-title-container"},S.cancelBtn,p(C,u)),o().createElement(r.Node,{className:"msc-autoSuggest__results-container"},o().createElement(r.Node,{className:"msc-autoSuggest__results"},i(R,O,e,E,N)),d(m,h,e,y,E,N)))))}},1591:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});s(3);var a=s(1),r=s(0);const n=(e,t,s)=>r.createElement(a.Node,Object.assign({},t),r.createElement(a.Node,Object.assign({},s),e.input,e.cancelBtn,e.submitBtn)),o=(e,t,s,n,o)=>s&&r.createElement(a.Node,Object.assign({},e),r.createElement(a.Node,Object.assign({},t),n&&o,!n&&s.text.map((e=>e)))),c=(e,t,s,n,o)=>s&&r.createElement(a.Node,Object.assign({},e),r.createElement(a.Node,Object.assign({},t),s.title,n&&o,!n&&s.items.map(((e,t)=>r.createElement(a.Node,Object.assign({},e.LiProduct,{key:e.id||t}),r.createElement(a.Node,Object.assign({},e.AProduct),e.thumbnail,e.text,e.price)))))),i=(e,t,s,n,o)=>s&&r.createElement(a.Node,Object.assign({},e),r.createElement(a.Node,Object.assign({},t),s.title,n&&o,!n&&s.text.map((e=>e)))),u=e=>{const{Search:t,AutoSuggestAriaLabel:s,AutoSuggestAriaLabelText:u,searchText:l,AutoSuggest:g,KeywordSuggest:m,ProductSuggest:h,CategorySuggest:d,UlKeyword:p,UlProduct:S,UlCategory:y,form:b,autosuggestCategory:f,autosuggestKeyword:_,autosuggestProduct:x,SearchForm:E,FormWrapper:N,label:C,isLoadingAutoSuggest:R,isLoadingNode:O}=e;return r.createElement(a.Module,Object.assign({},t),C,n(b,E,N),r.createElement(a.Node,Object.assign({},g),l&&l.length>0?r.createElement(a.Node,Object.assign({},s),u):"",o(m,p,_,R,O),c(h,S,x,R,O),i(d,y,f,R,O)))}},1592:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});s(3),s(9);var a=s(6),r=s(1),n=s(0),o=s.n(n);const c=e=>{const t=e||"In categories";return o().createElement("div",{className:"msc-autoSuggest__categoryResults-title"},t)},i=(e,t,s,a,n)=>s.autosuggestCategory?o().createElement(r.Node,Object.assign({},s.CategorySuggest),c(e),o().createElement(r.Node,Object.assign({},s.UlCategory),a&&n,!a&&s.autosuggestCategory.text.map((e=>e)))):o().createElement(r.Node,Object.assign({},s.CategorySuggest),c(e),o().createElement(r.Node,Object.assign({},s.UlCategory),o().createElement("li",{className:"msc-autoSuggest__categoryResults-no-results"},t)));var u=s(2);const l=e=>o().createElement(r.Node,{className:"msc-autoSuggest__productResults-empty-mobile-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-no-results-image"},(e=>{const t=e.config.noSearchResultImage;return t&&t.src?o().createElement(u.Image,{altText:t.altText,className:"msc-autoSuggest__productResults-no-results-image-img",gridSettings:e.context.request.gridSettings,src:t.src,requestContext:e.context.request,imageSettings:{lazyload:!0,viewports:{xs:{w:100,h:100,q:"w=100&h=100&q=60&m=6"}}}}):null})(e)),o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-text-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-heading"},e.resources.emptyMobileSearchTextHeading),o().createElement("div",{className:"msc-autoSuggest__productResults-empty-mobile-text"},e.resources.emptyMobileSearchText))),g=(e,t,s,a,n,c,i,u)=>{const g=o().createElement(r.Button,{className:"ms-search__form-cancelSearch","aria-label":c.resources.cancelBtnAriaLabel,onClick:u,type:"button"});return a?o().createElement(r.Node,Object.assign({},t),e.cancelBtn,o().createElement(r.Node,Object.assign({},s),e.input,i&&((e,t)=>o().createElement(r.Button,{className:"ms-search__form-control__clear",title:e||"Clear",onClick:t},e||"Clear"))(n,u),i?null:l(c))):o().createElement(r.Node,Object.assign({},t),o().createElement(r.Node,Object.assign({},s),e.submitBtn,e.input,i&&g))},m=e=>{const t=e||"Keywords";return o().createElement("div",{className:"msc-autoSuggest_keywordsResults-title"},t)},h=(e,t,s,a,n,c,i)=>n?o().createElement(r.Node,Object.assign({},e),m(s),o().createElement(r.Node,Object.assign({},t),c&&i,!c&&n.text.map((e=>e)))):o().createElement(r.Node,Object.assign({},e),m(s),o().createElement(r.Node,Object.assign({},t),o().createElement("li",{className:"msc-autoSuggest__keywordResults-no-results"},a))),d=e=>{const t=e||"Products";return o().createElement("div",{className:"msc-autoSuggest__productResults-title"},t)},p=e=>o().createElement(r.Node,{className:"msc-autoSuggest__productResults-no-results-content"},o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-image"},(e=>{const t=e.config.noSearchResultImage;return t&&t.src?o().createElement(u.Image,{altText:t.altText,className:"msc-autoSuggest__productResults-no-results-image-img",gridSettings:e.context.request.gridSettings,src:t.src}):null})(e)),o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-content-title"},e.resources.noResultContentHeadingText),o().createElement("div",{className:"msc-autoSuggest__productResults-no-results-content-paragraph"},e.resources.noResultContentParagraphText)),S=(e,t,s,a,n,c)=>a?o().createElement(r.Node,Object.assign({},e),d(s.resources.productSuggestionHeading),o().createElement(r.Node,Object.assign({},t),n&&c,!n&&a.items.map(((e,t)=>{var s;return o().createElement(r.Node,Object.assign({},e.LiProduct,{key:null!==(s=e.id)&&void 0!==s?s:t}),o().createElement(r.Node,Object.assign({},e.AProduct),e.thumbnail,e.text,e.price))})))):o().createElement(r.Node,Object.assign({},e),d(s.resources.productSuggestionHeading),o().createElement(r.Node,Object.assign({},t),o().createElement(r.Node,Object.assign({},{tag:"li",className:"msc-no-result-content"}),p(s)))),y=(e,t)=>{const s='"'.concat(t.concat('"')),a=e?(0,r.format)(e,s):`Search for ${s}`;return o().createElement(r.Node,{className:"msc-autoSuggest__search-title"},a)},b=e=>{const{Search:t,AutoSuggestAriaLabel:s,AutoSuggestAriaLabelText:c,searchText:u,AutoSuggest:l,KeywordSuggest:m,ProductSuggest:d,UlKeyword:p,UlProduct:b,form:f,autosuggestKeyword:_,autosuggestProduct:x,SearchForm:E,FormWrapper:N,label:C,context:R,isLoadingAutoSuggest:O,isLoadingNode:w,callbacks:{handleCancelSearchFocused:v}}=e,{searchSuggestionHeading:P,categorySuggestionHeading:T,keywordsHeading:A,noResultText:j,clearSearchButtonText:L}=e.resources,[I,F]=(0,n.useState)(),[k,D]=(0,n.useState)(!1);(0,n.useEffect)((()=>{F(u)}),[u]);const B=()=>{F("");const t=e.form,s=t.input,a=s.ref.current;a&&(a.value=""),s.value="",e.searchText="",e.FormWrapper.action=""},V=(0,n.useCallback)((()=>{const e="xs"===(0,r.isMobile)({variant:r.VariantType.Browser,context:R.request});D(e)}),[R]);(0,n.useEffect)((()=>{window.addEventListener("resize",V),V()}),[V]);const U=(0,r.isMobile)({variant:r.VariantType.Browser,context:R.request}),q="sm"===U||"xs"===U;l.className=a.StringExtensions.isNullOrEmpty(I)?`${l.className} hide`:`${l.className} show`;const $=!a.StringExtensions.isNullOrEmpty(I);return o().createElement(r.Module,Object.assign({},t),C,g(f,E,N,k,L,e,$,B),!q&&o().createElement(r.Node,Object.assign({},l),a.StringExtensions.isNullOrEmpty(I)?"":o().createElement(r.Node,Object.assign({},s),c),a.StringExtensions.isNullOrEmpty(I)?null:o().createElement(o().Fragment,null,o().createElement(r.Node,{className:"msc-autoSuggest__search-title-container"},o().createElement(r.Button,{className:"ms-search__form-cancelSearch","aria-label":e.resources.cancelBtnAriaLabel,onClick:B,onBlur:v,type:"button"}),y(P,u)),o().createElement(r.Node,{className:"msc-autoSuggest__results-container"},o().createElement(r.Node,{className:"msc-autoSuggest__results"},i(T,j,e,O,w),h(m,p,A,j,_,O,w)),S(d,b,e,x,O,w)))),q&&e.isSearchFormExpanded&&o().createElement(r.Node,Object.assign({},l),a.StringExtensions.isNullOrEmpty(I)?"":o().createElement(r.Node,Object.assign({},s),c),a.StringExtensions.isNullOrEmpty(I)?null:o().createElement(o().Fragment,null,o().createElement(r.Node,{className:"msc-autoSuggest__search-title-container"},f.cancelBtn,y(P,u)),o().createElement(r.Node,{className:"msc-autoSuggest__results-container"},o().createElement(r.Node,{className:"msc-autoSuggest__results"},i(T,j,e,O,w),h(m,p,A,j,_,O,w)),S(d,b,e,x,O,w)))))}}},e=>{e.O(0,[0,3,2,4,5,6,7,8,9,10,11],(()=>{return t=1588,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=7d649b45701bd8cd922d.bundle.js.map