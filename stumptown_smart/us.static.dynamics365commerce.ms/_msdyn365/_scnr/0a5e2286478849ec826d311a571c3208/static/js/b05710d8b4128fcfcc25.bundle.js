/*! For license information please see b05710d8b4128fcfcc25.bundle.js.LICENSE.txt */
(self.webpackChunkMsdyn365_Commerce_Online=self.webpackChunkMsdyn365_Commerce_Online||[]).push([[8],{6:(e,t,r)=>{"use strict";r.d(t,{ActiveCartProductsInput:()=>R.ActiveCartProductsInput,AddItemToOrderTemplateInput:()=>_.EL,AddItemToProductListInput:()=>i.Jx,AddOrderTemplateToCartInput:()=>z.F3,AddOrganizationUserInput:()=>o.C4,AddressManagementInput:()=>n._O,ArrayExtensions:()=>se.ArrayExtensions,AttributesForSelectedVariantInput:()=>l.ho,CartConfigurationInput:()=>g.CartConfigurationInput,CreateOrderTemplateInput:()=>$.Fh,CreateProductListInput:()=>a.w3,CurrentCategoryInput:()=>y.CurrentCategoryInput,DeleteOrganizationUserInput:()=>s.os,DeliveryMode:()=>se.DeliveryMode,Dictionary:()=>se.Dictionary,DimensionAvailabilitiesForProductSearchResultInput:()=>v.Td,DimensionSwatchDisplayTypes:()=>se.DimensionSwatchDisplayTypes,DimensionTypes:()=>se.DimensionTypes,EditOrganizationUserInput:()=>c.JN,EmailRegex:()=>se.EmailRegex,EnumExtensions:()=>se.EnumExtensions,FullProductInput:()=>P.Tj,GenericInput:()=>u.a,GetCustomerInput:()=>h.GetCustomerInput,GetDeliveryOptionsForCartLineAddressInput:()=>B.oe,GetDeliveryOptionsForSelectedVariantInput:()=>m.GetDeliveryOptionsForSelectedVariantInput,GetDimensionsForSelectedVariantInput:()=>I.GetDimensionsForSelectedVariantInput,GetFullAvailableInventoryNearbyInput:()=>b.GetFullAvailableInventoryNearbyInput,GetFullOrderTemplateInput:()=>H.kz,GetFullProductListInput:()=>A.dP,GetInvoicesInput:()=>G.GetInvoicesInput,GetLoyaltyCardInput:()=>S.GetLoyaltyCardInput,GetLoyaltyTransactionEstimationInput:()=>w.GetLoyaltyTransactionEstimationInput,GetOrderTemplatesInput:()=>Z.GetOrderTemplatesInput,GetOrgUnitLocationsByAreaInput:()=>M.GetOrgUnitLocationsByAreaInput,GetOrganizationWideOrderHistoryInput:()=>O.Tn,GetPaginatedOrderTemplateLinesInput:()=>X.F6,GetProductListLinesInput:()=>q.ZN,GetRatingsSummaryInput:()=>j.f,GetScanResultInput:()=>N.VW,InventoryLevelValues:()=>se.InventoryLevelValues,InventoryLevels:()=>se.InventoryLevels,IssueLoyaltyInput:()=>W.CN,ListInput:()=>D.ZB,MediaLocationsForSelectedVariantInput:()=>T.MediaLocationsForSelectedVariantInput,ObjectExtensions:()=>se.ObjectExtensions,OrderTemplate:()=>ce.$,PasswordRegex:()=>se.PasswordRegex,PhoneRegex:()=>se.PhoneRegex,PriceForProductSearchResultInput:()=>L.Fx,PriceForSelectedVariantInput:()=>U.PriceForSelectedVariantInput,ProductAvailabilitiesForCartLineItems:()=>d.ProductAvailabilitiesForCartLineItems,ProductAvailabilitiesForSelectedVariantInput:()=>F.ProductAvailabilitiesForSelectedVariantInput,ProductDeliveryOptionsForCartLineItems:()=>p.ProductDeliveryOptionsForCartLineItems,ProductDetailsCriteria:()=>P.Pe,ProductInput:()=>K.M$,ProductPickUpOptionsForCartLineItems:()=>x.ProductPickUpOptionsForCartLineItems,ProductPriceForSelectedProductsInput:()=>E.Lg,ProductsDimensionAvailabilitiesInput:()=>f.ML,PromotionOptionsForCartLineItems:()=>V.bJ,QueryResultSettingsProxy:()=>le.l,Random:()=>se.Random,SelectedVariantInput:()=>Q.SelectedVariantInput,StringExtensions:()=>se.StringExtensions,UpdateOrderTemplateHeaderInput:()=>Y.N0,UpdateOrderTemplateInput:()=>J.af,addAddress:()=>n.Ay,addItemToOrderTemplate:()=>_.Ay,addItemToProductListAction:()=>i.Ay,addOrderTemplateToCartAction:()=>z.Ay,addOrganizationUser:()=>o.Ay,buildCacheKey:()=>se.buildCacheKey,buildCacheKeyWithUrlTokens:()=>se.buildCacheKeyWithUrlTokens,buildWishlistLine:()=>se.buildWishlistLine,checkIfShouldDisplayAsSwatch:()=>se.checkIfShouldDisplayAsSwatch,convertDimensionTypeToProductDimensionType:()=>se.convertDimensionTypeToProductDimensionType,convertProductDimensionTypeToDimensionTypes:()=>se.convertProductDimensionTypeToDimensionTypes,createGetFeatureStateInput:()=>C.createGetFeatureStateInput,createInventoryAvailabilitySearchCriteria:()=>oe.L9,createOrderTemplate:()=>$.Ay,createProductList:()=>a.Ay,deleteOrganizationUser:()=>s.Ay,editOrganizationUser:()=>c.Ay,generateCacheKey:()=>se.generateCacheKey,generateImageUrl:()=>se.generateImageUrl,generateProductImageUrl:()=>se.generateProductImageUrl,generateSwatchImageUrl:()=>se.generateSwatchImageUrl,getActiveCartProductsAction:()=>R.default,getAttributeValuesByConfiguration:()=>se.getAttributeValuesByConfiguration,getAttributesForSelectedVariantAction:()=>l.Xy,getAvailabilitiesForCartLineItems:()=>d.default,getCartConfiguration:()=>g.default,getCategoryUrl:()=>ue.K,getCurrentCategory:()=>y.default,getCustomer:()=>h.default,getDeliveryOptionsForCartLineAddress:()=>B.Ay,getDeliveryOptionsForCartLineItems:()=>p.default,getDeliveryOptionsForSelectedVariant:()=>m.default,getDimensionAvailabilitiesForProductSearchResultAction:()=>v.Ay,getDimensionAvailabilitiesForProductsAction:()=>f.Ay,getDimensionValuesFromQuery:()=>se.getDimensionValuesFromQuery,getDimensionsForSelectedVariant:()=>I.default,getFallbackImageUrl:()=>se.getFallbackImageUrl,getFeatureState:()=>C.default,getFullAvailableInventoryNearby:()=>b.default,getFullOrderTemplate:()=>H.Ay,getFullProductList:()=>A.Ay,getFullProducts:()=>P.Ay,getFullProductsAction:()=>P.IB,getGenericAction:()=>u.K,getInventoryLevelCodeFromDimensionValue:()=>se.getInventoryLevelCodeFromDimensionValue,getInventoryLevelCodeFromProductAvailability:()=>se.getInventoryLevelCodeFromProductAvailability,getInvoiceDetailsPageUrlSync:()=>ue.D2,getInvoices:()=>G.default,getList:()=>D.Ay,getLoyalty:()=>S.default,getMediaLocationsForSelectedVariant:()=>T.default,getOrderTemplates:()=>Z.default,getOrgUnitLocationsByArea:()=>M.default,getOrganizationWideOrderHistory:()=>O.Ay,getPaginatedOrderTemplateLinesAction:()=>X.Ay,getPriceForProductSearchResult:()=>L.x0,getPriceForSelectedVariant:()=>U.default,getProductAvailabilitiesForSelectedVariant:()=>F.default,getProductDetailsCriteriaFromActionInput:()=>se.getProductDetailsCriteriaFromActionInput,getProductListLines:()=>q.Ay,getProductPageUrlSync:()=>ue.dY,getProductPriceForSelectedProducts:()=>E.BW,getProductUrlSync:()=>ue.sf,getPromotionOptionsForCartLineItems:()=>V.Ay,getRatingsSummary:()=>k.default,getRnrAuthEndpointId:()=>ie.bF,getRnrEndpointId:()=>ie.hV,getRnrPartnerId:()=>ie.yb,getScanResult:()=>N.Ay,getSelectedProductIdFromActionInput:()=>se.getSelectedProductIdFromActionInput,getSelectedVariant:()=>Q.default,getSimpleProducts:()=>K.Ay,getSimpleProductsAction:()=>K.RB,isAggregatedInventory:()=>oe.Wq,isCartLineItemPickUpType:()=>se.isCartLineItemPickUpType,issueLoyalty:()=>W.Ay,mapAggregatedProductInventoryInformation:()=>oe.Ze,mapProductInventoryInformation:()=>oe.G5,removeDomainQspFromUrl:()=>se.removeDomainQspFromUrl,setDimensionValuesToQuery:()=>se.setDimensionValuesToQuery,updateAddress:()=>ee.Ay,updateCustomerAttributes:()=>te.Ay,updateCustomerAttributesInput:()=>te.dn,updateCustomerPersonalization:()=>re.Ay,updateCustomerPersonalizationInput:()=>re.CE,updateOrderTemplateAction:()=>J.Ay,updateOrderTemplateHeader:()=>Y.Ay,updatePrimaryAddress:()=>ne.Ay,validateCartLinesInventory:()=>ae.W,validateCatalogId:()=>se.validateCatalogId});var n=r(284),i=r(1079),o=r(1080),a=(r(1218),r(1081)),s=(r(1219),r(1082)),c=r(1083),u=r(1084),l=(r(258),r(932),r(1085)),d=r(655),g=r(90),y=(r(76),r(936),r(340),r(937),r(57),r(1243),r(285)),h=(r(592),r(24)),p=(r(113),r(1244),r(286)),m=r(656),v=r(1086),f=r(657),I=r(650),C=r(29),b=r(658),A=r(1087),P=r(208),D=(r(1246),r(1247),r(939),r(1088)),S=r(96),w=r(683),T=(r(940),r(651)),O=(r(941),r(1248),r(1249),r(942),r(943),r(1089)),x=r(684),L=r(1090),U=r(660),F=r(661),E=(r(1245),r(1091)),q=r(659),R=(r(1250),r(662)),V=r(1092),k=r(294),j=r(1251),N=(r(1252),r(1253),r(1254),r(1093)),Q=(r(1255),r(72)),K=r(279),M=r(663),G=(r(131),r(944),r(430)),B=r(1094),W=r(1095),_=r(1096),z=r(1097),$=r(1098),H=r(1099),Z=(r(957),r(287)),X=(r(118),r(431)),Y=r(1100),J=r(1101),ee=(r(1256),r(1257),r(1119)),te=r(1102),re=r(1103),ne=r(1120),ie=r(652),oe=r(122),ae=r(682),se=(r(958),r(959),r(43));r.o(se,"Event")&&r.d(t,{Event:function(){return se.Event}}),r.o(se,"FinitePromiseQueue")&&r.d(t,{FinitePromiseQueue:function(){return se.FinitePromiseQueue}}),r.o(se,"FinitePromiseQueueError")&&r.d(t,{FinitePromiseQueueError:function(){return se.FinitePromiseQueueError}}),r.o(se,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return se.OrderTemplate}}),r.o(se,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return se.getCategoryUrl}}),r.o(se,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return se.getInvoiceDetailsPageUrlSync}}),r.o(se,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return se.getProductPageUrlSync}}),r.o(se,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return se.getProductUrlSync}});var ce=r(423),ue=r(440),le=r(36)},24:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetCustomerInput:()=>a,default:()=>c,getCustomerActionDataAction:()=>s});r(7);var n=r(2),i=r(14),o=r(46);class a{constructor(e,t,r){this.getCacheKey=()=>(0,o.S1)(`Customer-${this.customerAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"Customer",this.dataCacheType=()=>this.cacheType?this.cacheType:"request",this.customerAccountNumber=t,this.apiSettings=e,this.cacheType=r}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-customer",action:async(e,t)=>e&&t.requestContext.user.isAuthenticated?i.CustomersDataActions.readAsync({callerContext:t,bypassCache:"get"},e.customerAccountNumber||"").then((e=>Array.isArray(e)?e[0]:e)):(t.trace("[getCustomer]Invalid input passed to action"),{}),input:e=>{const{user:t,apiSettings:r}=e.requestContext;if(!t.token||!t.isAuthenticated)throw new Error("[getCustomer][createInput]: User is not Authenticated.");return new a(r)}}),c=s},29:(e,t,r)=>{"use strict";r.r(t),r.d(t,{FeatureStateInput:()=>a,createGetFeatureStateInput:()=>s,default:()=>l,getFeatureStateAction:()=>c,getFeatureStateActionDataAction:()=>u});r(7);var n=r(2),i=r(14),o=r(36);class a{constructor(){this.featureNames=["Dynamics.AX.Application.RetailAsyncAddressCreationFeature","Dynamics.AX.Application.RetailEnableAsyncCustomerEditFeature","Dynamics.AX.Application.RetailB2BEcommerceFeature","Dynamics.AX.Application.RetailDefaultOrderQuantityLimitsFeature","Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature","Dynamics.AX.Application.RetailSearchPriceRangeFeature","Dynamics.AX.Application.RetailSalesAgreementPriceSupportFeature","Dynamics.AX.Application.ChannelMultipleCatalogsFeature","Dynamics.AX.Application.EcommerceQuantityLimitConfigurationsFeature","RevertToSiteBuilderOrderQuantityLimitsSettings"],this.getCacheKey=()=>"FeatureState",this.getCacheObjectType=()=>"FeatureState",this.dataCacheType=()=>"application"}}const s=e=>new a;async function c(e,t){const r=await i.StoreOperationsDataActions.getFeatureStatesAsync({callerContext:t,queryResultSettings:o.l.getPagingFromInputDataOrDefaultValue(t)},e.featureNames);return r}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-feature-state",action:c,input:s}),l=u},36:(e,t,r)=>{"use strict";r.d(t,{l:()=>n});r(25);class n{constructor(e){this.queryResultSettings=e}static fromInputData(e){const{requestContext:t,config:r}=e;return n.fromModuleData(t,r)}static fromModuleData(e,t){const r=t&&t.sortingCriteria||void 0,i=e&&e.query,o=i&&i.top||void 0,a=i&&i.skip||void 0,s={Paging:{Skip:a&&Number(a)||0,Top:o&&Number(o)||(null==t?void 0:t.itemsPerPage)||50},Sorting:r||{}};return new n(s)}static getPagingFromInputDataOrDefaultValue(e){var t,r,n;const i=e.config,o={Paging:{Top:null!==(t=null==i?void 0:i.itemsPerPage)&&void 0!==t?t:Number.parseInt(null!==(r=null===(n=e.requestContext)||void 0===n||null===(n=n.app)||void 0===n||null===(n=n.platform)||void 0===n?void 0:n.defaultPageSizeForAPI)&&void 0!==r?r:100,10)}};return o}static getDefault(){return new n({Paging:{},Sorting:{}})}get QueryResultSettings(){return this.queryResultSettings}get cacheKeyHint(){const e=`top-${this.queryResultSettings.Paging.Top}`,t=`skip-${this.queryResultSettings.Paging.Skip}`,r=(this.queryResultSettings.Sorting.Columns||[]).map((e=>`${e.ColumnName}--${e.IsDescending?"desc":"asc"}`)).join(",")||void 0,n=`sortBy-${r}`;return`${e}|${t}|${n}`}}},43:(e,t,r)=>{"use strict";r.d(t,{ArrayExtensions:()=>a.Yh,DeliveryMode:()=>s.oS,Dictionary:()=>n.b,DimensionSwatchDisplayTypes:()=>g.Ks,DimensionTypes:()=>g.EN,EmailRegex:()=>d.eT,EnumExtensions:()=>a.eN,Event:()=>o.Event,FinitePromiseQueue:()=>c.FinitePromiseQueue,FinitePromiseQueueError:()=>c.FinitePromiseQueueError,InventoryLevelValues:()=>s.Lp,InventoryLevels:()=>s.aA,ObjectExtensions:()=>a.__,PasswordRegex:()=>d.Lq,PhoneRegex:()=>d.il,QueryResultSettingsProxy:()=>u.l,Random:()=>l.o,StringExtensions:()=>a.Eu,buildCacheKey:()=>g.S1,buildCacheKeyWithUrlTokens:()=>g.h2,buildWishlistLine:()=>g.OJ,checkIfShouldDisplayAsSwatch:()=>g.Bz,convertDimensionTypeToProductDimensionType:()=>g.gl,convertProductDimensionTypeToDimensionTypes:()=>g.Pv,generateCacheKey:()=>g.hz,generateImageUrl:()=>g.wV,generateProductImageUrl:()=>g.v4,generateSwatchImageUrl:()=>g.kX,getAttributeValuesByConfiguration:()=>g._8,getDimensionValuesFromQuery:()=>g.LH,getFallbackImageUrl:()=>g.lD,getInventoryLevelCodeFromDimensionValue:()=>s.x4,getInventoryLevelCodeFromProductAvailability:()=>s.Y5,getProductDetailsCriteriaFromActionInput:()=>g.nr,getSelectedProductIdFromActionInput:()=>g._T,isCartLineItemPickUpType:()=>g.cY,removeDomainQspFromUrl:()=>g._w,setDimensionValuesToQuery:()=>g.mZ,validateCatalogId:()=>g.Zn});var n=r(1108),i=r(1215);r.o(i,"ArrayExtensions")&&r.d(t,{ArrayExtensions:function(){return i.ArrayExtensions}}),r.o(i,"DeliveryMode")&&r.d(t,{DeliveryMode:function(){return i.DeliveryMode}}),r.o(i,"DimensionSwatchDisplayTypes")&&r.d(t,{DimensionSwatchDisplayTypes:function(){return i.DimensionSwatchDisplayTypes}}),r.o(i,"DimensionTypes")&&r.d(t,{DimensionTypes:function(){return i.DimensionTypes}}),r.o(i,"EmailRegex")&&r.d(t,{EmailRegex:function(){return i.EmailRegex}}),r.o(i,"EnumExtensions")&&r.d(t,{EnumExtensions:function(){return i.EnumExtensions}}),r.o(i,"Event")&&r.d(t,{Event:function(){return i.Event}}),r.o(i,"FinitePromiseQueue")&&r.d(t,{FinitePromiseQueue:function(){return i.FinitePromiseQueue}}),r.o(i,"FinitePromiseQueueError")&&r.d(t,{FinitePromiseQueueError:function(){return i.FinitePromiseQueueError}}),r.o(i,"InventoryLevelValues")&&r.d(t,{InventoryLevelValues:function(){return i.InventoryLevelValues}}),r.o(i,"InventoryLevels")&&r.d(t,{InventoryLevels:function(){return i.InventoryLevels}}),r.o(i,"ObjectExtensions")&&r.d(t,{ObjectExtensions:function(){return i.ObjectExtensions}}),r.o(i,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return i.OrderTemplate}}),r.o(i,"PasswordRegex")&&r.d(t,{PasswordRegex:function(){return i.PasswordRegex}}),r.o(i,"PhoneRegex")&&r.d(t,{PhoneRegex:function(){return i.PhoneRegex}}),r.o(i,"QueryResultSettingsProxy")&&r.d(t,{QueryResultSettingsProxy:function(){return i.QueryResultSettingsProxy}}),r.o(i,"Random")&&r.d(t,{Random:function(){return i.Random}}),r.o(i,"StringExtensions")&&r.d(t,{StringExtensions:function(){return i.StringExtensions}}),r.o(i,"buildCacheKey")&&r.d(t,{buildCacheKey:function(){return i.buildCacheKey}}),r.o(i,"buildCacheKeyWithUrlTokens")&&r.d(t,{buildCacheKeyWithUrlTokens:function(){return i.buildCacheKeyWithUrlTokens}}),r.o(i,"buildWishlistLine")&&r.d(t,{buildWishlistLine:function(){return i.buildWishlistLine}}),r.o(i,"checkIfShouldDisplayAsSwatch")&&r.d(t,{checkIfShouldDisplayAsSwatch:function(){return i.checkIfShouldDisplayAsSwatch}}),r.o(i,"convertDimensionTypeToProductDimensionType")&&r.d(t,{convertDimensionTypeToProductDimensionType:function(){return i.convertDimensionTypeToProductDimensionType}}),r.o(i,"convertProductDimensionTypeToDimensionTypes")&&r.d(t,{convertProductDimensionTypeToDimensionTypes:function(){return i.convertProductDimensionTypeToDimensionTypes}}),r.o(i,"generateCacheKey")&&r.d(t,{generateCacheKey:function(){return i.generateCacheKey}}),r.o(i,"generateImageUrl")&&r.d(t,{generateImageUrl:function(){return i.generateImageUrl}}),r.o(i,"generateProductImageUrl")&&r.d(t,{generateProductImageUrl:function(){return i.generateProductImageUrl}}),r.o(i,"generateSwatchImageUrl")&&r.d(t,{generateSwatchImageUrl:function(){return i.generateSwatchImageUrl}}),r.o(i,"getAttributeValuesByConfiguration")&&r.d(t,{getAttributeValuesByConfiguration:function(){return i.getAttributeValuesByConfiguration}}),r.o(i,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return i.getCategoryUrl}}),r.o(i,"getDimensionValuesFromQuery")&&r.d(t,{getDimensionValuesFromQuery:function(){return i.getDimensionValuesFromQuery}}),r.o(i,"getFallbackImageUrl")&&r.d(t,{getFallbackImageUrl:function(){return i.getFallbackImageUrl}}),r.o(i,"getInventoryLevelCodeFromDimensionValue")&&r.d(t,{getInventoryLevelCodeFromDimensionValue:function(){return i.getInventoryLevelCodeFromDimensionValue}}),r.o(i,"getInventoryLevelCodeFromProductAvailability")&&r.d(t,{getInventoryLevelCodeFromProductAvailability:function(){return i.getInventoryLevelCodeFromProductAvailability}}),r.o(i,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return i.getInvoiceDetailsPageUrlSync}}),r.o(i,"getProductDetailsCriteriaFromActionInput")&&r.d(t,{getProductDetailsCriteriaFromActionInput:function(){return i.getProductDetailsCriteriaFromActionInput}}),r.o(i,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return i.getProductPageUrlSync}}),r.o(i,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return i.getProductUrlSync}}),r.o(i,"getSelectedProductIdFromActionInput")&&r.d(t,{getSelectedProductIdFromActionInput:function(){return i.getSelectedProductIdFromActionInput}}),r.o(i,"isCartLineItemPickUpType")&&r.d(t,{isCartLineItemPickUpType:function(){return i.isCartLineItemPickUpType}}),r.o(i,"removeDomainQspFromUrl")&&r.d(t,{removeDomainQspFromUrl:function(){return i.removeDomainQspFromUrl}}),r.o(i,"setDimensionValuesToQuery")&&r.d(t,{setDimensionValuesToQuery:function(){return i.setDimensionValuesToQuery}}),r.o(i,"validateCatalogId")&&r.d(t,{validateCatalogId:function(){return i.validateCatalogId}});var o=r(1109);r.o(o,"ArrayExtensions")&&r.d(t,{ArrayExtensions:function(){return o.ArrayExtensions}}),r.o(o,"DeliveryMode")&&r.d(t,{DeliveryMode:function(){return o.DeliveryMode}}),r.o(o,"DimensionSwatchDisplayTypes")&&r.d(t,{DimensionSwatchDisplayTypes:function(){return o.DimensionSwatchDisplayTypes}}),r.o(o,"DimensionTypes")&&r.d(t,{DimensionTypes:function(){return o.DimensionTypes}}),r.o(o,"EmailRegex")&&r.d(t,{EmailRegex:function(){return o.EmailRegex}}),r.o(o,"EnumExtensions")&&r.d(t,{EnumExtensions:function(){return o.EnumExtensions}}),r.o(o,"FinitePromiseQueue")&&r.d(t,{FinitePromiseQueue:function(){return o.FinitePromiseQueue}}),r.o(o,"FinitePromiseQueueError")&&r.d(t,{FinitePromiseQueueError:function(){return o.FinitePromiseQueueError}}),r.o(o,"InventoryLevelValues")&&r.d(t,{InventoryLevelValues:function(){return o.InventoryLevelValues}}),r.o(o,"InventoryLevels")&&r.d(t,{InventoryLevels:function(){return o.InventoryLevels}}),r.o(o,"ObjectExtensions")&&r.d(t,{ObjectExtensions:function(){return o.ObjectExtensions}}),r.o(o,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return o.OrderTemplate}}),r.o(o,"PasswordRegex")&&r.d(t,{PasswordRegex:function(){return o.PasswordRegex}}),r.o(o,"PhoneRegex")&&r.d(t,{PhoneRegex:function(){return o.PhoneRegex}}),r.o(o,"QueryResultSettingsProxy")&&r.d(t,{QueryResultSettingsProxy:function(){return o.QueryResultSettingsProxy}}),r.o(o,"Random")&&r.d(t,{Random:function(){return o.Random}}),r.o(o,"StringExtensions")&&r.d(t,{StringExtensions:function(){return o.StringExtensions}}),r.o(o,"buildCacheKey")&&r.d(t,{buildCacheKey:function(){return o.buildCacheKey}}),r.o(o,"buildCacheKeyWithUrlTokens")&&r.d(t,{buildCacheKeyWithUrlTokens:function(){return o.buildCacheKeyWithUrlTokens}}),r.o(o,"buildWishlistLine")&&r.d(t,{buildWishlistLine:function(){return o.buildWishlistLine}}),r.o(o,"checkIfShouldDisplayAsSwatch")&&r.d(t,{checkIfShouldDisplayAsSwatch:function(){return o.checkIfShouldDisplayAsSwatch}}),r.o(o,"convertDimensionTypeToProductDimensionType")&&r.d(t,{convertDimensionTypeToProductDimensionType:function(){return o.convertDimensionTypeToProductDimensionType}}),r.o(o,"convertProductDimensionTypeToDimensionTypes")&&r.d(t,{convertProductDimensionTypeToDimensionTypes:function(){return o.convertProductDimensionTypeToDimensionTypes}}),r.o(o,"generateCacheKey")&&r.d(t,{generateCacheKey:function(){return o.generateCacheKey}}),r.o(o,"generateImageUrl")&&r.d(t,{generateImageUrl:function(){return o.generateImageUrl}}),r.o(o,"generateProductImageUrl")&&r.d(t,{generateProductImageUrl:function(){return o.generateProductImageUrl}}),r.o(o,"generateSwatchImageUrl")&&r.d(t,{generateSwatchImageUrl:function(){return o.generateSwatchImageUrl}}),r.o(o,"getAttributeValuesByConfiguration")&&r.d(t,{getAttributeValuesByConfiguration:function(){return o.getAttributeValuesByConfiguration}}),r.o(o,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return o.getCategoryUrl}}),r.o(o,"getDimensionValuesFromQuery")&&r.d(t,{getDimensionValuesFromQuery:function(){return o.getDimensionValuesFromQuery}}),r.o(o,"getFallbackImageUrl")&&r.d(t,{getFallbackImageUrl:function(){return o.getFallbackImageUrl}}),r.o(o,"getInventoryLevelCodeFromDimensionValue")&&r.d(t,{getInventoryLevelCodeFromDimensionValue:function(){return o.getInventoryLevelCodeFromDimensionValue}}),r.o(o,"getInventoryLevelCodeFromProductAvailability")&&r.d(t,{getInventoryLevelCodeFromProductAvailability:function(){return o.getInventoryLevelCodeFromProductAvailability}}),r.o(o,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return o.getInvoiceDetailsPageUrlSync}}),r.o(o,"getProductDetailsCriteriaFromActionInput")&&r.d(t,{getProductDetailsCriteriaFromActionInput:function(){return o.getProductDetailsCriteriaFromActionInput}}),r.o(o,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return o.getProductPageUrlSync}}),r.o(o,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return o.getProductUrlSync}}),r.o(o,"getSelectedProductIdFromActionInput")&&r.d(t,{getSelectedProductIdFromActionInput:function(){return o.getSelectedProductIdFromActionInput}}),r.o(o,"isCartLineItemPickUpType")&&r.d(t,{isCartLineItemPickUpType:function(){return o.isCartLineItemPickUpType}}),r.o(o,"removeDomainQspFromUrl")&&r.d(t,{removeDomainQspFromUrl:function(){return o.removeDomainQspFromUrl}}),r.o(o,"setDimensionValuesToQuery")&&r.d(t,{setDimensionValuesToQuery:function(){return o.setDimensionValuesToQuery}}),r.o(o,"validateCatalogId")&&r.d(t,{validateCatalogId:function(){return o.validateCatalogId}});var a=r(681),s=r(292),c=r(1111);r.o(c,"DimensionSwatchDisplayTypes")&&r.d(t,{DimensionSwatchDisplayTypes:function(){return c.DimensionSwatchDisplayTypes}}),r.o(c,"DimensionTypes")&&r.d(t,{DimensionTypes:function(){return c.DimensionTypes}}),r.o(c,"EmailRegex")&&r.d(t,{EmailRegex:function(){return c.EmailRegex}}),r.o(c,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return c.OrderTemplate}}),r.o(c,"PasswordRegex")&&r.d(t,{PasswordRegex:function(){return c.PasswordRegex}}),r.o(c,"PhoneRegex")&&r.d(t,{PhoneRegex:function(){return c.PhoneRegex}}),r.o(c,"QueryResultSettingsProxy")&&r.d(t,{QueryResultSettingsProxy:function(){return c.QueryResultSettingsProxy}}),r.o(c,"Random")&&r.d(t,{Random:function(){return c.Random}}),r.o(c,"buildCacheKey")&&r.d(t,{buildCacheKey:function(){return c.buildCacheKey}}),r.o(c,"buildCacheKeyWithUrlTokens")&&r.d(t,{buildCacheKeyWithUrlTokens:function(){return c.buildCacheKeyWithUrlTokens}}),r.o(c,"buildWishlistLine")&&r.d(t,{buildWishlistLine:function(){return c.buildWishlistLine}}),r.o(c,"checkIfShouldDisplayAsSwatch")&&r.d(t,{checkIfShouldDisplayAsSwatch:function(){return c.checkIfShouldDisplayAsSwatch}}),r.o(c,"convertDimensionTypeToProductDimensionType")&&r.d(t,{convertDimensionTypeToProductDimensionType:function(){return c.convertDimensionTypeToProductDimensionType}}),r.o(c,"convertProductDimensionTypeToDimensionTypes")&&r.d(t,{convertProductDimensionTypeToDimensionTypes:function(){return c.convertProductDimensionTypeToDimensionTypes}}),r.o(c,"generateCacheKey")&&r.d(t,{generateCacheKey:function(){return c.generateCacheKey}}),r.o(c,"generateImageUrl")&&r.d(t,{generateImageUrl:function(){return c.generateImageUrl}}),r.o(c,"generateProductImageUrl")&&r.d(t,{generateProductImageUrl:function(){return c.generateProductImageUrl}}),r.o(c,"generateSwatchImageUrl")&&r.d(t,{generateSwatchImageUrl:function(){return c.generateSwatchImageUrl}}),r.o(c,"getAttributeValuesByConfiguration")&&r.d(t,{getAttributeValuesByConfiguration:function(){return c.getAttributeValuesByConfiguration}}),r.o(c,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return c.getCategoryUrl}}),r.o(c,"getDimensionValuesFromQuery")&&r.d(t,{getDimensionValuesFromQuery:function(){return c.getDimensionValuesFromQuery}}),r.o(c,"getFallbackImageUrl")&&r.d(t,{getFallbackImageUrl:function(){return c.getFallbackImageUrl}}),r.o(c,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return c.getInvoiceDetailsPageUrlSync}}),r.o(c,"getProductDetailsCriteriaFromActionInput")&&r.d(t,{getProductDetailsCriteriaFromActionInput:function(){return c.getProductDetailsCriteriaFromActionInput}}),r.o(c,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return c.getProductPageUrlSync}}),r.o(c,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return c.getProductUrlSync}}),r.o(c,"getSelectedProductIdFromActionInput")&&r.d(t,{getSelectedProductIdFromActionInput:function(){return c.getSelectedProductIdFromActionInput}}),r.o(c,"isCartLineItemPickUpType")&&r.d(t,{isCartLineItemPickUpType:function(){return c.isCartLineItemPickUpType}}),r.o(c,"removeDomainQspFromUrl")&&r.d(t,{removeDomainQspFromUrl:function(){return c.removeDomainQspFromUrl}}),r.o(c,"setDimensionValuesToQuery")&&r.d(t,{setDimensionValuesToQuery:function(){return c.setDimensionValuesToQuery}}),r.o(c,"validateCatalogId")&&r.d(t,{validateCatalogId:function(){return c.validateCatalogId}});var u=r(36),l=r(1113),d=r(1114),g=r(46);r(682)},46:(e,t,r)=>{"use strict";r.d(t,{Bz:()=>l,EN:()=>c,Ks:()=>u,LH:()=>D,OJ:()=>y,Pv:()=>C,S1:()=>p,Zn:()=>T,_8:()=>S,_T:()=>a,_w:()=>w,cY:()=>x,gl:()=>b,h2:()=>f,hz:()=>v,kX:()=>d,lD:()=>I,mZ:()=>A,nr:()=>h,v4:()=>g,wV:()=>s});r(66),r(15),r(12),r(195),r(18),r(19),r(51),r(71),r(4),r(9),r(22),r(23),r(21);var n=r(2),i=r(14),o=r(681);r(925);const a=e=>{var t;const r=e.requestContext;return null!==(t=r.query)&&void 0!==t&&t.productId?r.query.productId:r.urlTokens&&e.requestContext.urlTokens.itemId&&"Product"===e.requestContext.urlTokens.pageType?r.urlTokens.itemId:e&&e.config&&e.config.productId?e.config.productId:void 0},s=(e,t)=>(0,n.generateImageUrl)(t,e);var c,u;!function(e){e.none="none",e.color="color",e.configuration="configuration",e.size="size",e.style="style"}(c||(c={})),function(e){e.default="default",e.productCard="productCard"}(u||(u={}));const l=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.default;if(r===u.productCard){const r=t.app.config.dimensionsInProductCard;if(!o.Yh.hasElements(r)||r.includes(c.none)||!r.includes(e))return!1}const n=t.app.config.dimensionsAsSwatchType;return o.Yh.hasElements(n)&&!n.includes(c.none)&&n.includes(e)},d=(e,t)=>e.startsWith("http")?e:t.baseImageUrl+encodeURIComponent(e),g=(e,t)=>s(e.PrimaryImageUrl,t),y=(e,t,r)=>({CommerceListId:r,ProductId:e,CustomerId:t}),h=e=>e&&e.config?{getPrice:!e.config.hidePrice,getRating:!e.config.hideRating}:{getPrice:!0,getRating:!0},p=(e,t,r)=>`${e}-chanId:${t.channelId}-catId:${t.catalogId}${r?`-${r}`:""}`;var m;!function(e){e.channelIdKey="CHANNELID",e.appSettingsCatalogIdKey="APPSETTINGSCATALOGID"}(m||(m={}));const v=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=r.map((e=>({key:e.key.toLocaleUpperCase(),value:e.value}))),o=i.map((e=>e.key));return e&&(o.includes(m.channelIdKey)||i.push({key:m.channelIdKey,value:e.channelId}),!o.includes(m.appSettingsCatalogIdKey)&&e.catalogId&&i.push({key:m.appSettingsCatalogIdKey,value:e.catalogId})),i.sort(((e,t)=>e.key.localeCompare(t.key))).map((e=>`${e.key}:{${e.value}}`)).join("-")},f=(e,t)=>{const r=t.urlTokens,n=p(e,t.apiSettings,t.locale);return r?`${n}-${r.itemId}-${r.recordId}-${r.pageType}`:n},I=(e,t,r)=>{if(!e||r)return"";const n=e.trim().split(" ")[0],i=`Products/${n}_000_001.png`;return s(i,t)},C=e=>{switch(e){case i.ProductDimensionType.Color:return c.color;case i.ProductDimensionType.Configuration:return c.configuration;case i.ProductDimensionType.Size:return c.size;case i.ProductDimensionType.Style:return c.style;default:return c.none}},b=e=>{switch(e){case c.color:return i.ProductDimensionType.Color;case c.configuration:return i.ProductDimensionType.Configuration;case c.size:return i.ProductDimensionType.Size;case c.style:return i.ProductDimensionType.Style;default:return i.ProductDimensionType.None}},A=(e,t)=>{for(const n of t){var r;const t=null===(r=n.DimensionValue)||void 0===r?void 0:r.Value;o.Eu.isNullOrWhitespace(t)||e.searchParams.set(C(n.DimensionTypeValue),t)}n.default.isBrowser&&window.history.replaceState(window.history.state,"",e.toString().replace(e.host,window.location.host))},P=e=>{const t=[i.ProductDimensionType.Color,i.ProductDimensionType.Configuration,i.ProductDimensionType.Size,i.ProductDimensionType.Style],r=t.map((t=>((e,t)=>{const r=C(t),n=e.get(r);if(n)return{DimensionTypeValue:t,DimensionValue:{RecordId:0,Value:n}}})(e,t)));return o.Yh.validValues(r)},D=e=>{const t=new URL(e.toString().toLocaleLowerCase()),r=t.searchParams,n=P(r);return n},S=(e,t)=>e?t?e.filter((e=>e.RecordId!==t.InventoryProductAttributeRecordId&&e.RecordId!==t.ProductAvailabilitySortableAttributeRecordId)):e:[],w=(e,t)=>{if(null!=t&&t.features&&t.features.remove_domain_qsp){const t=new URL(e),r=new URLSearchParams(t.search);return r.has("domain")&&r.delete("domain"),t.search=r.toString(),t.toString()}return e},T=e=>{if(-1===e)throw new Error("Catalog id is -1. It means no valid catalogs were found for the user. Make sure the user has some valid catalogs assigned.")},O=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return r?e.DeliveryMode===(null==n||null===(t=n.PickupDeliveryModeCodes)||void 0===t?void 0:t.find((t=>t===e.DeliveryMode))):e.DeliveryMode===i},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return!(!e.DeliveryMode||""===e.DeliveryMode||!O(e,t,r,n))}},57:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetChannelDeliveryConfigurationInput:()=>a,default:()=>s});r(7);var n=r(2),i=r(30),o=r(46);class a{constructor(e,t){this.getCacheKey=()=>(0,o.S1)("ChannelDeliveryConfiguration",this.apiSettings),this.getCacheObjectType=()=>"ChannelDeliveryConfiguration",this.dataCacheType=()=>"application",this.apiSettings=e}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-channel-delivery-option-configuration",action:async(e,t)=>e?(0,i.getChannelDeliveryOptionConfigurationAsync)({callerContext:t}).then((e=>e)):(t.trace("[get-channel-delivery-option-configuration]Invalid input passed to action"),{}),input:e=>{const{apiSettings:t}=e.requestContext;if(!t)throw new Error("[getChannelDeliveryOptionConfiguration][createInput]: API setting not available.");return new a(t)}})},72:(e,t,r)=>{"use strict";r.r(t),r.d(t,{SelectedVariantInput:()=>g,default:()=>h,getSelectedVariantActionDataAction:()=>y});r(4);var n=r(5),i=(r(7),r(9),r(2)),o=r(14),a=r(43),s=r(122),c=r(36),u=r(46);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class g{constructor(e,t,r,n,o){this.getCacheKey=()=>"SelectedVariant",this.getCacheObjectType=()=>"SimpleProduct",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.matchingDimensionValues=r,this.bypassCache=n,o&&(this.catalogId=(0,i.getCatalogId)(o))}}const y=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-selected-variant",action:async function(e,t){var r,n,i;const l=null!==(r=e.matchingDimensionValues)&&void 0!==r?r:(0,u.LH)(t.requestContext.url.requestUrl),g=await o.ProductsDataActions.getByIdsAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t),bypassCache:e.bypassCache},e.channelId,[e.productId],null,null!==(n=e.catalogId)&&void 0!==n?n:0);let y=g[0];y=d({},y);const h=((e,t)=>{let r=!1;if(e.Dimensions){e.Dimensions=e.Dimensions.map((e=>d({},e)));for(const n of e.Dimensions){const e=t.find((e=>e.DimensionTypeValue===n.DimensionTypeValue));e?n.DimensionValue=e.DimensionValue:r=!0}}return r})(y,l),p=(0,u.v4)(y,t.requestContext.apiSettings);let m;if(p&&(y.PrimaryImageUrl=p),a.ArrayExtensions.hasElements(l)){const r=await(async(e,t,r,n)=>{var i,a;let u=[];const l=[];(null!==(i=e.Dimensions)&&void 0!==i?i:[]).map((e=>{l.push(e.DimensionTypeValue)}));const g=(0,s.L9)(r,[],!0,void 0,void 0),y={RequestedDimensionTypeValues:l,MatchingDimensionValues:t,DefaultWarehouseOnly:g.DefaultWarehouseOnly,FilterByChannelFulfillmentGroup:g.FilterByChannelFulfillmentGroup,DeliveryModeTypeFilterValue:g.DeliveryModeTypeFilterValue,CatalogId:n},h=o.ProductsDataActions.getDimensionValuesWithEstimatedAvailabilitiesAsync({callerContext:r,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(r)},e.MasterProductId?e.MasterProductId:e.RecordId,y),p=(null!==(a=e.Dimensions)&&void 0!==a?a:[]).map((e=>h.then((t=>{const r=t.filter((t=>t.DimensionTypeValue===e.DimensionTypeValue)),n=d(d({},e),{},{dimensionValuesWithInventory:r});return n}))));return u=await Promise.all(p),u})(y,l,t,e.catalogId);m=await(async(e,t,r)=>{let n;if(a.ArrayExtensions.hasElements(r)&&a.ArrayExtensions.hasElements(r[0].dimensionValuesWithInventory)&&a.ArrayExtensions.hasElements(r[0].dimensionValuesWithInventory[0].ProductIds)){var i;const a=r[0].dimensionValuesWithInventory[0].ProductIds[0],s=await o.ProductsDataActions.getByIdsAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t),bypassCache:e.bypassCache},e.channelId,[a],null,null!==(i=e.catalogId)&&void 0!==i?i:0);n=s[0],n=d({},n);const l=(0,u.v4)(n,t.requestContext.apiSettings);l&&(n.PrimaryImageUrl=l)}return n})(e,t,r)}if(null!==(i=m)&&void 0!==i&&i.Dimensions&&y.Dimensions)for(const e of y.Dimensions){const t=m.Dimensions.find((t=>t.DimensionTypeValue===e.DimensionTypeValue)),r=l.find((t=>t.DimensionTypeValue===e.DimensionTypeValue));r&&t&&(e.DimensionValue=t.DimensionValue)}if(!h&&a.ArrayExtensions.hasElements(l)&&m)return m;const v=y;return v.productVariant=m,v},input:e=>{const t=(0,u._T)(e);if(t)return new g(+t,+e.requestContext.apiSettings.channelId,void 0,void 0,e.requestContext);throw new Error("Unable to create SelectedVariantInput, no productId found on module config or query")}}),h=y},76:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CatalogsInput:()=>a,createCatalogsInput:()=>s,default:()=>l,getCatalogAction:()=>c,getCatalogActionDataAction:()=>u});r(7);var n=r(2),i=r(14),o=r(43);class a{constructor(e,t){this.getCacheKey=()=>(0,o.generateCacheKey)(this.apiSettings,{key:"CustomerAccountNumber",value:this.customerAccountNumber},{key:"Locale",value:this.locale}),this.getCacheObjectType=()=>"productCatalogs",this.dataCacheType=()=>"request",this.channelId=e.apiSettings.channelId?Number(e.apiSettings.channelId):0,this.customerAccountNumber=t||(0,n.getCustomerAccountNumberForAllChannelType)(e),this.apiSettings=e.apiSettings,this.locale=e.locale||""}}const s=(e,t)=>{if(!e.requestContext.user.isAuthenticated)throw new Error("Unable to get product catalog. User is not authenticated.");return new a(e.requestContext,t)};async function c(e,t){const r=await i.CatalogsDataActions.getCatalogsAsync({callerContext:t,bypassCache:"getAndPut"},e.channelId,!0);return r}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-catalogs",action:c,input:s}),l=u},90:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CartConfigurationInput:()=>o,createCartConfigurationInputInput:()=>a,default:()=>u,getCartConfigurationAction:()=>s,getCartConfigurationDataAction:()=>c});r(7);var n=r(2),i=r(14);class o{constructor(){this.getCacheKey=()=>"cartConfiguration",this.getCacheObjectType=()=>"cartConfiguration",this.dataCacheType=()=>"application"}}const a=e=>new o;async function s(e,t){const r=await i.CartsDataActions.getConfigurationAsync({callerContext:t});return r}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-cart-configuration",action:s,input:a}),u=c},96:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetLoyaltyCardInput:()=>a,createGetLoyaltyCardInput:()=>s,default:()=>l,getLoyaltyAction:()=>c,getLoyaltyActionDataAction:()=>u});r(7);var n=r(2),i=r(30),o=r(6);class a{constructor(e,t){this.getCacheKey=()=>(0,o.buildCacheKey)(`GetLoyaltyCard-${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"GetLoyaltyCard",this.dataCacheType=()=>"request",this.userAccountNumber=t,this.apiSettings=e}}const s=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("Unable to create get loyalty card input.  User is not authenticated.");return new a(e.requestContext.apiSettings)};async function c(e,t){return(0,i.getCustomerLoyaltyCardsAsync)({callerContext:t,queryResultSettings:o.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(t)},e.userAccountNumber||null).then((e=>{var r;if(e=null===(r=e)||void 0===r?void 0:r.filter((e=>3!==e.CardTenderTypeValue)),!e||0===e.length)return{};const n=e[0];return(0,i.getLoyaltyCardAsync)({callerContext:t,queryResultSettings:o.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(t)},n.CardNumber).then((e=>(e.LoyaltyEnrollmentDate=n.LoyaltyEnrollmentDate,e.LoyaltyEnrollmentDateLocal=n.LoyaltyEnrollmentDateLocal,e))).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("Unable to get loyalty card"),new Error("Unable to get loyalty card")}))})).catch((e=>{throw t.telemetry.exception(e.message),t.telemetry.debug("Unable to get customers loyalty card"),new Error("Unable to get customers loyalty card")}))}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-loyalty-card",action:c,input:s}),l=u},105:(e,t,r)=>{"use strict";var n=r(257),i=r(928),o=r(929),a=r(144),s=r(39),c=r(28),u=r(33),l=n.aTypedArray,d=n.exportTypedArrayMethod,g=c("".slice),y=u((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e}));d("fill",(function(e){var t=arguments.length;l(this);var r="Big"===g(a(this),0,3)?o(e):+e;return s(i,this,r,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),y)},106:(e,t,r)=>{"use strict";var n=r(31),i=r(39),o=r(257),a=r(98),s=r(930),c=r(92),u=r(33),l=n.RangeError,d=n.Int8Array,g=d&&d.prototype,y=g&&g.set,h=o.aTypedArray,p=o.exportTypedArrayMethod,m=!u((function(){var e=new Uint8ClampedArray(2);return i(y,e,{length:1,0:3},1),3!==e[1]})),v=m&&o.NATIVE_ARRAY_BUFFER_VIEWS&&u((function(){var e=new d(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));p("set",(function(e){h(this);var t=s(arguments.length>1?arguments[1]:void 0,1),r=c(e);if(m)return i(y,this,r,t);var n=this.length,o=a(r),u=0;if(o+t>n)throw new l("Wrong length");for(;u<o;)this[t+u]=r[u++]}),!m||v)},107:(e,t,r)=>{"use strict";var n=r(31),i=r(225),o=r(33),a=r(97),s=r(326),c=r(257),u=r(588),l=r(589),d=r(231),g=r(590),y=c.aTypedArray,h=c.exportTypedArrayMethod,p=n.Uint16Array,m=p&&i(p.prototype.sort),v=!(!m||o((function(){m(new p(2),null)}))&&o((function(){m(new p(2),{})}))),f=!!m&&!o((function(){if(d)return d<74;if(u)return u<67;if(l)return!0;if(g)return g<602;var e,t,r=new p(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(m(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));h("sort",(function(e){return void 0!==e&&a(e),f?m(this,e):s(y(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!f||v)},108:(e,t,r)=>{"use strict";var n=r(31),i=r(310),o=r(257),a=r(33),s=r(240),c=n.Int8Array,u=o.aTypedArray,l=o.exportTypedArrayMethod,d=[].toLocaleString,g=!!c&&a((function(){d.call(new c(1))})),y=a((function(){return[1,2].toLocaleString()!==new c([1,2]).toLocaleString()}))||!a((function(){c.prototype.toLocaleString.call([1,2])}));l("toLocaleString",(function(){return i(d,g?s(u(this)):u(this),s(arguments))}),y)},113:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetCustomerBalanceInput:()=>s,createGetCustomerBalanceInput:()=>c,default:()=>d,getCustomerBalanceAction:()=>u,getCustomerBalanceActionDataAction:()=>l});r(7);var n=r(2),i=r(30),o=r(6),a=r(24);class s{constructor(e,t){this.getCacheKey=()=>(0,o.buildCacheKey)(`CustomerBalance-${this.customerAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"GetCustomerBalance",this.dataCacheType=()=>"request",this.customerAccountNumber=t,this.apiSettings=e}}const c=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("Unable to create get customer balance input. User is not authenticated.");return new s(t.apiSettings)};async function u(e,t){const r=new a.GetCustomerInput(e.apiSettings,e.customerAccountNumber),n=await(0,a.default)(r,t);return n||t.telemetry.error("Not able to get customer",new Error("Not able to get customer")),(0,i.getCustomerBalanceAsync)({callerContext:t,queryResultSettings:{}},n.AccountNumber,n.InvoiceAccount)}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-customer-balance",action:u,input:c}),d=l},118:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetOrderTemplatesPreviewInput:()=>a,createGetOrderTemplatesPreviewInput:()=>s,default:()=>l,getOrderTemplatesPreview:()=>c,getOrderTemplatesPreviewDataAction:()=>u});r(7);var n=r(2),i=r(36),o=r(957);class a{constructor(e){this.getCacheKey=()=>"GetOrderTemplatesPreview",this.getCacheObjectType=()=>"GetOrderTemplatesPreview",this.dataCacheType=()=>"none",this.queryResultSettings=e,this.queryResultSettings.count=!0,this.queryResultSettings.Paging.Top=4}}const s=e=>{const t=i.l.fromInputData(e).QueryResultSettings;return new a(t)};async function c(e,t){const r=[];return t.requestContext.user.isAuthenticated?(0,o.Ay)(new o.Py(e.queryResultSettings,!1,!1),t):(t.trace("Unable to get order templates preview. User is not authenticated."),Promise.resolve(r))}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-order-templates-preview",action:c,input:s}),l=u},122:(e,t,r)=>{"use strict";r.d(t,{G5:()=>o,L9:()=>d,Wq:()=>u,Ze:()=>l});r(9);var n=r(292);function i(e,t){if(!t)return!1;switch(e.requestContext.app.config.inventoryRanges){case"lowAndOutofStock":if(t!==n.Lp.available)return!0;break;case"outOfStock":if(t===n.Lp.outOfStock)return!0;break;case"all":return!0}return!1}function o(e,t){const r=[];if(void 0===e.requestContext.app.config.enableStockCheck||!1===e.requestContext.app.config.enableStockCheck)return r;if(t&&t.length>0)for(const i of t)switch(e.requestContext.app.config.inventoryLevel){case n.aA.physicalAvailable:const t=s(e,i);t&&r.push(t);break;case n.aA.totalAvailable:const o=c(e,i);o&&r.push(o);break;default:const u=a(e,i);u&&r.push(u)}return r}function a(e,t){if(t.ProductId&&void 0!==t.TotalAvailable){const r=t.TotalAvailable-e.requestContext.app.config.outOfStockThreshold,n={ProductId:t.ProductId,AvailableQuantity:r>0?r:0};return{ProductAvailableQuantity:n,IsProductAvailable:!!(n.AvailableQuantity&&n.AvailableQuantity>0),InventLocationId:t.InventLocationId}}return null}function s(e,t){const r=i(e,t.PhysicalAvailableInventoryLevelCode);if(t.ProductId&&void 0!==t.TotalAvailable){let e=0;var o;if(t.PhysicalAvailableInventoryLevelCode!==n.Lp.outOfStock)e=null!==(o=t.MaximumPurchasablePhysicalAvailableQuantity)&&void 0!==o?o:t.PhysicalAvailable;const i={ProductId:t.ProductId,AvailableQuantity:e};return{ProductAvailableQuantity:i,StockLevelCode:r?t.PhysicalAvailableInventoryLevelCode:void 0,StockLevelLabel:r?t.PhysicalAvailableInventoryLevelLabel:void 0,IsProductAvailable:void 0!==i.AvailableQuantity&&i.AvailableQuantity>0,InventLocationId:t.InventLocationId}}return null}function c(e,t){const r=i(e,t.TotalAvailableInventoryLevelCode);if(t.ProductId&&void 0!==t.TotalAvailable){let e=0;var o;if(t.TotalAvailableInventoryLevelCode!==n.Lp.outOfStock)e=null!==(o=t.MaximumPurchasableTotalAvailableQuantity)&&void 0!==o?o:t.TotalAvailable;const i={ProductId:t.ProductId,AvailableQuantity:e};return{ProductAvailableQuantity:i,StockLevelCode:r?t.TotalAvailableInventoryLevelCode:void 0,StockLevelLabel:r?t.TotalAvailableInventoryLevelLabel:void 0,IsProductAvailable:null!=i.AvailableQuantity&&i.AvailableQuantity>0,InventLocationId:t.InventLocationId}}return null}function u(e){return(e.requestContext.app.config.inventoryLevel===n.aA.totalAvailable||e.requestContext.app.config.inventoryLevel===n.aA.physicalAvailable)&&"multiple"===e.requestContext.app.config.warehouseAggregation}function l(e,t){if(u(e)){var r;const n=null===(r=t.AggregatedProductInventoryAvailabilities)||void 0===r?void 0:r.map((e=>{var t,r;return{DataAreaId:e.DataAreaId,MaximumPurchasablePhysicalAvailableQuantity:null!==(t=e.MaximumPurchasablePhysicalAvailableQuantity)&&void 0!==t?t:e.PhysicalAvailableQuantity,MaximumPurchasableTotalAvailableQuantity:null!==(r=e.MaximumPurchasableTotalAvailableQuantity)&&void 0!==r?r:e.TotalAvailableQuantity,ProductId:e.ProductId,PhysicalAvailable:e.PhysicalAvailableQuantity,PhysicalAvailableInventoryLevelCode:e.PhysicalAvailableInventoryLevelCode,PhysicalAvailableInventoryLevelLabel:e.PhysicalAvailableInventoryLevelLabel,TotalAvailable:e.TotalAvailableQuantity,TotalAvailableInventoryLevelCode:e.TotalAvailableInventoryLevelCode,TotalAvailableInventoryLevelLabel:e.TotalAvailableInventoryLevelLabel}}));return o(e,n)}return o(e,t.ProductWarehouseInventoryAvailabilities)}function d(e,t,r,i,o,a){const s=a||n.oS.shipping,c={ProductIds:t,QuantityUnitTypeValue:2,SearchArea:o};return u(e)?(c.FilterByChannelFulfillmentGroup=!0,c.DeliveryModeTypeFilterValue=s):(c.DefaultWarehouseOnly=r,c.FilterByChannelFulfillmentGroup=i),c}},131:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,retailActionDataAction:()=>a});var n=r(2),i=r(14),o=r(338);const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-wishlist-by-customer-id",action:i.retailAction,input:e=>{if(e.requestContext&&e.requestContext.user&&e.requestContext.user.isAuthenticated)return(0,o.ww)({},null);throw new Error("[get-wishlist-by-customer-id] Unable to create input for getWishlists")}}),s=a},208:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>p,IB:()=>d,Pe:()=>l,Tj:()=>u});r(25),r(7),r(4),r(9);var n=r(2),i=r(42),o=r(34),a=r(279),s=r(43),c=r(46);class u{constructor(e,t,r,n,o){this.getCacheKey=()=>(0,c.hz)(this.apiSettings,{key:"ProductId",value:this.productId},{key:"CatalogId",value:this.catalogId},{key:"ShouldGetPrice",value:this.ProductDetailsCriteria.getPrice},{key:"ShouldGetRating",value:this.ProductDetailsCriteria.getRating}),this.getCacheObjectType=()=>"FullProduct",this.dataCacheType=()=>"application",this.productId="string"==typeof e?Number.parseInt(e,10):e,this.ProductDetailsCriteria=r,this.apiSettings=t,this.channelId=t.channelId,this.catalogId=o,void 0===this.catalogId&&n&&(this.catalogId=(0,i.dl)(n))}}class l{constructor(e,t){this.getPrice=e||!1,this.getRating=t||!1}}async function d(e,t){if(!Array.isArray(e)||0===e.length)return t.trace("[getFullProductsAction] Invalid or empty inputs passed."),{};const{apiSettings:r}=t.requestContext,n=e.map((e=>new a.M$(e.productId,r,void 0,void 0,t.requestContext,e.catalogId)));return(0,a.Ay)(n,t).then((e=>e.map((e=>({ProductDetails:e}))))).then((r=>{const n=new Set(r.map((e=>e.ProductDetails&&e.ProductDetails.RecordId))),i=[g(e,n,r,t),y(e,n,r,t)];return Promise.all(i).then((()=>r))})).catch((e=>(t.telemetry.exception(e),t.telemetry.debug("Unable to get Simple products"),[])))}async function g(e,t,r,n){let a=0;var c;s.ArrayExtensions.hasElements(e)&&(a=null!==(c=e[0].catalogId)&&void 0!==c?c:0);const u={ChannelId:+n.requestContext.apiSettings.channelId,CatalogId:a},l=e.filter((e=>e.ProductDetailsCriteria.getPrice&&t.has(e.productId))).map((e=>e.productId)).filter(Boolean);return 0===l.length?Promise.resolve():(0,o.getActivePricesAsync)({callerContext:n,queryResultSettings:s.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(n)},u,l,new Date,null,void 0,!0).then((e=>{e.forEach((e=>{const t=r.find((t=>t.ProductDetails&&t.ProductDetails.RecordId===e.ProductId));t&&((0,i.Zx)(n.requestContext.apiSettings.retailServerProxyVersion,"9.16.0")&&(e.CustomerContextualPrice=e.AdjustedPrice),t.ProductPrice=e)}))})).catch((e=>{const t=n.telemetry;t.debug("[getActivePricesAsync] Unable to get active price."),t.exception(e)}))}async function y(e,t,r,n){const i=e.filter((e=>e.ProductDetailsCriteria.getRating&&t.has(e.productId))).map((e=>e.productId)).filter(Boolean);return 0===i.length?Promise.resolve():(0,o.getProductRatingsAsync)({callerContext:n,queryResultSettings:s.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(n)},i).then((e=>{e.forEach((e=>{const t=r.find((t=>t.ProductDetails&&t.ProductDetails.RecordId===e.ProductId));t&&(t.ProductRating=e)}))})).catch((e=>{const t=n.telemetry;t.debug("[getProductRatingsAsync] Unable to get product ratings."),t.exception(e)}))}const h=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-full-products",action:d,input:e=>{let t=e.config&&e.config.productIds;const r=(0,c.nr)(e);return"string"==typeof t&&(t=t.split(",")),Array.isArray(t)&&t.length>0?t.map((t=>new u(+t,e.requestContext.apiSettings,r,e.requestContext))):[]},isBatched:!0}),p=h},257:(e,t,r)=>{"use strict";var n,i,o,a=r(927),s=r(49),c=r(31),u=r(38),l=r(47),d=r(52),g=r(144),y=r(143),h=r(100),p=r(62),m=r(189),v=r(124),f=r(304),I=r(238),C=r(48),b=r(230),A=r(86),P=A.enforce,D=A.get,S=c.Int8Array,w=S&&S.prototype,T=c.Uint8ClampedArray,O=T&&T.prototype,x=S&&f(S),L=w&&f(w),U=Object.prototype,F=c.TypeError,E=C("toStringTag"),q=b("TYPED_ARRAY_TAG"),R="TypedArrayConstructor",V=a&&!!I&&"Opera"!==g(c.opera),k=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},Q=function(e){var t=f(e);if(l(t)){var r=D(t);return r&&d(r,R)?r.TypedArrayConstructor:Q(t)}},K=function(e){if(!l(e))return!1;var t=g(e);return d(j,t)||d(N,t)};for(n in j)i=c[n],o=i&&i.prototype,o?P(o).TypedArrayConstructor=i:V=!1;for(n in N)i=c[n],o=i&&i.prototype,o&&(P(o).TypedArrayConstructor=i);if((!V||!u(x)||x===Function.prototype)&&(x=function(){throw new F("Incorrect invocation")},V))for(n in j)c[n]&&I(c[n],x);if((!V||!L||L===U)&&(L=x.prototype,V))for(n in j)c[n]&&I(c[n].prototype,L);if(V&&f(O)!==L&&I(O,L),s&&!d(L,E))for(n in k=!0,m(L,E,{configurable:!0,get:function(){return l(this)?this[q]:void 0}}),j)c[n]&&h(c[n],q,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:V,TYPED_ARRAY_TAG:k&&q,aTypedArray:function(e){if(K(e))return e;throw new F("Target is not a typed array")},aTypedArrayConstructor:function(e){if(u(e)&&(!I||v(x,e)))return e;throw new F(y(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(s){if(r)for(var i in j){var o=c[i];if(o&&d(o.prototype,e))try{delete o.prototype[e]}catch(r){try{o.prototype[e]=t}catch(e){}}}L[e]&&!r||p(L,e,r?t:V&&w[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(s){if(I){if(r)for(n in j)if(i=c[n],i&&d(i,e))try{delete i[e]}catch(e){}if(x[e]&&!r)return;try{return p(x,e,r?t:V&&x[e]||t)}catch(e){}}for(n in j)i=c[n],!i||i[e]&&!r||p(i,e,t)}},getTypedArrayConstructor:Q,isView:function(e){if(!l(e))return!1;var t=g(e);return"DataView"===t||d(j,t)||d(N,t)},isTypedArray:K,TypedArray:x,TypedArrayPrototype:L}},258:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AddressInput:()=>a,createGetAddressInput:()=>s,default:()=>l,getAddressAction:()=>c,getAddressActionDataAction:()=>u});r(7);var n=r(2),i=r(24),o=r(46);class a{constructor(e,t){this.getCacheKey=()=>(0,o.S1)(`GetAddress-${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"GetAddress",this.dataCacheType=()=>"request",this.userAccountNumber=t,this.apiSettings=e}}const s=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("Unable to create address input.  User is not authenticated.");return new a(e.requestContext.apiSettings)};async function c(e,t){const r=new i.GetCustomerInput(t.requestContext.apiSettings,e.userAccountNumber),n=await(0,i.default)(r,t);if(!n)throw new Error("Not able to get customer");return n.Addresses||[]}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-address",action:c,input:s}),l=u},279:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,M$:()=>c,RB:()=>u});r(7),r(9);var n=r(2),i=r(34),o=r(43),a=r(36),s=r(46);class c{constructor(e,t,r,i,a,s){this.getCacheKey=()=>(0,o.generateCacheKey)(this.apiSettings,{key:"ProductRecordId",value:this.productId},{key:"ChannelId",value:this.channelId},{key:"WarehouseId",value:this.warehouseId},{key:"CatalogId",value:this.catalogId}),this.getCacheObjectType=()=>"SimpleProduct",this.dataCacheType=()=>"application",this.apiSettings=t,this.productId=+e,this.channelId=r||t.channelId,this.warehouseId=i,this.catalogId=s,a&&void 0===s&&(this.catalogId=(0,n.getCatalogId)(a))}}async function u(e,t){if(!o.ArrayExtensions.hasElements(e))return t.trace("[getSimpleProductsAction] Invalid or empty inputs passed."),[];const r={};for(let t=0;t<e.length;++t)r[e[t].productId]=t;const n=[],c=o.ArrayExtensions.unique(e.map((e=>e.catalogId)));for(const r of c){var u,l;const s=e.filter((e=>e.catalogId===r));let c=a.l.getPagingFromInputDataOrDefaultValue(t);o.ArrayExtensions.hasElements(s)&&s.length>(null===(u=t.requestContext)||void 0===u||null===(u=u.app)||void 0===u||null===(u=u.platform)||void 0===u?void 0:u.defaultPageSizeForAPI)&&(c={Paging:{Top:s.length}}),n.push((0,i.getByIdsAsync)({callerContext:t,queryResultSettings:c},e[0].channelId,s.map((e=>e.productId)),null!==(l=e[0].warehouseId)&&void 0!==l?l:null,null!=r?r:0).then((e=>e)).catch((e=>(t.telemetry.debug(`[getSimpleProductsAction] Error in getting response from server. ${e}`),{}))))}const d=o.ArrayExtensions.flatten(await Promise.all(n)),g=d.map((e=>{try{const r=(0,s.v4)(e,t.requestContext.apiSettings);return r&&(e.PrimaryImageUrl=r),e}catch(e){return void t.trace("[getSimpleProductsAction] Unable to update ImageURL for Product")}})).reduce(((e,t)=>{if(!t)return e;const n=r[t.RecordId];return e[n]=t,e}),[]);return e.map((e=>{const t=g.find((t=>t&&t.RecordId===e.productId));return t||{}}))}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-simple-products",action:u,input:e=>{let t=e.config&&e.config.productIds;return t?(t="string"==typeof t?t.split(","):t,Array.isArray(t)?t.map((t=>new c(t,e.requestContext.apiSettings,void 0,void 0,e.requestContext))):[]):[]},isBatched:!0})},284:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>y,_0:()=>u,_O:()=>c,qo:()=>l});r(4);var n=r(5),i=(r(7),r(9),r(2)),o=r(115),a=r(24);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class c{constructor(e,t){this.getCacheKey=()=>"AddAddress",this.getCacheObjectType=()=>"AddAddress",this.dataCacheType=()=>"none",this.userAccountNumber=t,this.address=e}}const u=e=>{if(e.requestContext.user.isAuthenticated)throw new Error("User is not authenticated. Cannot call UpdateAddress API");const{address:t}=e.data||{address:void 0};if(!t)throw new Error("address is not provided. Cannot call UpdateAddress API");return new c(t)};async function l(e,t,r){const{userAccountNumber:i,address:c}=e,u=new a.GetCustomerInput(t.requestContext.apiSettings,i,"none"),l=await(0,a.default)(u,t);if(!l)throw new Error("Not able to create customer");const d=r(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},l),c),g=await(0,o.updateAsync)({callerContext:t},d);if(!g)throw new Error("Not able to update customer");return t.update((0,o.createReadAsync)(g.AccountNumber),g),g.Addresses||[]}function d(e,t){return e.Addresses=[...e.Addresses||[]],e.Addresses.push(t),e}const g=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/add-address",action:async function(e,t){return l(e,t,d)},input:u,isBatched:!1}),y=g},285:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CurrentCategoryInput:()=>s,createGetCurrentCategoryInput:()=>c,default:()=>g,getCurrentCategoryAction:()=>l,getCurrentCategoryActionDataAction:()=>d,searchCategory:()=>u});r(7),r(9);var n=r(2),i=r(43),o=r(340),a=r(440);class s{constructor(e,t){let r,o;if(this.getCacheKey=()=>(0,i.generateCacheKey)(this.apiSettings,{key:"CategoryId",value:this.categoryId},{key:"CategorySlug",value:this.categorySlug},{key:"IncludeRootCategory",value:this.includeRootCategory},{key:"Locale",value:this.locale}),this.getCacheObjectType=()=>"Current-Category",this.dataCacheType=()=>"application",this.includeRootCategory=t,e.query&&e.query.categoryId){if(r=Number(e.query.categoryId),Number.isNaN(r))throw new Error("Failed to cast category id into a number.")}else if(e.urlTokens&&e.urlTokens.recordId){if(r=Number(e.urlTokens.recordId),Number.isNaN(r))throw new Error("Failed to cast category id into a number.")}else if(e.urlTokens&&e.urlTokens.categories&&e.urlTokens.categories.length>0){const t=e.urlTokens.categories;if(0===t.length)throw new Error("Failed to get category name from urlTokens");const r={requestContext:e};o=`/${t.map((e=>{const t=(0,n.getParameterizeFeatureFlags)(r);return(0,a.y9)(e,void 0,t)})).join("/")}`}this.categoryId=r,this.categorySlug=o,this.apiSettings=e.apiSettings,this.locale=e.locale||""}}const c=e=>{if(e&&e.requestContext)return new s(e.requestContext,!0);throw new Error("Please specify categoryId query string in request.")};function u(e,t,r){let n;for(const i of e){if(r&&i.RecordId===r||t&&i.Slug===t){n=i;break}if(i.Children&&i.Children.length>0){const e=u(i.Children,t,r);e&&(n=e)}}return n}async function l(e,t){if(e.categorySlug||e.categoryId){const r=new o.CategoriesInput(t.requestContext,!0,void 0,e.includeRootCategory),n=await(0,o.default)(r,t);if(!n)return void t.trace("[getCurrentCategory] Unable to get categories from server");const i=u(n,e.categorySlug,e.categoryId);return i||void t.trace("[getCurrentCategory] Unable to find category")}}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-current-category",action:l,input:c}),g=d},286:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductDeliveryOptionsForCartLineItems:()=>c,default:()=>d,getDeliveryOptionsForCartLineItems:()=>u,getDeliveryOptionsForCartLineItemsDataAction:()=>l});r(7);var n=r(2),i=r(26),o=r(14),a=r(6),s=r(36);class c{constructor(e){this.getCacheKey=()=>(0,a.buildCacheKey)("ActiveCartLineItemsDeliveryOptions",this.apiSettings),this.getCacheObjectType=()=>"ActiveCartLineItemsDeliveryOptions",this.dataCacheType=()=>"request",this.apiSettings=e}}async function u(e,t){if(!e)throw new Error("[getDeliveryOptionsForCartLineItems]No valid Input was provided, failing");const r=await(0,i.getCartState)(t),n=r.cart,c=await(0,a.getActiveCartProductsAction)(new a.ActiveCartProductsInput,t);return n&&c&&0!==c.length?o.ProductsDataActions.getDeliveryOptionsAsync({callerContext:t,queryResultSettings:s.l.getPagingFromInputDataOrDefaultValue(t)},c.map((e=>e.RecordId)),{},null).then((e=>e)).catch((e=>(t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getDeliveryOptionsForCartLineItems]Error executing action"),{}))):(t.trace("[getDeliveryOptionsForCartLineItems] Not able to get cart OR channelConfiguration or no products in cart"),[])}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-delivery-options-for-cartlines",action:u,input:e=>new c(e.requestContext.apiSettings)}),d=l},287:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetOrderTemplatesInput:()=>s,createGetOrderTemplatesInput:()=>c,default:()=>l,getOrderTemplatesAction:()=>u});r(7);var n=r(2),i=r(83),o=r(35),a=r(36);class s{constructor(e,t){this.getCacheKey=()=>{var e,t;return`${this.productListId}|${null===(e=this.queryResultSettings)||void 0===e||null===(e=e.Paging)||void 0===e?void 0:e.Top}|${null===(t=this.queryResultSettings)||void 0===t||null===(t=t.Paging)||void 0===t?void 0:t.Skip}`},this.getCacheObjectType=()=>"ProductList",this.dataCacheType=()=>"instance",this.shouldCacheOutput=()=>!1,this.productListId=e||"",this.queryResultSettings=t}}const c=(e,t,r)=>{const{requestContext:n}=e;if(!n.user.isAuthenticated)throw new Error("Unable to create get order template. User is not authenticated.");return new s(t||"",r)};async function u(e,t){try{const r={ProductListId:e.productListId,ProductListType:`${o.ProductListType.OrderTemplate}`};return await(0,i.searchAsync)({callerContext:t,queryResultSettings:a.l.getPagingFromInputDataOrDefaultValue(t)},r)}catch(e){throw t.telemetry.error("Not able to get order template(s)",e),e}}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-order-templates",action:u,input:c})},292:(e,t,r)=>{"use strict";var n,i,o;r.d(t,{Lp:()=>o,Y5:()=>s,aA:()=>i,oS:()=>n,x4:()=>a}),function(e){e[e.allWareHouses=0]="allWareHouses",e[e.shipping=1]="shipping",e[e.pickup=2]="pickup"}(n||(n={})),function(e){e.physicalAvailable="physicalAvailable",e.totalAvailable="totalAvailable",e.threshold="inventoryThreshold"}(i||(i={})),function(e){e.outOfStock="OOS",e.available="AVAIL"}(o||(o={}));const a=(e,t)=>t===i.totalAvailable?e.TotalAvailableInventoryLevelCode:t===i.physicalAvailable?e.PhysicalAvailableInventoryLevelCode:void 0,s=(e,t)=>t===i.totalAvailable?e.TotalAvailableInventoryLevelCode:t===i.physicalAvailable?e.PhysicalAvailableInventoryLevelCode:void 0},294:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createInput:()=>a,default:()=>u,getRatingsSummary:()=>s,getRatingsSummaryDataAction:()=>c});r(7);var n=r(2),i=r(6),o=r(652);const a=e=>{const t=(0,i.getSelectedProductIdFromActionInput)(e);if(t)return new i.GetRatingsSummaryInput(t,(0,o.yb)(e),(0,o.hV)(e));throw new Error("[GetRatingsSummary] Not all necessary parameters found while creating Input for getRatingsSummaryApi")};async function s(e,t){if(!function(e){return e&&e.productId.length>0&&e.tenantId.length>0}(e))return t.trace("[GetRatingsSummary] Failed to get ratings summary for product"),{};const r=`${e.serviceEndpoint}/v2.0/ratings/product/${e.productId}/summary?tenantId=${e.tenantId}`;return(0,n.sendRequest)(r,"get").then((e=>e.data)).catch((e=>{throw t.trace("[GetRatingsSummary] Failed to get ratings summary for product"),e}))}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-ratings-summary",action:s,input:a}),u=c},340:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CategoriesInput:()=>l,createCategoriesHierarchyInput:()=>y,default:()=>m,getCategoryHierarchyAction:()=>h,getCategoryHierarchyActionDataAction:()=>p,mapCategoryToHierarchy:()=>g});r(4);var n=r(5),i=(r(25),r(7),r(9),r(2)),o=r(936),a=r(440),s=r(46);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class l{constructor(e,t,r,n){this.getCacheKey=()=>(0,s.hz)(this.apiSettings,{key:"SitePath",value:this.sitePath},{key:"IncludeRootCategory",value:this.includeRootCategory},{key:"Top",value:this.maxItems},{key:"CatalogId",value:this.catalogId},{key:"Locale",value:this.locale}),this.getCacheObjectType=()=>this._mappedToHierarchy?"CategoryHierarchy":"Category",this.dataCacheType=()=>"request",this.getLocale=()=>this.locale||"",this._mappedToHierarchy=t,this.includeRootCategory=n,this.maxItems=r||250,this.channelId=e&&e.apiSettings&&e.apiSettings.channelId?+e.apiSettings.channelId:0,this.sitePath=e&&e.sitePath||"",this.apiSettings=e.apiSettings,this.locale=e.locale||"",this.catalogId=(0,i.getCatalogId)(e)}}const d=(e,t)=>{let r;return e&&t&&t.length>0&&(r=t.find((t=>t.Language.toLowerCase()===e.toLowerCase()))),r&&r.Text},g=(e,t,r,n)=>{var i;if(!e||0===e.length)return[];const o={};for(const t of e){const e=d(r,t.NameTranslations),n=u({},t);n.NeutralizedName=t.Name,n.Name=e||n.NeutralizedName,o[t.RecordId]=n}let s;for(const e of Object.values(o)){const r=e.ParentCategory;if(e.Url=(0,a.K)(e,t,o),0===r){s=e;continue}const n=r&&o[r];n&&(n.Children=n.Children||[],n.Children.push(e))}if(!s)return[];if(n){const e=[];return e.push(s),e}return null!==(i=s.Children)&&void 0!==i?i:[]},y=e=>{const t=e.config&&e.config.topCategories&&Number.parseInt(e.config.topCategories,10);return new l(e.requestContext,!0,t)};async function h(e,t){const r=await(0,o.Ay)(new o.xJ(t.requestContext,!1,e.maxItems),t);return g(r,t,e.getLocale(),e.includeRootCategory)}const p=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-categories-hierarchy",action:h,input:y}),m=p},423:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,L:()=>n});class n{constructor(e,t,r,n){this.productListLine=e,this.fullProduct=t,this.error=r,this.shouldDisable=n}}class i{constructor(e,t,r){this.productList=e,this.orderTemplateLines=t,this.totalLines=r}}},430:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CreateGetInvoicesInput:()=>u,GetInvoicesInput:()=>c,default:()=>g,getInvoices:()=>l,getInvoicesDataAction:()=>d});r(7);var n=r(2),i=r(14),o=r(199),a=r(24),s=r(36);class c{constructor(e,t){this.getCacheKey=()=>"BusinessPartnerInvoices",this.getCacheObjectType=()=>"OrderInvoice",this.dataCacheType=()=>"none",this.searchCriteria=e,this.queryResultSettings=t}}const u=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("User is not logged in.");const r=s.l.fromInputData(e).QueryResultSettings;return new c({InvoicePaidStatusValues:[i.InvoicePaidStatus.None]},r)};async function l(e,t){var r;if(null==t||null===(r=t.requestContext)||void 0===r||null===(r=r.user)||void 0===r||!r.isAuthenticated)throw new Error("Unable to get list of invoices. User is not authenticated.");e.searchCriteria.InvoiceTypeValues=[i.InvoiceType.SalesOrderInvoice];const n=await(0,o.getCurrentAsync)({callerContext:t});e.searchCriteria.BusinessPartnerId=null==n?void 0:n.BusinessPartnerId;const s=await(0,a.default)(new a.GetCustomerInput(t.requestContext.apiSettings),t);return e.searchCriteria.CustomerId=s.AccountNumber,i.SalesOrdersDataActions.getInvoicesAsync({callerContext:t,queryResultSettings:e.queryResultSettings},e.searchCriteria)}const d=(0,n.createObservableDataAction)({id:"get-invoices",action:l,input:u}),g=d},431:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>y,F6:()=>l,vH:()=>d});r(7),r(12),r(4),r(9);var n=r(2),i=r(14),o=r(83),a=r(6),s=r(43),c=r(423),u=r(122);class l{constructor(e,t,r){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.getPrice=!0,this.getRating=!0,this.getCacheKey=()=>`GetPaginatedOrderTemplateLines|${this.orderTemplateId}|${(0,i.convertToString)(this.queryResultSettings)}|${this.searchText}|${(0,i.convertToString)(this.getPrice)}|${(0,i.convertToString)(this.getRating)}`,this.getCacheObjectType=()=>"GetPaginatedOrderTemplateLines",this.dataCacheType=()=>"none",this.orderTemplateId=e,this.queryResultSettings=t,this.searchText=r||"",this.getPrice=n,this.getRating=o}}async function d(e,t){if(!t.requestContext.user.isAuthenticated)throw new Error("Unable to get full order templates. User is not authenticated.");const r={lines:[],totalCount:0},n=(0,o.getProductListLinesAsync)({callerContext:t,queryResultSettings:e.queryResultSettings,bypassCache:"get"},e.orderTemplateId,e.searchText),l=await n,d=[];if(s.ArrayExtensions.hasElements(l)){if(r.totalCount=n.metadata.count||l.length,l.forEach((n=>{var i,o,s;n.ProductId&&(r.lines.push(new c.L(n)),d.push(new a.FullProductInput(n.ProductId,t.requestContext.apiSettings,(i=e,{getPrice:null===(o=i.getPrice)||void 0===o||o,getRating:null===(s=i.getRating)||void 0===s||s}),t.requestContext,n.CatalogId)))})),s.ArrayExtensions.hasElements(d)){const e=await(0,a.getFullProducts)(d,t).then((e=>e||[])).catch((e=>{t.trace(e),t.telemetry.error(e.message),t.telemetry.error("[getPaginatedOrderTemplateLinesAction] Unable to retrieve product info.")}));if(e)for(const n of r.lines){const r=e.find((e=>e.ProductDetails.RecordId===n.productListLine.ProductId));if(r){if(n.fullProduct=r,t.requestContext.app){const e=(0,a.createInventoryAvailabilitySearchCriteria)(t,[n.fullProduct.ProductDetails.RecordId],!0);try{const r=await i.ProductsDataActions.getEstimatedAvailabilityAsync({callerContext:t},e);if(r&&r.ProductWarehouseInventoryAvailabilities&&r.ProductWarehouseInventoryAvailabilities.length>0){const e=(0,u.Ze)(t,r);n.error=!1===t.requestContext.app.config.enableStockCheck||(null==e?void 0:e.length)>0&&e[0].IsProductAvailable?"NONE":"OOS",n.shouldDisable="OOS"===n.error}}catch(e){if(e instanceof Error){const r=e.message;t.trace(r),t.telemetry.error(r)}else t.trace(String(e)),t.telemetry.error("An unknown error occurred.");t.telemetry.error("[getPaginatedOrderTemplateLinesAction] Unable to retrieve product availability.")}}}else{var g,y;t.telemetry.error("[getPaginatedOrderTemplateLinesAction] Unable to find product info for an order template line.");const e={ProductDetails:{RecordId:n.productListLine.ProductId||0,DefaultUnitOfMeasure:null!==(g=null===(y=n.productListLine.UnitOfMeasure)||void 0===y?void 0:y.toString())&&void 0!==g?g:"",ProductTypeValue:0,BasePrice:0,Price:0,AdjustedPrice:0},ProductPrice:{},ProductRating:{}};n.fullProduct=e,n.error="UNASSORTED",n.shouldDisable=!0}}return r}return t.trace(r.lines.length.toString()),r}return r}const g=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-paginated-order-template-lines",action:d,input:(e,t,r)=>{const n=a.QueryResultSettingsProxy.fromInputData(e).QueryResultSettings;return n.count=!0,new l(t,n,r)}}),y=g},440:(e,t,r)=>{"use strict";r.d(t,{K:()=>a,D2:()=>s,dY:()=>g,sf:()=>d,y9:()=>i});var n=r(2);r(15),r(19);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;const o=n.default.platformSettings&&n.default.platformSettings.enableUrlLocalization||r.enableUrlLocalization?e:i||e;return r.enableUrlEncoding||n.default.platformSettings&&n.default.platformSettings.enableUrlEncoding?encodeURIComponent(o.toLowerCase().replace(/[\s!&'()*]+/g,"-").trim().replace(/-+/g,"-").replace(/^-+|-+$/g,"")):e.toLowerCase().replace(/[^\d_a-z\-]+/g," ").trim().replace(/\s+/g,t)}function o(e,t,r){if(!e||!e.Name)return"";const n=i(e.Name,void 0,r,e.NeutralizedName);return e.ParentCategory&&0!==e.ParentCategory?e.ParentCategory&&(e.Slug=e.Slug||`${o(t[e.ParentCategory],t,r)}/${n}`):e.Slug=e.Slug||`/${n}`,e.Slug||""}function a(e,t,r){if(!e.Url&&t&&r){if(!e.Slug){const i=t.requestContext?(0,n.getParameterizeFeatureFlags)(t):{};e.Slug=o(e,r,i)}e.Url=(0,n.getUrlSync)("category",t,{category:e})}return e.Url}r(18);function s(e,t){let r=(0,n.getUrlSync)("invoice-details",t)||"";return r=r.includes("?")?r.substr(0,r.indexOf("?")):r,`${r}?invoiceId=${e}`}r(4);var c=r(5);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,c.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){const n=l(l({},e),{},{RecordId:e.MasterProductId||e.RecordId});return g(n.Name||"",n.RecordId,t,r)}function g(e,t,r,i){return(0,n.getUrlSync)("product",r,{product:{Name:e||"",RecordId:t},category:i})}},592:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CurrentCategoryHierarchyInput:()=>a,createCategoriesHierarchyInput:()=>s,default:()=>d,getCurrentCategoryHierarchyAction:()=>u,getCurrentCategoryHierarchyActionDataAction:()=>l});r(25),r(7),r(9);var n=r(2),i=r(340),o=r(43);class a extends i.CategoriesInput{constructor(e,t,r,n){super(e,t,r),this.getCacheObjectType=()=>"CurrentCategoryHierarchy",this.getCacheKey=()=>`${this.activeCategoryId}-${this.channelId}`;this.activeCategoryId=null!=n?n:0}}const s=e=>{var t,r;const n=(null===(t=e.config)||void 0===t?void 0:t.topCategories)&&Number.parseInt(e.config.topCategories,10);let i="Category"===e.requestContext.urlTokens.pageType?e.requestContext.urlTokens.itemId:void 0;i=null!=i?i:null===(r=e.requestContext.query)||void 0===r?void 0:r.categoryId;const o=i?Number.parseInt(i,10):void 0;return new a(e.requestContext,!0,n,o)},c=(e,t)=>{for(const r of e){if(r.RecordId===t)return[r];if(o.ArrayExtensions.hasElements(r.Children)){const e=c(r.Children,t);if(o.ArrayExtensions.hasElements(e))return e.push(r),e}}return null};async function u(e,t){var r;const n=await(0,i.default)(new i.CategoriesInput(t.requestContext,!0,e.maxItems),t),o=null!==(r=c(n,e.activeCategoryId))&&void 0!==r?r:[],a=o.reverse();return a}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-current-category-hierarchy",action:u,input:s}),d=l},649:(e,t,r)=>{"use strict";var n;r.d(t,{_:()=>n}),function(e){e.isNullOrUndefined=function(e){return null==e},e.isString=function(e){return"string"==typeof e},e.isNumber=function(e){return"number"==typeof e},e.isFunction=function(e){return"function"==typeof e}}(n||(n={}))},650:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetDimensionsForSelectedVariantInput:()=>g,default:()=>p,getDimensionsForSelectedVariantAction:()=>y,getDimensionsForSelectedVariantActionDataAction:()=>h});r(4);var n=r(5),i=(r(7),r(9),r(2)),o=r(14),a=r(43),s=r(122),c=r(36),u=r(46);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class g{constructor(e,t,r,n){this.getCacheKey=()=>{var e;return(0,a.generateCacheKey)(null===(e=this._requestContext)||void 0===e?void 0:e.apiSettings,{key:"Key",value:"DimensionsForSelectedVariantInput"},{key:"ProductId",value:this.productId},{key:"ChannelId",value:this.channelId},{key:"CatalogId",value:this.catalogId})},this.getCacheObjectType=()=>"DimensionsForSelectedVariantInput",this.dataCacheType=()=>"none",this._requestContext=n,this.productId=e,this.channelId=t,this.matchingDimensionValues=r||[],n&&(this.catalogId=(0,i.getCatalogId)(n))}}async function y(e,t){var r;const n=a.ArrayExtensions.validValues(await o.ProductsDataActions.getByIdsAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},e.channelId,[e.productId],null,null!==(r=e.catalogId)&&void 0!==r?r:0));if(!a.ArrayExtensions.hasElements(n))return[];const i=n[0];if(!a.ArrayExtensions.hasElements(i.Dimensions))return[];const u=i.Dimensions.map((r=>{const n=(0,s.L9)(t,[],!0,void 0,void 0),a={RequestedDimensionTypeValue:r.DimensionTypeValue,MatchingDimensionValues:e.matchingDimensionValues.filter((e=>e.DimensionTypeValue!==r.DimensionTypeValue)).map((e=>{var t,r;return{DimensionTypeValue:e.DimensionTypeValue,DimensionValue:{RecordId:null===(t=e.DimensionValue)||void 0===t?void 0:t.RecordId,Value:null===(r=e.DimensionValue)||void 0===r?void 0:r.Value}}})),DefaultWarehouseOnly:n.DefaultWarehouseOnly,FilterByChannelFulfillmentGroup:n.FilterByChannelFulfillmentGroup,DeliveryModeTypeFilterValue:n.DeliveryModeTypeFilterValue,CatalogId:e.catalogId},u=o.ProductsDataActions.getDimensionValuesWithEstimatedAvailabilitiesAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},i.MasterProductId?i.MasterProductId:i.RecordId,a),l=u.then((e=>{const t=d(d({},r),{},{dimensionValuesWithInventory:e});return t}));return l})),l=await Promise.all(u);return g=l,g.map((e=>{var t;const r=d({},e);return r.DimensionValues=a.ArrayExtensions.validValues(null===(t=e.dimensionValuesWithInventory)||void 0===t?void 0:t.map((e=>e.DimensionValue))),r}));var g}const h=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-dimensions/for-selected-variant",action:y,input:e=>{const t=(0,u._T)(e);if(t)return new g(+t,+e.requestContext.apiSettings.channelId,(0,u.LH)(e.requestContext.url.requestUrl),e.requestContext);throw new Error("Unable to create DimensionsForSelectedVariantInput, no productId found on module config or query")}}),p=h},651:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MediaLocationsForSelectedVariantInput:()=>u,createMediaLocationsForSelectedVariantInput:()=>l,default:()=>y,getMediaLocationsForSelectedVariantAction:()=>d,getMediaLocationsForSelectedVariantActionDataAction:()=>g});r(7);var n=r(2),i=r(14),o=r(34),a=r(72),s=r(43),c=r(36);class u{constructor(e,t,r,n){this.getCacheKey=()=>"MediaLocationsForSelectedVariant",this.getCacheObjectType=()=>"MediaLocations",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.catalogId=n||0,this.selectedProduct=r}}const l=e=>{const t=(0,s.getSelectedProductIdFromActionInput)(e),r=(0,n.getCatalogId)(e.requestContext);if(t)return new u(+t,+e.requestContext.apiSettings.channelId,void 0,r);throw new Error("Unable to create MediaLocationsForSelectedVariantInput, no productId found on module config or query")};async function d(e,t){return i.AsyncResult.resolve().then((()=>{const r=e.selectedProduct;if(!r){const r=new a.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);return(0,a.default)(r,t)}return r})).then((r=>{const i=r;if(i){var a;if(null!==(a=t.requestContext.app)&&void 0!==a&&null!==(a=a.config)&&void 0!==a&&a.OmniChannelMedia){const r=new n.MediaLocationsInput(t.requestContext,i.RecordId,e.channelId,e.catalogId);return(0,n.getMediaLocationsForProductAction)(r,t)}return(0,o.getMediaLocationsAsync)({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},i.RecordId,e.channelId,e.catalogId).then((e=>e.map((e=>(e.Uri=(0,s.generateImageUrl)(e.Uri,t.requestContext.apiSettings),e.AltText=e.AltText?e.AltText:i.Name,e)))))}return[]})).catch((e=>{throw t.trace(e),t.telemetry.error(e.message),t.telemetry.debug("[getMediaLocationsForSelectedVariantAction]Error executing action"),new Error("[getMediaLocationsForSelectedVariantAction]Error executing action")}))}const g=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-media-locations-for-selected-variant",action:d,input:l}),y=g},652:(e,t,r)=>{"use strict";r.d(t,{bF:()=>o,hV:()=>i,yb:()=>n});r(195);const n=e=>e.requestContext.apiSettings.rnr.id||"",i=e=>e.requestContext.apiSettings.rnr.url||"",o=e=>{const t=e.requestContext.apiSettings.rnr.proxyUrl?e.requestContext.apiSettings.rnr.proxyUrl:e.requestContext.apiSettings.rnr.url||"";return t.length>0&&t.endsWith("/")?t.substring(0,t.length-1):t}},655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductAvailabilitiesForCartLineItems:()=>l,default:()=>h,getAvailabilitiesForCartLineItems:()=>g,getAvailabilitiesForCartLineItemsDataAction:()=>y});r(7),r(9);var n=r(2),i=r(26),o=r(88),a=r(34),s=r(30),c=r(6),u=r(29);class l{constructor(e){this.getCacheKey=()=>(0,c.buildCacheKey)("ActiveCartLineItemsAvailability",this.apiSettings),this.getCacheObjectType=()=>"ActiveCartLineItemsAvailability",this.dataCacheType=()=>"none",this.apiSettings=e}}const d=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return r?e.DeliveryMode===(null==n||null===(t=n.PickupDeliveryModeCodes)||void 0===t?void 0:t.find((t=>t===e.DeliveryMode))):e.DeliveryMode===i};async function g(e,t){var r;if(!e)throw new Error("[getAvailabilitiesForCartLineItems]No valid Input was provided, failing");const n=[],l=[];let g=[];let y;const h=await(0,i.getCartState)(t),p=h.cart,m=await(0,o.getOrgUnitConfigurationAsync)({callerContext:t}),v=await(0,c.getActiveCartProductsAction)(new c.ActiveCartProductsInput,t);const f=await async function(e){return(0,u.getFeatureStateActionDataAction)(new u.FeatureStateInput,e)}(t),I=null==f||null===(r=f.find((e=>"Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature"===e.Name)))||void 0===r?void 0:r.IsEnabled;I&&(y=await(0,s.getChannelDeliveryOptionConfigurationAsync)({callerContext:t}));const C=m.PickupDeliveryModeCode,b=m.EmailDeliveryModeCode;if(!p||!m||!v||0===v.length)return t.trace("[getAvailabilitiesForCartLineItems] Not able to get cart OR channelConfiguration or no products in cart"),[];if(p&&p.Id&&p.CartLines&&p.CartLines.length>0&&m)for(const e of p.CartLines)e.DeliveryMode&&""!==e.DeliveryMode&&d(e,I,y,C)?l.push(e):""!==b&&e.DeliveryMode===b||n.push(e);if(n&&n.length>0){let e=n.map((e=>e.ProductId));e=c.ArrayExtensions.unique(e);const r=(0,c.createInventoryAvailabilitySearchCriteria)(t,e,!0),i=await(0,a.getEstimatedAvailabilityAsync)({callerContext:t,bypassCache:"get"},r);i&&i.ProductWarehouseInventoryAvailabilities&&i.ProductWarehouseInventoryAvailabilities.length>0&&(g=(0,c.mapAggregatedProductInventoryInformation)(t,i))}if(l&&l.length>0){const e=[];for(const r of l){const n={ProductId:r.ProductId,InventLocationId:r.WarehouseId};t.requestContext.channel&&t.requestContext.channel.InventLocationDataAreaId&&(n.DataAreaId=t.requestContext.channel.InventLocationDataAreaId),e.push(n)}const r=2,n=await(0,a.getEstimatedProductWarehouseAvailabilityAsync)({callerContext:t,bypassCache:"get",queryResultSettings:{}},e,r);if(n&&n.ProductWarehouseInventoryAvailabilities&&n.ProductWarehouseInventoryAvailabilities.length>0){const e=(0,c.mapProductInventoryInformation)(t,null==n?void 0:n.ProductWarehouseInventoryAvailabilities);if(e&&e.length>0)for(const t of e)g.push(t)}}return g&&g.length>0?g:(t.trace("[getAvailabilitiesForCartLineItems] unable to get availabilities for product"),[])}const y=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-availabilities-cartlines",action:g,input:e=>new l(e.requestContext.apiSettings)}),h=y},656:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetDeliveryOptionsForSelectedVariantInput:()=>u,createDeliveryOptionsForSelectedVariantInput:()=>d,default:()=>h,getDeliveryOptionsForSelectedVariantAction:()=>g,getDeliveryOptionsForSelectedVariantActionDataAction:()=>y,getFeatureState:()=>l});r(7);var n=r(2),i=r(34),o=r(35),a=r(6),s=r(29),c=r(36);class u{constructor(e,t,r,n,i){this.getCacheKey=()=>"DeliveryOptionsForSelectedVariant",this.getCacheObjectType=()=>"DeliveryOptions",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.selectedProduct=r,this.customerId=n||"",this.featureState=i}}async function l(e){return(0,s.getFeatureStateActionDataAction)(new s.FeatureStateInput,e)}const d=e=>{const t=(0,a.getSelectedProductIdFromActionInput)(e);if(t)return new u(+t,+e.requestContext.apiSettings.channelId,void 0,void 0);throw new Error("Unable to create PriceForSelectedVariantInput, no productId found on module config or query")};async function g(e,t){if(void 0===e.featureState){var r;const n=await l(t);e.featureState=null==n||null===(r=n.find((e=>"Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature"===e.Name)))||void 0===r?void 0:r.IsEnabled}return Promise.resolve().then((()=>{const r=e.selectedProduct;if(!r){const r=new a.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);return(0,a.getSelectedVariant)(r,t)}return r})).then((r=>{const n=r;if(n)return(0,i.getDeliveryOptionsAsync)({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},[n.RecordId],{},e.featureState&&(null==r?void 0:r.ItemTypeValue)!==o.ReleasedProductType.Service?o.FilterDeliveryModeOption.FilterOutNonPickupDeliveryMode:null).then((e=>{if(e&&e.length>0)return e[0]}))})).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getDeliveryOptionsForSelectedVariantAction]Error executing action"),new Error("[getDeliveryOptionsForSelectedVariantAction]Error executing action")}))}const y=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-delivery-options-for-selected-variant",action:g,input:d}),h=y},657:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,ML:()=>c,pl:()=>u});r(7),r(9);var n=r(2),i=r(14),o=r(43),a=r(122),s=r(36);class c{constructor(e,t,r,i){this.getCacheKey=()=>{var e;const t=[{key:"MasterProductId",value:this.masterProductId},{key:"CatalogId",value:this.catalogId}];return this.requestDimensionTypes?t.push({key:"DimensionTypes",value:this.requestDimensionTypes}):t.push({key:"DimensionType",value:this.requestDimensionType}),(0,o.generateCacheKey)(null===(e=this._requestContext)||void 0===e?void 0:e.apiSettings,...t)},this.getCacheObjectType=()=>"MasterProductDimensionAvailabilities",this.dataCacheType=()=>"application",this._requestContext=r,this.masterProductId=e,this.requestDimensionType=t,this.requestDimensionTypes=i,r&&(this.catalogId=(0,n.getCatalogId)(r))}}async function u(e,t){if(!Array.isArray(e)||!o.ArrayExtensions.hasElements(e))return t.trace("[getDimensionAvailabilitiesForProductsAction] Invalid or empty inputs passed."),[];const r=e.map((e=>{const r=(0,a.L9)(t,[e.masterProductId],!0,void 0,void 0),n={MatchingDimensionValues:void 0,DefaultWarehouseOnly:r.DefaultWarehouseOnly,FilterByChannelFulfillmentGroup:r.FilterByChannelFulfillmentGroup,DeliveryModeTypeFilterValue:r.DeliveryModeTypeFilterValue,CatalogId:e.catalogId};e.requestDimensionTypes?(n.RequestedDimensionTypeValues=e.requestDimensionTypes,n.InventoryAccuracyValue=i.InventoryAccuracy.Low):n.RequestedDimensionTypeValue=e.requestDimensionType;const o=i.ProductsDataActions.getDimensionValuesWithEstimatedAvailabilitiesAsync({callerContext:t,queryResultSettings:s.l.getPagingFromInputDataOrDefaultValue(t)},e.masterProductId,n);return o}));return await Promise.all(r)}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-dimension-availabilities-for-products",action:u,input:e=>{var t;const r=null===(t=e.config)||void 0===t?void 0:t.productsDimensions;return r.map((t=>new c(t.masterProductId,t.requestDimensionType,e.requestContext,t.requestDimensionTypes)))},isBatched:!0})},658:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetFullAvailableInventoryNearbyInput:()=>d,createGetFullAvailableInventoryNearbyInput:()=>g,default:()=>m,getFeatureState:()=>y,getFullAvailableInventoryNearbyAction:()=>h,getFullAvailableInventoryNearbyActionDataAction:()=>p});r(7),r(4),r(9);var n=r(2),i=r(14),o=r(88),a=r(34),s=r(29),c=r(292),u=r(122),l=r(36);class d{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"GetFullAvailableInventoryNearbyInputCache",this.getCacheObjectType=()=>"GetFullAvailableInventoryNearbyInput",this.dataCacheType=()=>"none",this.productId=e,this.latitude=t,this.longitude=r,this.radius=n,this.DistanceUnitValue=i,this.IgnoreLocation=o}}const g=e=>new d;async function y(e){return(0,s.getFeatureStateActionDataAction)(new s.FeatureStateInput,e)}async function h(e,t){var r;if(!e.productId)return;if(!((e.radius||0===e.radius)&&e.latitude&&e.longitude||e.IgnoreLocation))return[];const n={Latitude:e.latitude,Longitude:e.longitude,Radius:e.radius,DistanceUnitValue:e.DistanceUnitValue||0},s=await y(t),d=null==s||null===(r=s.find((e=>"Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature"===e.Name)))||void 0===r?void 0:r.IsEnabled,g=(0,u.L9)(t,[e.productId],!1,!0,n,c.oS.pickup);return(0,a.getEstimatedAvailabilityAsync)({callerContext:t},g).then((async e=>{const r=(0,u.G5)(t,e.ProductWarehouseInventoryAvailabilities);return(0,o.getOrgUnitLocationsByAreaAsync)({callerContext:t,queryResultSettings:l.l.getPagingFromInputDataOrDefaultValue(t)},n,i.DeliveryModeTypeFilter.Pickup).then((async e=>{const n=new Map;e.forEach((e=>{e.InventoryLocationId&&n.set(e.InventoryLocationId,e)}));let i=[];if(d){const r=e.map((e=>e.ChannelId));i=await async function(e,t){if(0===(null==e?void 0:e.length)||void 0===e)return;const r=[];return null==e||e.forEach((e=>{void 0!==e&&r.push(e)})),(0,o.getChannelDeliveryOptionsAsync)({callerContext:t,queryResultSettings:l.l.getPagingFromInputDataOrDefaultValue(t)},r,4).then((e=>{if(e&&!(e instanceof Error))return e})).catch((e=>(t.trace("[GetFullAvailableInventoryNearby][getChannelDeliveryOptionsAsync] error getting availability with channel delivery options"),t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[GetFullAvailableInventoryNearby] [getChannelDeliveryOptionsAsync] error getting availability with channel delivery options"),[])))}(r,t)}const a=e.map((e=>{var a;const s=null===(a=i)||void 0===a?void 0:a.find((t=>t.ChannelId===e.ChannelId));return async function(e,t,r,n,i){if(!e||!e.OrgUnitNumber)return{OrgUnitAvailability:void 0};return(0,o.getStoreHoursAsync)({callerContext:n},e.OrgUnitNumber).then((n=>{const o=[];t&&r&&t.forEach((t=>{var n;t.InventLocationId&&r.has(t.InventLocationId)&&t.InventLocationId===e.InventoryLocationId&&o.push({AvailableQuantity:null===(n=t.ProductAvailableQuantity)||void 0===n?void 0:n.AvailableQuantity})}));const a={OrgUnitLocation:e,ItemAvailabilities:o};return!n||n instanceof Error?{OrgUnitAvailability:a,ProductInventoryInformation:t,OrgUnitPickUpDeliveryModes:i}:{OrgUnitAvailability:a,StoreHours:n,ProductInventoryInformation:t,OrgUnitPickUpDeliveryModes:i}})).catch((e=>(n.trace("[GetFullAvailableInventoryNearby] error getting availability with hours"),n.trace(e.message),n.telemetry.exception(e),n.telemetry.debug("[GetFullAvailableInventoryNearby] error getting availability with hours"),{OrgUnitAvailability:{}})))}(e,r,n,t,s)}));return Promise.all(a)})).catch((e=>(t.trace("[GetFullAvailableInventoryNearby] error getting Available Inventory Nearby"),t.trace(e.message),t.telemetry.error(e.message),t.telemetry.debug("[GetFullAvailableInventoryNearby] error getting Available Inventory Nearby"),[])))})).catch((e=>(t.trace("[GetFullAvailableInventoryNearby][getEstimatedAvailabilityAsync] error getting availability product warehouse information."),t.trace(e.message),t.telemetry.error(e.message),t.telemetry.debug("[GetFullAvailableInventoryNearby][getEstimatedAvailabilityAsync] error getting availability product warehouse information."),[])))}const p=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-full-available-inventory-nearby",action:h,input:g}),m=p},659:(e,t,r)=>{"use strict";r.d(t,{ZN:()=>u,Ay:()=>d});r(7),r(12);var n=r(2),i=r(14),o=r(208),a=r(43);class s{constructor(e,t){this.productListLine=e,this.fullProduct=t}}var c=r(46);class u{constructor(e,t){this.getCacheKey=()=>`GetProductListLines|${this.productListId}|${this.searchText}`,this.getCacheObjectType=()=>"GetProductListLines",this.dataCacheType=()=>"none",this.productListId=e,this.searchText=null!=t?t:""}}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-list-lines",action:async function(e,t){if(!t.requestContext.user.isAuthenticated)throw new Error("Unable to get full product list lines. User is not authenticated.");const r={lines:[],totalCount:0},n=i.ProductListsDataActions.getProductListLinesAsync({callerContext:t},e.productListId,e.searchText),u=await n,l=[];if(a.ArrayExtensions.hasElements(u)){var d;if(r.totalCount=null!==(d=n.metadata.count)&&void 0!==d?d:r.lines.length,u.map((e=>(e.ProductId&&(r.lines.push(new s(e)),l.push(new o.Tj(e.ProductId,t.requestContext.apiSettings,(0,c.nr)(t),t.requestContext))),l))),a.ArrayExtensions.hasElements(l)){const e=await(0,o.Ay)(l,t).then((e=>e)).catch((e=>{t.trace(e.message),t.telemetry.error("[getProductListLinesAction] Unable to retrieve product info.")}));return e&&r.lines.map((r=>{const n=e.find((e=>e.ProductDetails.RecordId===r.productListLine.ProductId));return n?(r.fullProduct=n,null):(t.telemetry.error("[getProductListLinesAction] Unable to find product info for an product list line."),null)})),r}return t.trace(r.lines.length.toString()),r}return r},input:(e,t)=>new u(e,t)}),d=l},660:(e,t,r)=>{"use strict";r.r(t),r.d(t,{PriceForSelectedVariantInput:()=>l,createActivePriceForSelectedVariantInput:()=>d,default:()=>h,getPriceForSelectedVariantAction:()=>g,getPriceForSelectedVariantActionDataAction:()=>y});r(7);var n=r(2),i=r(34),o=r(35),a=r(6),s=r(29),c=r(43),u=r(36);class l{constructor(e,t,r,n){this.getCacheKey=()=>"PriceForSelectedVariant",this.getCacheObjectType=()=>"Price",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.selectedProduct=r,this.customerId=null!=n?n:""}}const d=e=>{const t=(0,a.getSelectedProductIdFromActionInput)(e);if(t)return new l(+t,+e.requestContext.apiSettings.channelId,void 0);throw new Error("Unable to create PriceForSelectedVariantInput, no productId found on module config or query")};async function g(e,t){return Promise.resolve().then((()=>{const r=e.selectedProduct;if(!r){const r=new a.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);return(0,a.getSelectedVariant)(r,t)}return r})).then((async r=>{const a=(0,n.getCatalogId)(t.requestContext),l={ChannelId:+t.requestContext.apiSettings.channelId,CatalogId:a},d=r;if(d){var g,y;const r=await(0,s.getFeatureStateActionDataAction)(new s.FeatureStateInput,t);return(0,i.getActivePricesAsync)({callerContext:t,queryResultSettings:u.l.getPagingFromInputDataOrDefaultValue(t)},l,[d.RecordId],new Date,e.customerId,void 0,!0,(null===(g=r.find((e=>"Dynamics.AX.Application.RetailSearchPriceRangeFeature"===e.Name)))||void 0===g?void 0:g.IsEnabled)&&(d.ProductTypeValue===o.ProductType.Master||d.ProductTypeValue===o.ProductType.KitMaster),null===(y=r.find((e=>"Dynamics.AX.Application.RetailSalesAgreementPriceSupportFeature"===e.Name)))||void 0===y?void 0:y.IsEnabled).then((e=>{if(!c.ArrayExtensions.hasElements(e))throw new Error("[getPriceForSelectedVariantAction]Invalid response recieved from getActivePricesAsync");return e[0]}))}return null})).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getPriceForSelectedVariantAction]Error executing action"),new Error("[getPriceForSelectedVariantAction]Error executing action")}))}const y=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-price-for-selected-variant",action:g,input:d}),h=y},661:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductAvailabilitiesForSelectedVariantInput:()=>u,createProductAvailabilitiesForSelectedVariantInput:()=>l,default:()=>h,getProductAvailabilitiesForSelectedVariantAction:()=>d,getProductAvailabilitiesForSelectedVariantActionDataAction:()=>y,mergeProductWarehouseToProductAvailabities:()=>g});r(7),r(9);var n=r(2),i=r(14),o=r(72),a=r(43),s=r(292),c=r(122);class u{constructor(e,t,r){this.getCacheKey=()=>"ProductAvailabilitiesForSelectedVariant",this.getCacheObjectType=()=>"ProductAvailabilities",this.dataCacheType=()=>"none",this.productId="string"==typeof e?+e:e,this.channelId=t,this.selectedProduct=r}}const l=e=>{const t=(0,a.getSelectedProductIdFromActionInput)(e);if(t)return new u(+t,+e.requestContext.apiSettings.channelId);throw new Error("Unable to create ProductAvailabilitiesForSelectedVariantInput, no productId found on module config or query")};async function d(e,t){const r=[];try{var n;let u=null!==(n=e.selectedProduct)&&void 0!==n?n:null;if(!u){const r=new o.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);u=await(0,o.default)(r,t)}if(t.requestContext.app.config.enableStockCheck&&u&&u.ItemTypeValue!==i.ReleasedProductType.Service&&u.ProductTypeValue!==i.ProductType.Master){const n=(0,c.L9)(t,[u.RecordId],!0,void 0,void 0,s.oS.shipping),o=(0,c.L9)(t,[e.productId],!1,!0,void 0,s.oS.pickup),l=await i.ProductsDataActions.getEstimatedAvailabilityAsync({callerContext:t},n);if(l.ProductWarehouseInventoryAvailabilities){const e=(0,c.Ze)(t,l);a.ArrayExtensions.hasElements(e)&&(e[0].deliveryType=s.oS.shipping,r.push(e[0]))}const d=await i.ProductsDataActions.getEstimatedAvailabilityAsync({callerContext:t},o);if(d.ProductWarehouseInventoryAvailabilities){const e=(0,c.Ze)(t,d);a.ArrayExtensions.hasElements(e)&&(e[0].deliveryType=s.oS.pickup,r.push(e[0]))}return r}return}catch(e){return t.telemetry.exception(e),void t.telemetry.debug("[getPriceForSelectedVariantAction]Error executing action")}}function g(e){const t=[];if(a.ArrayExtensions.hasElements(e))for(const r of e)void 0!==r.TotalAvailable&&void 0!==r.ProductId&&t.push({ProductId:r.ProductId,AvailableQuantity:r.TotalAvailable});return t}const y=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-availabilities-for-selected-variant",action:d,input:l}),h=y},662:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActiveCartProductsInput:()=>s,default:()=>l,getActiveCartProductsAction:()=>c,getActiveCartProductsActionDataAction:()=>u});r(7),r(12),r(4),r(9);var n=r(2),i=r(26),o=r(6),a=r(43);class s{constructor(){this.getCacheKey=()=>"ActiveCartProducts",this.getCacheObjectType=()=>"ActiveCartProducts",this.dataCacheType=()=>"none"}}async function c(e,t){if(!e)throw new Error("[getActiveCartWithProducts]No valid Input was provided, failing");const r=await(0,i.getCartState)(t),n=r.cart,s=await async function(e){var t;const r=await(0,o.getFeatureState)((0,o.createGetFeatureStateInput)(e),e);let n=!1;var i,s;a.ArrayExtensions.hasElements(r)&&(n=(null===(i=r.find((e=>"Dynamics.AX.Application.EcommerceQuantityLimitConfigurationsFeature"===e.Name)))||void 0===i?void 0:i.IsEnabled)||!1);if(n)return!0;a.ArrayExtensions.hasElements(r)&&(n=(null===(s=r.find((e=>"Dynamics.AX.Application.RetailDefaultOrderQuantityLimitsFeature"===e.Name)))||void 0===s?void 0:s.IsEnabled)||!1);if(!n)return!1;const c=null==r||null===(t=r.find((e=>"RevertToSiteBuilderOrderQuantityLimitsSettings"===e.Name)))||void 0===t?void 0:t.IsEnabled;if(c){var u;const t=null===(u=e.requestContext.app)||void 0===u||null===(u=u.platform)||void 0===u?void 0:u.enableDefaultOrderQuantityLimits;return"none"===t?Promise.resolve(!1):"all"===t?Promise.resolve(!0):(0,o.getCustomer)(new o.GetCustomerInput(e.requestContext.apiSettings),e).then((e=>!!e&&("b2b"===t&&e.IsB2b||"b2c"===t&&!e.IsB2b))).catch((t=>(e.telemetry.warning(t.message),e.telemetry.debug("Unable to get customer info"),!1)))}return(0,o.getCartConfiguration)(new o.CartConfigurationInput,e).then((e=>{var t;return!(null!==(t=null==e?void 0:e.IgnoreOrderSettings)&&void 0!==t&&t)})).catch((t=>(e.telemetry.warning(t.message),e.telemetry.debug("Unable to get cart configuration"),!1)))}(t);return s?async function(e,t){var r;const n=new Map;let i=[];return null===(r=e.CartLines)||void 0===r||r.forEach((e=>{var t;return n.has(e.WarehouseId)?null===(t=n.get(e.WarehouseId))||void 0===t?void 0:t.push(e):n.set(e.WarehouseId,[e])})),Promise.all([...n].map((e=>{let[r,n]=e;return(0,o.getSimpleProducts)(n.map((e=>{if(e.ProductId)return new o.ProductInput(e.ProductId,t.requestContext.apiSettings,void 0,r,t.requestContext,e.CatalogId)})).filter(Boolean),t).then((e=>{e&&(i=e.reduce(((e,t)=>(t&&e.push(t),e)),i))}))}))).then((()=>i))}(n,t):!r.hasInvoiceLine&&n&&n.CartLines&&n.CartLines.length>0?(t.trace("Getting cart product information..."),(0,o.getSimpleProducts)(n.CartLines.map((e=>{if(e.ProductId)return new o.ProductInput(e.ProductId,t.requestContext.apiSettings,void 0,void 0,t.requestContext,e.CatalogId)})).filter(Boolean),t).then((e=>e||[])).catch((e=>{throw t.trace(e.toString()),t.telemetry.error(e.message),t.telemetry.debug("[getActiveCartWithProducts]Unable to hydrate cart with product information"),new Error("[getActiveCartWithProducts]Unable to hydrate cart with product information")}))):(t.trace("[getActiveCartWithProducts]No Products Found in cart"),[])}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-products-in-active-cart",action:c,input:e=>new s}),l=u},663:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetOrgUnitLocationsByAreaInput:()=>s,createGetOrgUnitLocationsByAreaInput:()=>c,default:()=>g,getFeatureState:()=>u,getOrgUnitLocationsByArea:()=>l,getOrgUnitLocationsByAreaDataAction:()=>d});r(7),r(4),r(9);var n=r(2),i=r(88),o=r(29),a=r(36);class s{constructor(e,t,r,n,i){this.getCacheKey=()=>"GetOrgUnitLocationsByAreaInput",this.getCacheObjectType=()=>"GetOrgUnitLocationsByAreaInput",this.dataCacheType=()=>"none",this.Latitude=e,this.Longitude=t,this.Radius=r,this.DistanceUnitValue=n,this.IgnoreLocation=i}}const c=e=>new s;async function u(e){return(0,o.getFeatureStateActionDataAction)(new o.FeatureStateInput,e)}async function l(e,t){var r;if(!(void 0!==e.Radius&&e.Latitude&&e.Longitude||e.IgnoreLocation))return[];const n={Latitude:e.Latitude,Longitude:e.Longitude,Radius:e.Radius,DistanceUnitValue:e.DistanceUnitValue||0},o=await u(t),s=null==o||null===(r=o.find((e=>"Dynamics.AX.Application.RetailMultiplePickupDeliveryModeFeature"===e.Name)))||void 0===r?void 0:r.IsEnabled;return(0,i.getOrgUnitLocationsByAreaAsync)({callerContext:t,queryResultSettings:a.l.getPagingFromInputDataOrDefaultValue(t)},n).then((async e=>{let r=[];if(s){const n=e.map((e=>e.ChannelId));r=await async function(e,t){if(0===(null==e?void 0:e.length)||void 0===e)return;const r=[];return null==e||e.forEach((e=>{void 0!==e&&r.push(e)})),(0,i.getChannelDeliveryOptionsAsync)({callerContext:t,queryResultSettings:a.l.getPagingFromInputDataOrDefaultValue(t)},r,4).then((e=>{if(e&&!(e instanceof Error))return e})).catch((e=>(t.trace("[GetFullAvailableInventoryNearby][getChannelDeliveryOptionsAsync] error getting availability with channel delivery options"),t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[GetFullAvailableInventoryNearby] [getChannelDeliveryOptionsAsync] error getting availability with channel delivery options"),[])))}(n,t)}const n=e.map((e=>{var n;const o=null===(n=r)||void 0===n?void 0:n.find((t=>t.ChannelId===e.ChannelId));return async function(e,t,r){if(!e||!e.OrgUnitNumber)return{OrgUnitAvailability:void 0};return(0,i.getStoreHoursAsync)({callerContext:r},e.OrgUnitNumber).then((r=>{const n={OrgUnitLocation:e};return!r||r instanceof Error?{OrgUnitAvailability:n,OrgUnitPickUpDeliveryModes:t}:{OrgUnitAvailability:n,StoreHours:r,OrgUnitPickUpDeliveryModes:t}})).catch((e=>(r.trace("[GetFullAvailableInventoryNearby] error getting availability with hours"),r.trace(e.message),r.telemetry.exception(e),r.telemetry.debug("[GetFullAvailableInventoryNearby] error getting availability with hours"),{OrgUnitAvailability:{}})))}(e,o,t)}));return Promise.all(n)})).catch((e=>(t.trace("[GetOrgUnitLocationsByArea] error getting Locations"),t.trace(e.message),t.telemetry.error(e.message),t.telemetry.debug("[GetOrgUnitLocationsByArea] error getting Locations"),[])))}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-store-location-information",action:l,input:c}),g=d},681:(e,t,r)=>{"use strict";r.d(t,{Yh:()=>o.Y,eN:()=>n,__:()=>a._,Eu:()=>i});var n,i,o=r(1214),a=r(649);!function(e){function t(e){return a._.isNullOrUndefined(e)?[]:Object.keys(e).map((t=>e[t]))}function r(e){return t(e).filter(a._.isNumber)}e.getValues=t,e.getNames=function(e){return t(e).filter(a._.isString)},e.getNumericValues=r,e.getEnumValues=function(e){return r(e).map((e=>e))}}(n||(n={})),function(e){function t(e){if(a._.isNullOrUndefined(e))return!0;if(!a._.isString(e))throw new Error("StringExtensions has received a non-string input.");return""===e}e.isNullOrWhitespace=function(e){return t(e)||""===e.trim()},e.isNullOrEmpty=t}(i||(i={}))},682:(e,t,r)=>{"use strict";r.d(t,{W:()=>i});r(9);var n=r(1214);function i(e,t,r,i,o){const a=new Map;if(!r.requestContext.app.config.enableStockCheck)return{isValid:!0,productIdWithErrors:[]};const s=[];let c=!0;if(n.Y.hasElements(e)&&n.Y.hasElements(t)){for(const t of e)if(t.ProductId&&!t.IsInvoiceLine&&!t.IsGiftCardLine)if(a.has(t.ProductId)){var u,l;const e=null!==(u=a.get(t.ProductId))&&void 0!==u?u:0;a.delete(t.ProductId),a.set(t.ProductId,e+(null!==(l=t.Quantity)&&void 0!==l?l:1))}else{var d;a.set(t.ProductId,null!==(d=t.Quantity)&&void 0!==d?d:1)}const r=new Map;for(const e of t)e.ProductAvailableQuantity.ProductId&&!r.has(e.ProductAvailableQuantity.ProductId)&&r.set(e.ProductAvailableQuantity.ProductId,e);for(const t of Array.from(a.keys())){var g,y;const n=null!==(g=a.get(t))&&void 0!==g?g:1,u=r.get(t),l=null!==(y=null==u?void 0:u.ProductAvailableQuantity.AvailableQuantity)&&void 0!==y?y:void 0,d=e.find((e=>e.ProductId===t)),p=null==i?void 0:i.find((e=>e.RecordId===t));let m=!0;var h;if(p)m=!(null===(h=p.Behavior)||void 0===h||!h.IsStockedProduct);const v=!(null==d||!d.DeliveryMode||""===d.DeliveryMode)&&d.DeliveryMode===o,f=!m||v;f||(null==u||!u.IsProductAvailable||l&&n>l)&&(s.push(t),c=!1)}}return{isValid:c,productIdWithErrors:s}}},683:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetLoyaltyTransactionEstimationInput:()=>c,createGetLoyaltyTransactionEstimationInput:()=>u,default:()=>p,getLoyaltyTransactionEstimationAction:()=>l,getLoyaltyTransactionEstimationActionDataAction:()=>h});r(7),r(9);var n=r(2),i=r(26),o=r(32),a=r(88),s=r(6);class c{constructor(e,t){this.getCacheKey=()=>(0,s.buildCacheKey)(`GetLoyaltyCardTransactionEstimation-${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"GetLoyaltyCardTransactionEstimation",this.dataCacheType=()=>"request",this.userAccountNumber=t,this.apiSettings=e}}const u=e=>{const{requestContext:t}=e;return t.user.isAuthenticated,new c(e.requestContext.apiSettings)};async function l(e,t){if(!t.requestContext.user.isAuthenticated)return{};const r=[d(t),g(e,t),y(t)];return Promise.all(r).then((e=>e&&e.length>=2&&e[1].CardNumber?(0,o.getMaxLoyaltyPointsToRedeemForTransactionBalanceAsync)({callerContext:t},e[0].Id,e[1].CardNumber,e[2].Currency||"").then((e=>e)).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("Error getting Loyalty Point Redemption Estimate"),new Error("Error getting Loyalty Point Redemption Estimate")})):{})).catch((e=>({})))}async function d(e){const t=await(0,i.getCartState)(e);return t.cart}async function g(e,t){const r=new s.GetLoyaltyCardInput(e.apiSettings);return(0,s.getLoyalty)(r,t)}async function y(e){return(0,a.getOrgUnitConfigurationAsync)({callerContext:e,queryResultSettings:{}})}const h=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-loyalty-transaction-estimation",action:l,input:u}),p=h},684:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductPickUpOptionsForCartLineItems:()=>u,default:()=>g,getPickUpOptionsForCartLineItems:()=>l,getPickUpOptionsForCartLineItemsDataAction:()=>d});r(7);var n=r(2),i=r(26),o=r(14),a=r(6),s=r(43),c=r(36);class u{constructor(e){this.getCacheKey=()=>(0,a.buildCacheKey)("ActiveCartLineItemsPickUpOptions",this.apiSettings),this.getCacheObjectType=()=>"ActiveCartLineItemsPickUpOptions",this.dataCacheType=()=>"request",this.apiSettings=e}}async function l(e,t){if(!e.apiSettings.channelId)throw new Error("[getPickUpOptionsForCartLineItems]No valid Input was provided, failing");const r=await(0,i.getCartState)(t),n=r.cart,u=await(0,a.getActiveCartProductsAction)(new a.ActiveCartProductsInput,t),l=[];if(void 0===n||!s.ArrayExtensions.hasElements(u))return Promise.resolve(l);const d=await o.ProductsDataActions.getDeliveryOptionsAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},u.map((e=>e.RecordId)),{},4);return d}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-pickup-options-for-cartlines",action:l,input:e=>new u(e.requestContext.apiSettings)}),g=d},925:(e,t,r)=>{"use strict";r.d(t,{o:()=>i});var n=r(36);const i=e=>{const{requestContext:{query:{q:t,top:r,skip:i},apiSettings:{channelId:o}},config:{maxItems:a,itemsPerPage:s}}=e,c=n.l.fromInputData(e).QueryResultSettings;return{q:t,skip:i&&Number(i)||0,top:r&&Number(r)||50,itemsPerPage:s,maxItems:a,channelId:o,queryResultSettings:c}}},926:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});r(7);class n{constructor(e,t,r){this.body=e,this.resolve=t,this.reject=r}}class i{constructor(){this._queue=[],this._isBusy=!1}get _canProcess(){return!this._isBusy&&this._queue.length>0}async enqueue(e){return new Promise((async(t,r)=>{this._queue.push(new n(e,t,r)),await this._dequeue()}))}async _dequeue(){if(!this._canProcess)return;this._isBusy=!0;const e=this._queue.shift();await this._processElement(e),await this._processNext()}async _processElement(e){try{await e.body().then(e.resolve).catch(e.reject)}catch(t){e.reject(t)}}async _processNext(){this._isBusy=!1,await this._dequeue()}}},927:e=>{"use strict";e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},928:(e,t,r)=>{"use strict";var n=r(92),i=r(150),o=r(98);e.exports=function(e){for(var t=n(this),r=o(t),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),c=a>2?arguments[2]:void 0,u=void 0===c?r:i(c,r);u>s;)t[s++]=e;return t}},929:(e,t,r)=>{"use strict";var n=r(512),i=TypeError;e.exports=function(e){var t=n(e,"number");if("number"==typeof t)throw new i("Can't convert number to bigint");return BigInt(t)}},930:(e,t,r)=>{"use strict";var n=r(931),i=RangeError;e.exports=function(e,t){var r=n(e);if(r%t)throw new i("Wrong offset");return r}},931:(e,t,r)=>{"use strict";var n=r(111),i=RangeError;e.exports=function(e){var t=n(e);if(t<0)throw new i("The argument can't be less than 0");return t}},932:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetAttributeDefinitionsInput:()=>a,default:()=>c,getAttributeDefinitionsActionDataAction:()=>s});r(7);var n=r(2),i=r(30),o=r(46);class a{constructor(e,t){this.getCacheKey=()=>(0,o.S1)("AttributeDefinitions",this.apiSettings),this.getCacheObjectType=()=>"CustomerAttribute",this.dataCacheType=()=>"request",this.attributeDefinitionCriteria=t,this.apiSettings=e}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-custom-attributes",action:async(e,t)=>e&&t.requestContext.channel&&t.requestContext.channel.CustomerAttributeGroupId?(0,i.getAttributeDefinitionsAsync)({callerContext:t},e.attributeDefinitionCriteria||null).then((e=>e)):(t.trace("[getAttributeDefinitions]Invalid input passed to action"),[]),input:e=>{const{apiSettings:t,channel:r}=e.requestContext;if(!r||!r.CustomerAttributeGroupId)throw new Error("[getAttributeDefinitions][createInput]: Customer attribute group id is not found.");return new a(t,{AttributeGroupIdentifier:r.CustomerAttributeGroupId})}}),c=s},936:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,xJ:()=>a});r(25),r(7);var n=r(2),i=r(14),o=r(43);class a{constructor(e,t,r){var i;this.getCacheKey=()=>(0,o.generateCacheKey)(this._requestContext.apiSettings,{key:"Top",value:this.maxItems},{key:"CatalogId",value:this.catalogId}),this.getCacheObjectType=()=>this._mappedToHierarchy?"CategoryHierarchy":"Category",this.dataCacheType=()=>"application",this._requestContext=e,this._mappedToHierarchy=t,this.maxItems=r||250,this.channelId=null!=e&&null!==(i=e.apiSettings)&&void 0!==i&&i.channelId?Number(e.apiSettings.channelId):0,this.catalogId=(0,n.getCatalogId)(e)}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-categories",action:async function(e,t){return await i.CategoriesDataActions.getCategoriesAsync({callerContext:t},e.channelId,e.catalogId)},input:e=>{var t;const r=(null===(t=e.config)||void 0===t?void 0:t.topCategories)&&Number.parseInt(e.config.topCategories,10);return new a(e.requestContext,!1,r)}}),c=s},937:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetCategoryPathsInput:()=>s,createGetCategoryPathsInput:()=>c,default:()=>d,getCategoryPathsAction:()=>u,getCategoryPathsActionDataAction:()=>l});r(7);var n=r(2),i=r(34),o=r(36),a=r(46);class s{constructor(e,t){this.getCacheKey=()=>(0,a.hz)(this._requestContext.apiSettings,{key:"CategoryPathProductIds",value:this.categoryPathLooksups.map((e=>e.ProductId))},{key:"CatalogId",value:this.CatalogId},{key:"locale",value:this.locale}),this.getCacheObjectType=()=>"CategoryPath",this.dataCacheType=()=>"request",this.getLocale=()=>this.locale,this._requestContext=e,this.ChannelId=e.apiSettings.channelId,this.CatalogId=(0,n.getCatalogId)(e),this.categoryPathLooksups=t,this.apiSettings=e.apiSettings,this.locale=e.locale}}const c=e=>{const t=(0,a._T)(e);if(t)return new s(e.requestContext,[{ProductId:+t}]);throw new Error("Unable to create SelectedVariantInput, no productId found on module config or query")};async function u(e,t){const r=await(0,i.getCategoryPathsAsync)({callerContext:t,queryResultSettings:o.l.getPagingFromInputDataOrDefaultValue(t)},e.ChannelId,e.CatalogId,e.categoryPathLooksups),a=r[0].CategoryPath&&r[0].CategoryPath[0],s=(0,n.getCategoriesUrlSync)(a,t);return s?s.slice(1):[]}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-category-paths",action:u,input:c}),d=l},939:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ActiveWishlistInput:()=>a,default:()=>c,getActiveWishlistItems:()=>s});r(7),r(4);var n=r(2),i=r(338),o=r(6);class a{constructor(){this.getCacheKey=()=>"ActiveWishlistItems",this.getCacheObjectType=()=>"ActiveWishlistItems",this.dataCacheType=()=>"none"}}async function s(e,t){if(!e)throw new Error("[getActiveWishlistItems]No valid Input was provided, failing");if(t.requestContext.user.isAuthenticated){const e=await(0,i.A0)({callerContext:t,queryResultSettings:{}},null);if(!(e&&e.length>0))return t.trace("[getActiveWishlistItems]Not able to get wishlists for the customer"),[];{const r=[];if(e[0].CommerceListLines&&e[0].CommerceListLines.forEach((e=>{e.ProductId&&r.push(new o.FullProductInput(e.ProductId,t.requestContext.apiSettings,(0,o.getProductDetailsCriteriaFromActionInput)(t),t.requestContext))})),r.length>0)return(0,o.getFullProducts)(r,t).then((e=>e||[])).catch((e=>{throw t.trace(e),t.telemetry.exception(e),t.telemetry.debug("[getActiveWishlistItems]Unable to hydrate cart with product information"),new Error("[getActiveWishlistItems]Unable to hydrate cart with product information")}));t.trace("No productIds found for wishlist")}}return t.trace("[getActiveWishlistItems]User token not found for wishlists"),[]}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-items-in-wishlist",action:s,input:e=>new a})},940:(e,t,r)=>{"use strict";r.r(t),r.d(t,{MediaLocationsByIdInput:()=>s,createMediaLocationsByIdInput:()=>c,default:()=>d,getMediaLocationsByIdAction:()=>u,getMediaLocationsByIdActionDataAction:()=>l});r(7);var n=r(2),i=r(34),o=r(36),a=r(46);class s{constructor(e,t,r){this.getCacheKey=()=>(0,a.hz)(this.apiSettings,{key:"Key",value:"MediaLocationID"},{key:"ProductId",value:this.productId},{key:"CatalogId",value:this.catalogId}),this.getCacheObjectType=()=>"MediaLocations",this.dataCacheType=()=>"none",this.productId=t,this.channelId=+e.channelId,this.catalogId=r||0,this.apiSettings=e}}const c=e=>{const t=e.config&&+e.config.productId||void 0,r=(0,n.getCatalogId)(e.requestContext);return new s(e.requestContext.apiSettings,t,r)};async function u(e,t){if(e.productId){var r;if(null!==(r=t.requestContext.app)&&void 0!==r&&null!==(r=r.config)&&void 0!==r&&r.OmniChannelMedia){const r=new n.MediaLocationsInput(t.requestContext,e.productId,e.channelId,e.catalogId);return(0,n.getMediaLocationsForProductAction)(r,t)}return(0,i.getMediaLocationsAsync)({callerContext:t,queryResultSettings:o.l.getPagingFromInputDataOrDefaultValue(t)},e.productId,e.channelId,e.catalogId).then((e=>e.map((e=>(e.Uri=(0,a.wV)(e.Uri,t.requestContext.apiSettings),e.AltText=e.AltText?e.AltText:"",e)))))}return[]}const l=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-media-locations-by-id",action:u,input:c}),d=l},941:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AdditionalMediaLocationsForSelectedVariantInput:()=>c,createMediaLocationsForSelectedVariantInput:()=>u,default:()=>g,getAdditionalMediaLocationsForSelectedVariantAction:()=>l,getAdditionalMediaLocationsForSelectedVariantActionDataAction:()=>d});r(7);var n=r(2),i=r(176),o=r(14),a=r(72),s=r(43);class c{constructor(e,t,r,n){this.getCacheKey=()=>"AdditionalMediaLocationsForSelectedVariant",this.getCacheObjectType=()=>"MediaLocations",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.catalogId=n||0,this.selectedProduct=r}}const u=e=>{const t=(0,s.getSelectedProductIdFromActionInput)(e),r=(0,n.getCatalogId)(e.requestContext);if(t)return new c(+t,+e.requestContext.apiSettings.channelId,void 0,r);throw new Error("Unable to create AdditionalMediaLocationsForSelectedVariantInput, no productId found on module config or query")};async function l(e,t){return o.AsyncResult.resolve().then((()=>{const r=e.selectedProduct;if(!r){const r=new a.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);return(0,a.default)(r,t)}return r})).then((r=>{const o=r;var a;if(o&&(null!==(a=t.requestContext.app)&&void 0!==a&&null!==(a=a.config)&&void 0!==a&&a.OmniChannelMedia)){const r=new i.KI(t.requestContext,o.RecordId,e.channelId,e.catalogId);return(0,n.getAdditionalMediaLocationsForProductAction)(r,t)}return[]})).catch((e=>{throw t.trace(e),t.telemetry.error(e.message),t.telemetry.debug("[getAdditionalMediaLocationsForSelectedVariantAction]Error executing action"),new Error("[getAdditionalMediaLocationsForSelectedVariantAction]Error executing action")}))}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-additional-media-locations-for-selected-variant",action:l,input:u}),g=d},942:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OrganizationUsersInput:()=>a,createGetOrganizationUsersInput:()=>s,default:()=>l,getOrganizationUsers:()=>c,getOrganizationUsersDataAction:()=>u});r(7);var n=r(2),i=r(199),o=r(46);class a{constructor(e){this.getCacheKey=()=>(0,o.S1)("OrganizationUsers",this.apiSettings),this.getCacheObjectType=()=>"BusinessPartner",this.dataCacheType=()=>"request",this.apiSettings=e}}const s=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("User is not logged in.");return new a(t.apiSettings)};async function c(e,t){return(0,i.getCurrentAsync)({callerContext:t}).then((e=>(0,i.getUsersAsync)({callerContext:t},e.BusinessPartnerId).then((e=>e)).catch((e=>{throw t.telemetry.exception(e),t.trace("[get-organization-users] Unable to load users"),new Error("[get-organization-users] Unable to load users")})))).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("[get-organization-users] Unable to get BusinessPartner"),new Error("[get-organization-users] Unable to get BusinessPartner")}))}const u=(0,n.createObservableDataAction)({id:"get-organization-users",action:c,input:s}),l=u},943:(e,t,r)=>{"use strict";r.r(t),r.d(t,{OrganizationUsersCountInput:()=>o,createGetOrganizationUsersCountInput:()=>a,default:()=>c,getOrganizationUsersCount:()=>s});r(7);var n=r(2),i=r(199);class o{constructor(){this.getCacheKey=()=>"OrganizationUsersCount",this.getCacheObjectType=()=>"BusinessPartner",this.dataCacheType=()=>"none"}}const a=e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("User is not logged in.");return new o};async function s(e,t){return(0,i.getCurrentAsync)({callerContext:t}).then((e=>e?(0,i.getUsersAsync)({callerContext:t},e.BusinessPartnerId).then((e=>e.length)).catch((e=>{throw t.telemetry.exception(e),t.trace("[get-organization-users-count] Unable to load users"),new Error("[get-organization-users-count] Unable to load users")})):0)).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("[get-organization-users-count] Unable to get BusinessPartner"),new Error("[get-organization-users-count] Unable to get BusinessPartner")}))}const c=(0,n.createObservableDataAction)({id:"get-organization-users-count",action:s,input:a})},944:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CreateGetInvoiceDetailsInput:()=>a,GetInvoiceDetailsInput:()=>o,default:()=>u,getInvoiceDetails:()=>s,getInvoiceDetailsDataAction:()=>c});r(7);var n=r(2),i=r(14);class o{constructor(e){this.getCacheKey=()=>`GetInvoiceDetails|${this.invoiceId}`,this.getCacheObjectType=()=>"SalesInvoice",this.dataCacheType=()=>"request",this.invoiceId=e}}const a=e=>{var t;const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to get invoice details as User is not logged in.");if(null==e||null===(t=e.requestContext)||void 0===t||null===(t=t.query)||void 0===t||!t.invoiceId)throw new Error("Unable to get invoice details as no valid invoice id found.");return new o(e.requestContext.query.invoiceId)};async function s(e,t){var r;if(null==t||null===(r=t.requestContext)||void 0===r||null===(r=r.user)||void 0===r||!r.isAuthenticated)throw new Error("Unable to get details for the invoice. User is not authenticated.");if(!e.invoiceId)throw new Error("Unable to get invoice details as no valid invoice id found.");const n=e.invoiceId,o={InvoiceId:n};return i.SalesOrdersDataActions.getInvoiceDetailsAsync({callerContext:t},o)}const c=(0,n.createObservableDataAction)({id:"get-invoice-details",action:s,input:a}),u=c},957:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,Py:()=>a});r(7),r(12),r(9);var n=r(2),i=r(6),o=r(423);class a{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.getCacheKey=()=>"GetFullOrderTemplates",this.getCacheObjectType=()=>"GetFullOrderTemplates",this.dataCacheType=()=>"none",this.queryResultSettings=e,this.getPrice=t,this.getRating=r}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-full-order-templates",action:async function(e,t){if(!t.requestContext.user.isAuthenticated)throw new Error("Unable to get full order templates. User is not authenticated.");const r=[],n=new i.GetOrderTemplatesInput,a=await(0,i.getOrderTemplates)(n,t);if(!a||0===a.length)return r;const s=[];for(const r of a){const n=new i.GetPaginatedOrderTemplateLinesInput(r.Id,e.queryResultSettings,void 0,e.getPrice,e.getRating);s.push((0,i.getPaginatedOrderTemplateLinesAction)(n,t))}const c=await Promise.all(s);for(const e of a){const t=c.filter((t=>t.lines.length>0&&t.lines[0].productListLine.ProductListId===e.Id));t.length>0?r.push(new o.$(e,t[0].lines,t[0].totalCount)):r.push(new o.$(e,[],0))}return t.trace(r.length.toString()),r},input:e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("Unable to get full order templates. User is not authenticated.");const r=i.QueryResultSettingsProxy.fromInputData(e).QueryResultSettings;return r.count=!0,new a(r)}}),c=s},958:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GetDistributorListInput:()=>a,createGetDistributorListInput:()=>s,default:()=>l,getDistributorDataAction:()=>u,getDistributorListAction:()=>c});r(7),r(4),r(9);var n=r(2),i=r(14),o=r(43);class a{constructor(e,t,r,n){this.getCacheKey=()=>"GetDistributorListCache",this.getCacheObjectType=()=>"GetDistributorListInput",this.dataCacheType=()=>"none",this.ChannelId=t,this.StoreNumber=r,this.InventoryLocationId=n,this.queryResultSettings=e}}const s=e=>{if(e.requestContext&&e.requestContext.user&&e.requestContext.user.isSignedIn||e.requestContext.params.isEditor){const t=o.QueryResultSettingsProxy.fromInputData(e).QueryResultSettings;return new a(t)}throw new Error("Unable to create get distributor list. User is not authenticated.")};async function c(e,t){const r={ChannelTypeValue:3,OnlineStoreCustomerTypeValue:1,ChannelId:e.ChannelId,StoreNumber:e.StoreNumber,InventoryLocationId:e.InventoryLocationId},n=t.requestContext.markets;return i.OrgUnitsDataActions.searchAsync({callerContext:t,bypassCache:"get"},r).then((async e=>{const r=function(e,t){const r=e.filter((e=>null==t?void 0:t.some((t=>{var r;return(null===(r=t.channelItem)||void 0===r?void 0:r.retailServerChannelId)===e.RecordId}))));return r}(e,n),a=[];null==r||r.forEach((e=>{void 0!==e&&a.push(e.RecordId)}));const s=await async function(e,t){if(0===(null==e?void 0:e.length)||void 0===e)return;const r=[];return null==e||e.forEach((e=>{void 0!==e&&r.push(e)})),i.OrgUnitsDataActions.getChannelDeliveryOptionsAsync({callerContext:t,queryResultSettings:o.QueryResultSettingsProxy.getPagingFromInputDataOrDefaultValue(t)},r,4).then((e=>{if(e&&!(e instanceof Error))return e})).catch((e=>(t.trace("[getDistributorList][_getLocationPickUpDeliveryModes] error getting availability with channel delivery options"),t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getDistributorList] [_getLocationPickUpDeliveryModes] error getting availability with channel delivery options"),[])))}(a,t),c=r.map((async e=>{const t=function(e,t){return null==e?void 0:e.find((e=>{var r;return(null==e||null===(r=e.channelItem)||void 0===r?void 0:r.retailServerChannelId)===t}))}(n,e.RecordId),r=null==s?void 0:s.find((t=>t.ChannelId===e.RecordId));return async function(e,t,r){if(!e||!e.OrgUnitNumber)return{OrgUnit:void 0,OrgUnitDeliveryOptions:void 0,MarketSettings:void 0};return{OrgUnit:e,OrgUnitDeliveryOptions:t,MarketSettings:r}}(e,r,t)}));return Promise.all(c)})).catch((e=>(t.trace("[GetDistributor] error getting distributors from searchAsync"),t.trace(e.message),t.telemetry.error(e.message),t.telemetry.debug("[GetDistributor] error getting distributors from searchAsync"),[])))}const u=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-distributor",action:c,input:s}),l=u},959:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ProductDimensionsWithAvailabilitiesInput:()=>d,createProductDimensionsWithAvailabilitiesInput:()=>g,default:()=>p,getProductDimensionsWithAvailabilities:()=>h,getProductDimensionsWithAvailabilitiesAction:()=>y});r(4);var n=r(5),i=(r(7),r(9),r(2)),o=r(14),a=r(43),s=r(122),c=r(36);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class d{constructor(e,t,r){this.getCacheKey=()=>"ProductDimensionsWithAvailabilities",this.getCacheObjectType=()=>"ProductDimensionsWithAvailabilities",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,r&&(this.catalogId=(0,i.getCatalogId)(r))}}const g=e=>{const t=(0,a.getSelectedProductIdFromActionInput)(e);if(t)return new d(+t,+e.requestContext.apiSettings.channelId,e.requestContext);throw new Error("Unable to create ProductDimensionsWithAvailabilitiesInput, no productId found on module config or query")};async function y(e,t){var r;const n=a.ArrayExtensions.validValues(await o.ProductsDataActions.getByIdsAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},e.channelId,[e.productId],null,null!==(r=e.catalogId)&&void 0!==r?r:0));if(!a.ArrayExtensions.hasElements(n))return[];const i=n[0];if(!a.ArrayExtensions.hasElements(i.Dimensions))return[];let u=[];i.Dimensions.map((e=>{u.push(e.DimensionTypeValue)}));const d=(0,s.L9)(t,[],!0,void 0,void 0),g={RequestedDimensionTypeValues:u,MatchingDimensionValues:[],DefaultWarehouseOnly:d.DefaultWarehouseOnly,FilterByChannelFulfillmentGroup:d.FilterByChannelFulfillmentGroup,DeliveryModeTypeFilterValue:d.DeliveryModeTypeFilterValue,CatalogId:e.catalogId},y=o.ProductsDataActions.getDimensionValuesWithEstimatedAvailabilitiesAsync({callerContext:t,queryResultSettings:c.l.getPagingFromInputDataOrDefaultValue(t)},i.MasterProductId?i.MasterProductId:i.RecordId,g),h=i.Dimensions.map((e=>y.then((t=>{const r=t.filter((t=>t.DimensionTypeValue===e.DimensionTypeValue)),n=l(l({},e),{},{dimensionValuesWithInventory:r});return n}))));return await Promise.all(h)}const h=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-dimensions-with-availabilities",action:y,input:g}),p=h},1079:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,Jx:()=>c});r(4);var n=r(5),i=(r(7),r(2)),o=r(14),a=r(43);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class c{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"AddItemToProductListInput",this.getCacheObjectType=()=>"AddItemToProductListInput",this.dataCacheType=()=>"none",this.productListId=e,this.productId=t,this.quantity=r,this.unitOfMeasure=n||"ea",this.isMultipleCatalogFeatureEnabledInHq=i,this.catalogId=o}}const u=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/add-item-to-product-list",action:async function(e,t){try{const r=e.catalogId,i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({ProductListId:e.productListId,ProductId:e.productId,Quantity:e.quantity,UnitOfMeasure:e.unitOfMeasure},e.isMultipleCatalogFeatureEnabledInHq&&{catalogId:r}),c=await o.ProductListsDataActions.addProductListLinesAsync({callerContext:t},e.productListId,[i]);if(a.ArrayExtensions.hasElements(c)&&c[0].ProductListId)return c[0];throw t.telemetry.error("Product list line was not returned when adding it to quick order bag"),new Error("Product list line was not returned when adding it to quick order bag")}catch(e){throw t.telemetry.error("Not able to add an item to quick order bag",e),e}},input:(e,t,r,n,i,o,a)=>{const{requestContext:s}=e;if(!s.user.isAuthenticated)throw new Error("Unable to create product list. User is not authenticated.");return new c(t,r,n,i,o||!1,a)}}),l=u},1080:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,C4:()=>a});r(7);var n=r(2),i=r(199),o=r(130);class a{constructor(e){this.getCacheKey=()=>"AddOrganizationUser",this.getCacheObjectType=()=>"AddOrganizationUser",this.dataCacheType=()=>"none",this.user=e}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/add-organization-user",action:async function(e,t){const{user:r}=e;let n="";return(0,i.getCurrentAsync)({callerContext:t}).then((e=>(r.BusinessPartnerId=e.BusinessPartnerId,(0,o.createBusinessPartnerUserAsync)({callerContext:t},r).then((e=>e)).catch((e=>{throw t.telemetry.debug("[add-organization-user] Unable to create BusinessPartnerUser account"),e&&"Microsoft_Dynamics_Commerce_Runtime_EmailIdAlreadyRegistered"===e.name&&(n=e.message),new Error("[add-organization-user] Unable to create BusinessPartnerUser account")}))))).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("[add-organization-user] Unable to get BusinessPartner Admin account"),n}))},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("User is not logged in.");return new a(t)}}),c=s},1081:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,w3:()=>o});r(7);var n=r(2),i=r(14);class o{constructor(e,t){this.getCacheKey=()=>"CreateProductListInput",this.getCacheObjectType=()=>"CreateProductListInput",this.dataCacheType=()=>"none",this.templateName=e,this.templateType=t}}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/create-product-list",action:async function(e,t){try{const r={Id:"",Name:e.templateName,ProductListTypeValue:e.templateType},n=await i.ProductListsDataActions.createProductListAsync({callerContext:t},r);if(""!==n.Id)return n;throw t.telemetry.error("Created product list was null"),new Error("Created product list was null")}catch(e){throw t.telemetry.error("Not able to create product list",e),e}},input:(e,t,r)=>{const{requestContext:n}=e;if(!n.user.isAuthenticated)throw new Error("Unable to create product list. User is not authenticated.");return new o(t,r)}}),s=a},1082:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,os:()=>o});r(7);var n=r(2),i=r(130);class o{constructor(e){this.getCacheKey=()=>"DeleteOrganizationUser",this.getCacheObjectType=()=>"DeleteOrganizationUser",this.dataCacheType=()=>"none",this.user=e}}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/delete-organization-user",action:async function(e,t){const{user:r}=e;return(0,i.deleteAsync)({callerContext:t},r).catch((e=>{throw console.log(e),t.telemetry.debug("[Delete-organization-user] Unable to delete BusinessPartnerUser account"),new Error("[Delete-organization-user] Unable to delete BusinessPartnerUser account")}))},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("User is not logged in.");return new o(t)}}),s=a},1083:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,JN:()=>o});r(7);var n=r(2),i=r(130);class o{constructor(e){this.getCacheKey=()=>"EditOrganizationUser",this.getCacheObjectType=()=>"EditOrganizationUser",this.dataCacheType=()=>"none",this.user=e}}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/Edit-organization-user",action:async function(e,t){const{user:r}=e;return(0,i.updateAsync)({callerContext:t},r).then((e=>e)).catch((()=>{throw t.telemetry.debug("[Edit-organization-user] Unable to update BusinessPartnerUser account"),new Error("[Edit-organization-user] Unable to update BusinessPartnerUser account")}))},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("User is not logged in.");return new o(t)}}),s=a},1084:(e,t,r)=>{"use strict";r.d(t,{K:()=>i,a:()=>n});r(7);class n{constructor(e,t,r){this.getCacheKey=()=>`Generic-${this.cacheKey}`,this.getCacheObjectType=()=>`${this.cacheObjectType}`,this.dataCacheType=()=>"none",this.cacheKey=e,this.cacheObjectType=r,this.result=t}}async function i(e,t){return e.result}},1085:(e,t,r)=>{"use strict";r.d(t,{Xy:()=>u,ho:()=>c});r(7);var n=r(2),i=r(34),o=r(6),a=r(72),s=r(36);class c{constructor(e,t,r,n){this.getCacheKey=()=>"AttributesForSelectedVariant",this.getCacheObjectType=()=>"ProductAttributeValue",this.dataCacheType=()=>"none",this.productId=e,this.channelId=t,this.selectedProduct=r,this.catalogId=n||0}}async function u(e,t){return Promise.resolve().then((()=>{const r=e.selectedProduct;if(!r){const r=new o.SelectedVariantInput(e.productId,e.channelId,void 0,void 0,t.requestContext);return(0,a.getSelectedVariantActionDataAction)(r,t)}return r})).then((r=>{const n=r;return n?(0,i.getAttributeValuesAsync)({callerContext:t,queryResultSettings:s.l.getPagingFromInputDataOrDefaultValue(t)},n.RecordId,e.channelId,e.catalogId):null})).then((e=>{const t=e;return t||[]})).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getPriceForSelectedVariantAction]Error executing action"),new Error("[getPriceForSelectedVariantAction]Error executing action")}))}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-attributes-for-selected-variant",action:u,input:e=>{const t=(0,o.getSelectedProductIdFromActionInput)(e),r=(0,n.getCatalogId)(e.requestContext);if(t)return new c(+t,+e.requestContext.apiSettings.channelId,void 0,r);throw new Error("Unable to create PriceForSelectedVariantInput, no productId found on module config or query")}})},1086:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>u,Td:()=>s});r(7),r(9);var n=r(2),i=r(14),o=r(657),a=r(43);class s{constructor(e,t,r){this.getCacheKey=()=>`DimensionAvailabilitiesForProductSearchResult:${this.products.map((e=>e.RecordId)).join("-")}`,this.getCacheObjectType=()=>"ProductDimensionValueInventoryAvailability",this.dataCacheType=()=>"none",this.products=e,this.dimensionContext=t,this.displayType=r}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-dimension-availabilities-for-product-search-result",action:async function(e,t){const r=e.products,n=[],s=e.dimensionContext.app.config.inventoryLevel,c=e.displayType;for(const s of r){var u;const r=null===(u=s.AttributeValues)||void 0===u?void 0:u.filter((t=>{var r,n;return(0,a.checkIfShouldDisplayAsSwatch)(null!==(r=null===(n=t.Name)||void 0===n?void 0:n.toLocaleLowerCase())&&void 0!==r?r:"",e.dimensionContext,c)}));if(a.ArrayExtensions.hasElements(r)){const e=[];for(const t of r)if(t.Name){const r=i.ProductDimensionType[t.Name];e.push(r)}var l;if(a.ArrayExtensions.hasElements(e))n.push(new o.ML(null!==(l=s.MasterProductId)&&void 0!==l?l:s.RecordId,void 0,t.requestContext,e))}}if(!a.ArrayExtensions.hasElements(n))return Promise.resolve([]);try{const e=await(0,o.pl)(n,t),r=n.map(((t,r)=>e[r].map((e=>{var r;const n=(0,a.getInventoryLevelCodeFromDimensionValue)(e,s),i=e.DimensionValue;return{value:null!==(r=i.Value)&&void 0!==r?r:"",isDisabled:n===a.InventoryLevelValues.outOfStock,masterProductId:t.masterProductId}}))));return a.ArrayExtensions.hasElements(r)?Promise.resolve(r):(t.telemetry.warning("ProductsDimensionAvailabilities is empty"),Promise.resolve([]))}catch(e){t.telemetry.warning(e)}return Promise.resolve([])},input:(e,t)=>new s(e,t)}),u=c},1087:(e,t,r)=>{"use strict";r.d(t,{dP:()=>s,Ay:()=>u});r(7);var n=r(2),i=r(1245),o=r(659);class a{constructor(e,t,r){this.productList=e,this.quickOrderTemplateLines=t,this.totalLines=r}}class s{constructor(e){this.getCacheKey=()=>"GetFullProductList",this.getCacheObjectType=()=>"GetFullProductList",this.dataCacheType=()=>"none",this.productListId=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-full-product-list",action:async function(e,t){if(!t.requestContext.user.isAuthenticated)throw new Error("Unable to get full quick order template. User is not authenticated.");const r=new i.A0(e.productListId),n=await(0,i.Ay)(r,t).then((e=>{const r=new o.ZN(e[0].Id);return(0,o.Ay)(r,t).then((t=>new a(e[0],t.lines,t.totalCount)))}));return n},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to get full product list. User is not authenticated.");return new s(t)}}),u=c},1088:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,ZB:()=>a});r(20),r(7),r(4),r(9);var n,i=r(2),o=r(279);class a{constructor(e,t,r,n,i,o,a,s,c,u,l,d){this.shouldCacheOutput=()=>!0,this.getCacheObjectType=()=>"LIST",this.getCacheKey=()=>`${this.DocumentId}-${this.ItemsCount}-${this.ItemsPerPage}-${this.SkipCount}`,this.DocumentId=e,this.Title=t,this.Description=r,this.ShortDescription=n,this.BackgroundColor=i,this.ForegroundColor=o,this.Images=a,this.Items=s,this.ProductItems=c,this.ItemsCount=u,this.ItemsPerPage=l,this.SkipCount=d}}function s(e){const t=[];return e?(e.forEach((e=>{if(e&&e.image&&e.image.href){const r={href:e.image.href,altText:e.image.altText,title:e.image.title,width:e.image.width,height:e.image.height};t.push(r)}})),t):t}function c(e,t){const r=s(e.fields.content.images),n=(i=e.fields._name,o=t,i?o?`${o}/${i}.l`:`/${i}.l`:"");var i,o;return{Title:e.fields.content.title,Description:e.fields.content.description,ShortDescription:e.fields.content.shortDescription,BackgroundColor:e.fields.content.backgroundColor,ForegroundColor:e.fields.content.foregroundColor,Href:n,Images:r}}function u(e){return e&&e.requestContext&&e.requestContext.sitePath?e.requestContext.sitePath:""}!function(e){e.list="list",e.product="product"}(n||(n={}));const l=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-list",action:async function(e,t){t.trace(`List Title: ${e.Title}`);const{apiSettings:r}=t.requestContext,n={Title:e.Title,Description:e.Description,ShortDescription:e.ShortDescription,BackgroundColor:e.BackgroundColor,ForegroundColor:e.ForegroundColor,Items:[],ItemsCount:e.ItemsCount};if(e&&e.Items&&e.Items.length>0){let a=[];if(e.ProductItems&&e.ProductItems.length>0){const n=e.ProductItems.map((e=>new o.M$(+e.RecordId,r,void 0,void 0,t.requestContext)));a=await(0,o.Ay)(n,t)}const s={};a.forEach((e=>{e&&(s[`${e.RecordId}`]=e)}));for(const t of e.Items)i=t,void 0!==i.Images?n.Items.push(t):t.forEach((e=>{s[e.RecordId]&&n.Items.push(s[e.RecordId])}))}var i;return n},input:e=>{const t=function(e){let t=e&&e.requestContext&&e.requestContext.pageData?e.requestContext.pageData.list:null;if(!(e&&e.requestContext&&e.requestContext.pageData&&e.requestContext.pageData.list&&e.requestContext.pageData.list.content&&e.requestContext.pageData.list.content.items&&e.requestContext.pageData.list.content.title&&e.requestContext.pageData.list._id)){if(!(e&&e.data&&e.data.list&&e.data.list.content&&e.data.list.content.items&&e.data.list.content.title&&e.data.list._id))throw console.error("data is not well defined for list action input"),new Error("data is not well defined for list action input");t=e.data.list}return t}(e),r=[];let i=[];const o=s(t.content.images),l=function(e){if(!e||!e.config||!e.config.itemsPerPage)return 50;const t=Number(e.config.itemsPerPage);return isNaN(t)?50:t}(e),d=function(e){return e&&e.requestContext&&e.requestContext.query&&e.requestContext.query.skipCount?Number(e.requestContext.query.skipCount):0}(e),g=[],y=d+l;for(let o=d;o<t.content.items.length&&o<y;o++){const a=t.content.items[o];if(a.type===n.list){if(!a.fields||!a.fields.content||!a.fields.content.title){console.error(`sublist item fields, content or title missing in list ${t._id}`);continue}if(i.length>0){const e=[...i];r.push(e),i=[]}r.push(c(a,u(e)))}if(a.type===n.product){if(!a.fields||!a.fields.recordId){console.error(`product item missing recordId in list ${t._id}`);continue}const e={RecordId:a.fields.recordId,CatalogId:a.fields.catalogId||"0"};i.push(e),g.push(e)}}return i.length>0&&r.push(i),new a(t._id,t.content.title,t.content.description,t.content.shortDescription,t.content.backgroundColor,t.content.foregroundColor,o,r,g,t.content.items.length,l,d)}}),d=l},1089:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>u,Tn:()=>s});r(7);var n=r(2),i=r(14),o=r(199),a=r(36);class s{constructor(e){this.getCacheKey=()=>`GetOrganizationWideOrderHistoryInput|${(0,i.convertToString)(this.queryResultSettings)}`,this.getCacheObjectType=()=>"GetOrganizationWideOrderHistoryInput",this.dataCacheType=()=>"request",this.queryResultSettings=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-organization-wide-order-history",action:async function(e,t){var r;if(null==t||null===(r=t.requestContext)||void 0===r||null===(r=r.user)||void 0===r||!r.isAuthenticated)throw new Error("Unable to get order history. User is not authenticated.");const n=await(0,o.getCurrentAsync)({callerContext:t});if(!n)throw new Error("Unable to get order history. Failed to retrieve business partner id.");return(0,o.getOrderHistoryAsync)({callerContext:t,queryResultSettings:e.queryResultSettings},n.BusinessPartnerId)},input:e=>{var t;if(null==e||null===(t=e.requestContext)||void 0===t||null===(t=t.user)||void 0===t||!t.isAuthenticated)throw new Error("Unable to get order history. User is not authenticated.");const r=a.l.fromInputData(e).QueryResultSettings;return new s(r)}}),u=c},1090:(e,t,r)=>{"use strict";r.d(t,{Fx:()=>s,x0:()=>c});r(7);var n=r(2),i=r(14),o=r(43),a=r(36);class s{constructor(e){this.getCacheKey=()=>`PriceForProductSearchResult-${JSON.stringify(this.products)}`,this.getCacheObjectType=()=>"ProductSearchResult",this.dataCacheType=()=>"none",this.products=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-price-for-product-search-result",action:async function(e,t){let r;if(!o.ArrayExtensions.hasElements(e.products))return Promise.resolve([]);r=e.products.map((e=>e.RecordId));const s=(0,n.getCatalogId)(t.requestContext),c={ChannelId:+t.requestContext.apiSettings.channelId,CatalogId:s};try{const n=await i.ProductsDataActions.getActivePricesAsync({callerContext:t,queryResultSettings:a.l.getPagingFromInputDataOrDefaultValue(t)},c,r,new Date,null,void 0,!0),o=e.products.map((e=>{const t=n.find((t=>t.ProductId===e.RecordId));var r,i,o,a;t&&(e.Price=null!==(r=t.CustomerContextualPrice)&&void 0!==r?r:e.Price,e.BasePrice=Math.max(null!==(i=t.BasePrice)&&void 0!==i?i:0,null!==(o=t.TradeAgreementPrice)&&void 0!==o?o:0,null!==(a=t.AdjustedPrice)&&void 0!==a?a:0));return e}));return Promise.resolve(o)}catch(e){throw t.telemetry.exception(e),t.telemetry.debug("[getPriceForProductSearchResultAction]Error executing action"),new Error("[getPriceForProductSearchResultAction]Error executing action")}},input:e=>new s(e)})},1091:(e,t,r)=>{"use strict";r.d(t,{BW:()=>c,Lg:()=>s});r(7);var n=r(2),i=r(14),o=r(43),a=r(36);class s{constructor(e){this.getCacheKey=()=>`ProductPriceForSelectedProducts-${JSON.stringify(this.productIds)}`,this.getCacheObjectType=()=>"ProductPrices",this.dataCacheType=()=>"none",this.productIds=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-prices-for-selected-products",action:async function(e,t){let r;if(!o.ArrayExtensions.hasElements(e.productIds))return Promise.resolve([]);r=e.productIds;const s=(0,n.getCatalogId)(t.requestContext),c={ChannelId:+t.requestContext.apiSettings.channelId,CatalogId:s};try{const e=await i.ProductsDataActions.getActivePricesAsync({callerContext:t,queryResultSettings:a.l.getPagingFromInputDataOrDefaultValue(t)},c,r,new Date,null,void 0,!0);return Promise.resolve(e)}catch(e){throw t.telemetry.exception(e),t.telemetry.debug("[getProductPriceForSelectedProductsAction]Error executing action"),new Error("[getProductPriceForSelectedProductsAction]Error executing action")}},input:e=>new s(e)})},1092:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>u,bJ:()=>s});r(7);var n=r(2),i=r(26),o=r(32),a=r(6);class s{constructor(e){this.getCacheKey=()=>(0,a.buildCacheKey)("ActiveCartLineItemsPromotionOptions",this.apiSettings),this.getCacheObjectType=()=>"ActiveCartLineItemsPromotionOptions",this.dataCacheType=()=>"none",this.apiSettings=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-promotion-options-for-cartlines",action:async function(e,t){if(!e)throw new Error("[getPromotionOptionsForCartLineItems]No valid Input was provided, failing");const r=await(0,i.getCartState)(t);if(r.hasInvoiceLine)return t.trace("[getPromotionOptionsForCartLineItems] cart has invoice line"),[];const n=r.cart,s=await(0,a.getActiveCartProductsAction)(new a.ActiveCartProductsInput,t);if(!n||!n.CartLines||!s||0===s.length)return t.trace("[getPromotionOptionsForCartLineItems] Not able to get cart OR channelConfiguration or no products in cart"),[];const c=n.CartLines.map((e=>e.LineId||""));return(0,o.getAvailablePromotionsAsync)({callerContext:t,queryResultSettings:{},bypassCache:"get"},n.Id,c||null).then((e=>e)).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getPromotionOptionsForCartLineItems]Error executing action"),new Error("[getPromotionOptionsForCartLineItems]Error executing action")}))},input:e=>new s(e.requestContext.apiSettings)}),u=c},1093:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,VW:()=>s});r(7);var n=r(2),i=r(1213),o=r(6),a=r(46);class s{constructor(e,t,r,n){this.getCacheKey=()=>(0,a.S1)(`Product-${this.skuNumber}`,this.apiSettings),this.getCacheObjectType=()=>"ProductSKU",this.dataCacheType=()=>"request",this.skuNumber=t,this.channelId=r,this.matchingDimensionValues=n||[],this.apiSettings=e}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-scan-results",action:async function(e,t){return(0,i.vu)({callerContext:t},e.skuNumber).then((r=>{if(r&&r.Product)return(0,o.getDimensionsForSelectedVariant)(new o.GetDimensionsForSelectedVariantInput(r.Product.MasterProductId?r.Product.MasterProductId:r.Product.RecordId,e.channelId,e.matchingDimensionValues,t.requestContext),t).then((e=>e&&e.length>0?{ScanResult:r,Product:r.Product,ProductDimensionFull:e}:{ScanResult:r,Product:r.Product})).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getScanResult, getDimensionsForSelectedVariant]Error executing action"),new Error("[getScanResult, getDimensionsForSelectedVariant]Error executing action")}));throw new Error("Unable to get result from scan result data action.")})).catch((e=>{throw t.trace(e.message),t.telemetry.exception(e),t.telemetry.debug("[getScanResult]Error executing action"),new Error("[getScanResult]Error executing action")}))},input:(e,t,r,n)=>new s(e.requestContext.apiSettings,t,r,n)})},1094:(e,t,r)=>{"use strict";r.d(t,{oe:()=>u,Ay:()=>g});r(7),r(9);var n=r(2),i=r(26),o=r(200),a=r.n(o),s=r(32);class c{constructor(e,t,r,n){this.cartLineIds=n,this.deliveryOptions=e,this.hasError=t,this.error=r}}class u{constructor(e,t){this.getCacheKey=()=>"DeliveryOptionsForCartLineAddress",this.getCacheObjectType=()=>"DeliveryOptionsForCartLineAddress",this.dataCacheType=()=>"none",this.deliveryModeOption=e,this.cartLines=t}}async function l(e,t,r,n,i,o){return i&&void 0!==i?(0,s.getDeliveryOptionsAsync)({callerContext:n},e,i,o,t,r).then((e=>{if(e&&e.length>0){const t=new c(e,!1,void 0,o);return t}{const e=new c([],!0,"No delivery options available",o);return console.log("[_getDeliveryOption] No delivery options available"),e}})).catch((e=>{n.trace(e.message),n.telemetry.exception(e),n.telemetry.debug("[getDeliveryOptionsForCartLineItems]Error executing action");const t=new c([],!0,e.message,o);return console.log("[getDeliveryOptionsForCartLineItems]Error executing action"),t})):(n.trace("[_getDeliveryOption] Not able to get delivery options for cart line"),console.log("[_getDeliveryOption] Not able to get address for cart line"),{})}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-delivery-options-for-cart-line-address",action:async function(e,t){if(!e)throw new Error("[getDeliveryOptionsForCartLineAddress]No valid Input was provided, failing");const r=await(0,i.getCheckoutState)(t),n=r.checkoutCart.cart;if(n&&n.CartLines&&0===n.CartLines.length)return t.trace("[getDeliveryOptionsForCartLineItems] Not able to get cart"),console.log("[getDeliveryOptionsForCartLineItems] Not able to get cart or cartlines are empty"),{};const o=e.cartLines;if(o.length>0){const i=e=>a()(e,(e=>{var t;return null===(t=e.ShippingAddress)||void 0===t?void 0:t.RecordId})),s=i(o);console.log("Group Delivery",s);const c=Object.keys(s).map((async i=>{const o=s[i],a=o.map((e=>void 0!==e.LineId?e.LineId:""));return console.log("Cart Line IDs",a),void 0===o[0].ShippingAddress&&void 0===n.ShippingAddress?l(n.Id,e.deliveryModeOption,!1,t,r.shippingAddress,a):void 0!==n.ShippingAddress?l(n.Id,e.deliveryModeOption,!1,t,n.ShippingAddress,a):l(n.Id,e.deliveryModeOption,!1,t,o[0].ShippingAddress,a)}));return console.log("Delivery Options Promise List",c),Promise.all(c)}return{}},input:(e,t,r)=>(console.log("CreateDeliveryOptionsForCartLineAddressInput",t,r,e),new u(t,r))}),g=d},1095:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>g,CN:()=>c});r(7),r(9);var n=r(2),i=r(26),o=r(30),a=r(6),s=r(96);class c{constructor(e,t){this.getCacheKey=()=>(0,a.buildCacheKey)(`IssueLoyalty-${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"GetIssueLoyalty",this.dataCacheType=()=>"request",this.userAccountNumber=t,this.apiSettings=e}}async function u(e,t){const r=new s.GetLoyaltyCardInput(e.apiSettings);return(0,s.getLoyaltyAction)(r,t)}function l(e,t){e.updateLoyaltyCardId({loyaltyCardNumber:t.CardNumber})}const d=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/issue-loyalty",action:async function(e,t){const r=[(0,i.getCartState)(t),u(e,t)];return Promise.all(r).then((r=>{const n=r[0],i=r[1];return i&&i.CardNumber?(l(n,i),i):(0,o.issueLoyaltyCardAsync)({callerContext:t},{CustomerAccount:e.userAccountNumber||null}).then((e=>(l(n,e),e))).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("Issuing loyalty card failed"),new Error("Issuing loyalty card failed")}))})).catch((e=>{throw t.telemetry.exception(e),t.telemetry.debug("Unable to issue loyalty card"),new Error("Unable to issue loyalty card")}))},input:e=>{const{requestContext:t}=e;if(!t.user.isAuthenticated)throw new Error("Unable to create issue loyalty input.  User is not authenticated.");return new c(e.requestContext.apiSettings)}}),g=d},1096:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,EL:()=>c});r(4);var n=r(5),i=(r(7),r(2)),o=r(83),a=r(43);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class c{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"AddItemToOrderTemplateInput",this.getCacheObjectType=()=>"AddItemToOrderTemplateInput",this.dataCacheType=()=>"none",this.orderTemplateId=e,this.productId=t,this.quantity=r,this.unitOfMeasure=n||"ea",this.isMultipleCatalogFeatureEnabledInHq=i,this.catalogId=o}}const u=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/add-item-to-order-template",action:async function(e,t){try{var r;const c=null!==(r=e.catalogId)&&void 0!==r?r:(0,i.getCatalogId)(t.requestContext);(0,a.validateCatalogId)(c);const u=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({ProductListId:e.orderTemplateId,ProductId:e.productId,Quantity:e.quantity,UnitOfMeasure:e.unitOfMeasure},e.isMultipleCatalogFeatureEnabledInHq&&{catalogId:c}),l=await(0,o.addProductListLinesAsync)({callerContext:t},e.orderTemplateId,[u]);if(l&&1===l.length&&l[0]&&l[0].ProductListId)return l[0];throw t.telemetry.error("Product list line was not returned when adding it to order template"),new Error("Product list line was not returned when adding it to order template")}catch(e){throw t.telemetry.error("Not able to add an item to order template",e),e}},input:(e,t,r,n,i,o,a)=>{const{requestContext:s}=e;if(!s.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new c(t,r,n,i,o||!1,a)}}),l=u},1097:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>g,F3:()=>l});r(4);var n=r(5),i=(r(7),r(2)),o=r(26),a=r(32),s=r(431);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class l{constructor(e,t){this.getCacheKey=()=>"AddOrderTemplateToCartInput",this.getCacheObjectType=()=>"AddOrderTemplateToCartInput",this.dataCacheType=()=>"none",this.orderTemplateId=e,this.isMultipleCatalogFeatureEnabledInHq=t}}const d=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/add-order-template-to-cart",action:async function(e,t){const r=await(0,o.getCartState)(t),n=1e3,i={Paging:{Top:n,Skip:0}},c=new s.F6(e.orderTemplateId,i);let l=await(0,s.vH)(c,t),d=[];for(let i=n;l.lines.length>0;i+=n){const n=l.lines.map((t=>{var r;const n=u({ItemId:null===(r=t.fullProduct)||void 0===r?void 0:r.ProductDetails.ItemId,ProductId:t.productListLine.ProductId,Quantity:t.productListLine.Quantity,TrackingId:"",UnitOfMeasureSymbol:t.productListLine.UnitOfMeasure},e.isMultipleCatalogFeatureEnabledInHq&&{catalogId:t.productListLine.CatalogId});return n}));await(0,a.addCartLinesAsync)({callerContext:t},r.cart.Id,n,r.cart.Version).catch((e=>{var r,n;throw t.telemetry.trace(null===(r=e.data)||void 0===r?void 0:r.ValidationResults),t.telemetry.trace("Unable to add order template to cart."),null===(n=e.data)||void 0===n?void 0:n.ValidationResults})),d=d.concat(n),c.queryResultSettings.Paging.Skip=i,l=await(0,s.vH)(c,t)}return await r.refreshCart({}),d},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new l(t)}}),g=d},1098:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,Fh:()=>a});r(7);var n=r(2),i=r(14),o=r(83);class a{constructor(e){this.getCacheKey=()=>"CreateOrderTemplateInput",this.getCacheObjectType=()=>"CreateOrderTemplateInput",this.dataCacheType=()=>"none",this.templateName=e}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/create-order-template",action:async function(e,t){try{const r={Id:"",Name:e.templateName,ProductListTypeValue:i.ProductListType.OrderTemplate},n=await(0,o.createProductListAsync)({callerContext:t},r);if(n&&""!==n.Id)return n;throw t.telemetry.error("Created product list was null"),new Error("Created product list was null")}catch(e){throw t.telemetry.error("Not able to create order template",e),e}},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new a(t)}}),c=s},1099:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,kz:()=>a});r(7);var n=r(2),i=r(6),o=r(423);class a{constructor(e,t){this.getCacheKey=()=>`GetFullOrderTemplate|${this.orderTemplateId}`,this.getCacheObjectType=()=>"GetFullOrderTemplate",this.dataCacheType=()=>"none",this.orderTemplateId=e,this.queryResultSettings=t}}const s=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/get-full-order-template",action:async function(e,t){if(!t.requestContext.user.isAuthenticated)throw new Error("Unable to get full order template. User is not authenticated.");const r=new i.GetOrderTemplatesInput(e.orderTemplateId),n=await(0,i.getOrderTemplates)(r,t);if(!n||1!==n.length)throw new Error("Unable to get full order template. Order template was not found.");const a=new i.GetPaginatedOrderTemplateLinesInput(n[0].Id,e.queryResultSettings),s=await(0,i.getPaginatedOrderTemplateLinesAction)(a,t);return new o.$(n[0],s.lines,s.totalCount)},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to get full order templates. User is not authenticated.");const n=i.QueryResultSettingsProxy.fromInputData(e).QueryResultSettings;return n.count=!0,new a(t,n)}}),c=s},1100:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s,N0:()=>o});r(7);var n=r(2),i=r(83);class o{constructor(e){this.getCacheKey=()=>"UpdateOrderTemplateHeaderInput",this.getCacheObjectType=()=>"UpdateOrderTemplateHeaderInput",this.dataCacheType=()=>"none",this.orderTemplate=e}}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/update-order-template-header",action:async function(e,t){try{const{orderTemplate:r}=e,n=await(0,i.updateAsync)({callerContext:t},r);if(n)return n;throw t.telemetry.error(`Updated product list ${r.Id} came back as null.`),new Error("Updated product list was null.")}catch(e){throw t.telemetry.error("Not able to update order template",e),e}},input:(e,t)=>{const{requestContext:r}=e;if(!r.user.isAuthenticated)throw new Error("Unable to update order template. User is not authenticated.");return new o(t)}}),s=a},1101:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>c,af:()=>s});r(7),r(12);var n=r(2),i=r(83),o=r(431),a=r(43);class s{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"UpdateOrderTemplateInput",this.getCacheObjectType=()=>"UpdateOrderTemplateInput",this.dataCacheType=()=>"none",this.orderTemplateId=e,this.productId=t,this.quantity=r,this.unitOfMeasure=n||"ea",this.isMultipleCatalogFeatureEnabledInHq=i,this.catalogId=o}}const c=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/order-templates/update-order-template-line",action:async function(e,t){try{if(!t.requestContext.user.isAuthenticated)throw new Error("User token was not found when updating the order template");const r=new o.F6(e.orderTemplateId,{},e.productId.toString()),n=await(0,o.Ay)(r,t);if(!n)throw new Error("Order template was not found when updating the order template");const s=n.lines.filter((t=>t.productListLine.ProductId===e.productId));if(1!==s.length)throw new Error("Unable to find the line to update when updating the order template");const c=e.catalogId;(0,a.validateCatalogId)(c);const u=s[0].productListLine;u.UnitOfMeasure=e.unitOfMeasure,u.Quantity=e.quantity,e.isMultipleCatalogFeatureEnabledInHq&&(u.CatalogId=c);const l=await(0,i.updateProductListLinesAsync)({callerContext:t},e.orderTemplateId,[u]);if(!l||1!==l.length)throw new Error("Server returned invalid lines when updating order template");const d=l.filter((t=>t.ProductId===e.productId));if(1!==d.length||d[0].Quantity!==e.quantity||d[0].UnitOfMeasure!==e.unitOfMeasure)throw new Error("Server did not update the line when updating order template");return d[0]}catch(e){throw t.telemetry.error("Not able to add an item to order template",e),e}},input:(e,t,r,n,i,o,a)=>{const{requestContext:c}=e;if(!c.user.isAuthenticated)throw new Error("Unable to create order template. User is not authenticated.");return new s(t,r,n,i,o||!1,a)}})},1102:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>g,dn:()=>l});r(4);var n,i=r(5),o=(r(7),r(2)),a=r(115),s=r(6),c=r(24);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}!function(e){e[e.None=0]="None",e[e.Phone=1]="Phone",e[e.Email=2]="Email",e[e.Url=3]="Url",e[e.Telex=4]="Telex",e[e.Fax=5]="Fax"}(n||(n={}));class l{constructor(e,t,r,n,i){this.getCacheKey=()=>(0,s.buildCacheKey)(`${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"Customer",this.dataCacheType=()=>"none",this.userAccountNumber=e,this.apiSettings=r,this.customerAttributes=t,this.phone=n,this.vatNumber=i}}const d=(0,o.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/update-customer-attributes",action:async function(e,t){var r;const{customerAttributes:o,phone:s,vatNumber:l,userAccountNumber:d}=e,g=await(0,a.readAsync)({callerContext:t,bypassCache:"get"},d);if(!g)throw t.telemetry.debug("[update-customer-attributes] Unable to find customer"),new Error("Unable to find customer");const y=null===(r=g.Contacts)||void 0===r||null===(r=r.filter((e=>e&&e.IsPrimary&&e.AddressTypeValue===n.Phone)))||void 0===r?void 0:r[0];y&&(y.Value=s);const h=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,i.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},g);h.Phone=s,h.PhoneRecordId=null!=y&&y.RecordId?null==y?void 0:y.RecordId:0,h.VatNumber=l,h.Attributes=o;const p=await(0,a.updateAsync)({callerContext:t},h);if(!p)throw t.telemetry.debug("[update-customer-attributes] Unable to update customer attributes"),new Error("Unable to update customer attributes");return t.update(new c.GetCustomerInput(t.requestContext.apiSettings),p),p}}),g=d},1103:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d,CE:()=>u});r(4);var n=r(5),i=(r(7),r(2)),o=r(115),a=r(6),s=r(24);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}class u{constructor(e,t,r,n){this.getCacheKey=()=>(0,a.buildCacheKey)(`${this.userAccountNumber}`,this.apiSettings),this.getCacheObjectType=()=>"Customer",this.dataCacheType=()=>"none",this.userAccountNumber=e,this.apiSettings=r,this.isOptOut=t,this.preferenceType=n}}const l=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/update-customer-personalization",action:async function(e,t){const{userAccountNumber:r,isOptOut:i,preferenceType:a}=e,u=await(0,o.readAsync)({callerContext:t,bypassCache:"get"},r);if(!u)throw new Error("Unable to find customer");const l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},u);if("web-tracking"===a)l.OptOutWebActivityTracking=i;else l.OptOutPersonalization=i;const d=await(0,o.updateAsync)({callerContext:t},l);if(!d)throw new Error("Unable to update customer");return t.update(new s.GetCustomerInput(t.requestContext.apiSettings),d),d}}),d=l},1108:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});r(4);class n{constructor(){this._values={},this._length=0;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.forEach((e=>{this.setValue(e.key,e.value)}))}removeValue(e){this.hasValue(e)&&(--this._length,delete this._values[e])}getValue(e){return this._values[e]}getValueWithDefaultValue(e,t){return this.hasValue(e)||this.setValue(e,t),this.getValue(e)}setValue(e,t){void 0!==t?(this.hasValue(e)||++this._length,this._values[e]=t):this.removeValue(e)}hasValue(e){return void 0!==this._values[e]}isEmpty(){return 0===this.length}get length(){return this._length}clear(){this._values={},this._length=0}getValues(){return this.getKeys().map((e=>this._values[e]))}getKeys(){return Object.keys(this._values)}getKeyValuePairs(){return this.getKeys().map((e=>({key:e,value:this._values[e]})))}}},1109:(e,t,r)=>{"use strict";r.d(t,{Event:()=>n.J});var n=r(1110),i=r(1216);r.o(i,"ArrayExtensions")&&r.d(t,{ArrayExtensions:function(){return i.ArrayExtensions}}),r.o(i,"DeliveryMode")&&r.d(t,{DeliveryMode:function(){return i.DeliveryMode}}),r.o(i,"DimensionSwatchDisplayTypes")&&r.d(t,{DimensionSwatchDisplayTypes:function(){return i.DimensionSwatchDisplayTypes}}),r.o(i,"DimensionTypes")&&r.d(t,{DimensionTypes:function(){return i.DimensionTypes}}),r.o(i,"EmailRegex")&&r.d(t,{EmailRegex:function(){return i.EmailRegex}}),r.o(i,"EnumExtensions")&&r.d(t,{EnumExtensions:function(){return i.EnumExtensions}}),r.o(i,"FinitePromiseQueue")&&r.d(t,{FinitePromiseQueue:function(){return i.FinitePromiseQueue}}),r.o(i,"FinitePromiseQueueError")&&r.d(t,{FinitePromiseQueueError:function(){return i.FinitePromiseQueueError}}),r.o(i,"InventoryLevelValues")&&r.d(t,{InventoryLevelValues:function(){return i.InventoryLevelValues}}),r.o(i,"InventoryLevels")&&r.d(t,{InventoryLevels:function(){return i.InventoryLevels}}),r.o(i,"ObjectExtensions")&&r.d(t,{ObjectExtensions:function(){return i.ObjectExtensions}}),r.o(i,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return i.OrderTemplate}}),r.o(i,"PasswordRegex")&&r.d(t,{PasswordRegex:function(){return i.PasswordRegex}}),r.o(i,"PhoneRegex")&&r.d(t,{PhoneRegex:function(){return i.PhoneRegex}}),r.o(i,"QueryResultSettingsProxy")&&r.d(t,{QueryResultSettingsProxy:function(){return i.QueryResultSettingsProxy}}),r.o(i,"Random")&&r.d(t,{Random:function(){return i.Random}}),r.o(i,"StringExtensions")&&r.d(t,{StringExtensions:function(){return i.StringExtensions}}),r.o(i,"buildCacheKey")&&r.d(t,{buildCacheKey:function(){return i.buildCacheKey}}),r.o(i,"buildCacheKeyWithUrlTokens")&&r.d(t,{buildCacheKeyWithUrlTokens:function(){return i.buildCacheKeyWithUrlTokens}}),r.o(i,"buildWishlistLine")&&r.d(t,{buildWishlistLine:function(){return i.buildWishlistLine}}),r.o(i,"checkIfShouldDisplayAsSwatch")&&r.d(t,{checkIfShouldDisplayAsSwatch:function(){return i.checkIfShouldDisplayAsSwatch}}),r.o(i,"convertDimensionTypeToProductDimensionType")&&r.d(t,{convertDimensionTypeToProductDimensionType:function(){return i.convertDimensionTypeToProductDimensionType}}),r.o(i,"convertProductDimensionTypeToDimensionTypes")&&r.d(t,{convertProductDimensionTypeToDimensionTypes:function(){return i.convertProductDimensionTypeToDimensionTypes}}),r.o(i,"generateCacheKey")&&r.d(t,{generateCacheKey:function(){return i.generateCacheKey}}),r.o(i,"generateImageUrl")&&r.d(t,{generateImageUrl:function(){return i.generateImageUrl}}),r.o(i,"generateProductImageUrl")&&r.d(t,{generateProductImageUrl:function(){return i.generateProductImageUrl}}),r.o(i,"generateSwatchImageUrl")&&r.d(t,{generateSwatchImageUrl:function(){return i.generateSwatchImageUrl}}),r.o(i,"getAttributeValuesByConfiguration")&&r.d(t,{getAttributeValuesByConfiguration:function(){return i.getAttributeValuesByConfiguration}}),r.o(i,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return i.getCategoryUrl}}),r.o(i,"getDimensionValuesFromQuery")&&r.d(t,{getDimensionValuesFromQuery:function(){return i.getDimensionValuesFromQuery}}),r.o(i,"getFallbackImageUrl")&&r.d(t,{getFallbackImageUrl:function(){return i.getFallbackImageUrl}}),r.o(i,"getInventoryLevelCodeFromDimensionValue")&&r.d(t,{getInventoryLevelCodeFromDimensionValue:function(){return i.getInventoryLevelCodeFromDimensionValue}}),r.o(i,"getInventoryLevelCodeFromProductAvailability")&&r.d(t,{getInventoryLevelCodeFromProductAvailability:function(){return i.getInventoryLevelCodeFromProductAvailability}}),r.o(i,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return i.getInvoiceDetailsPageUrlSync}}),r.o(i,"getProductDetailsCriteriaFromActionInput")&&r.d(t,{getProductDetailsCriteriaFromActionInput:function(){return i.getProductDetailsCriteriaFromActionInput}}),r.o(i,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return i.getProductPageUrlSync}}),r.o(i,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return i.getProductUrlSync}}),r.o(i,"getSelectedProductIdFromActionInput")&&r.d(t,{getSelectedProductIdFromActionInput:function(){return i.getSelectedProductIdFromActionInput}}),r.o(i,"isCartLineItemPickUpType")&&r.d(t,{isCartLineItemPickUpType:function(){return i.isCartLineItemPickUpType}}),r.o(i,"removeDomainQspFromUrl")&&r.d(t,{removeDomainQspFromUrl:function(){return i.removeDomainQspFromUrl}}),r.o(i,"setDimensionValuesToQuery")&&r.d(t,{setDimensionValuesToQuery:function(){return i.setDimensionValuesToQuery}}),r.o(i,"validateCatalogId")&&r.d(t,{validateCatalogId:function(){return i.validateCatalogId}})},1110:(e,t,r)=>{"use strict";r.d(t,{J:()=>n});r(4);class n{constructor(){this._subscribers=[]}subscribe(e){this._subscribers.push(e)}unsubscribe(e){this._subscribers=this._subscribers.filter((t=>t.instanceId!==e))}unsubscribeAll(){this._subscribers=[]}trigger(){this._subscribers.forEach((e=>{e.handler()}))}}},1111:(e,t,r)=>{"use strict";r.d(t,{FinitePromiseQueue:()=>i.W,FinitePromiseQueueError:()=>i.M});var n=r(1217);r.o(n,"DimensionSwatchDisplayTypes")&&r.d(t,{DimensionSwatchDisplayTypes:function(){return n.DimensionSwatchDisplayTypes}}),r.o(n,"DimensionTypes")&&r.d(t,{DimensionTypes:function(){return n.DimensionTypes}}),r.o(n,"EmailRegex")&&r.d(t,{EmailRegex:function(){return n.EmailRegex}}),r.o(n,"FinitePromiseQueue")&&r.d(t,{FinitePromiseQueue:function(){return n.FinitePromiseQueue}}),r.o(n,"FinitePromiseQueueError")&&r.d(t,{FinitePromiseQueueError:function(){return n.FinitePromiseQueueError}}),r.o(n,"OrderTemplate")&&r.d(t,{OrderTemplate:function(){return n.OrderTemplate}}),r.o(n,"PasswordRegex")&&r.d(t,{PasswordRegex:function(){return n.PasswordRegex}}),r.o(n,"PhoneRegex")&&r.d(t,{PhoneRegex:function(){return n.PhoneRegex}}),r.o(n,"QueryResultSettingsProxy")&&r.d(t,{QueryResultSettingsProxy:function(){return n.QueryResultSettingsProxy}}),r.o(n,"Random")&&r.d(t,{Random:function(){return n.Random}}),r.o(n,"buildCacheKey")&&r.d(t,{buildCacheKey:function(){return n.buildCacheKey}}),r.o(n,"buildCacheKeyWithUrlTokens")&&r.d(t,{buildCacheKeyWithUrlTokens:function(){return n.buildCacheKeyWithUrlTokens}}),r.o(n,"buildWishlistLine")&&r.d(t,{buildWishlistLine:function(){return n.buildWishlistLine}}),r.o(n,"checkIfShouldDisplayAsSwatch")&&r.d(t,{checkIfShouldDisplayAsSwatch:function(){return n.checkIfShouldDisplayAsSwatch}}),r.o(n,"convertDimensionTypeToProductDimensionType")&&r.d(t,{convertDimensionTypeToProductDimensionType:function(){return n.convertDimensionTypeToProductDimensionType}}),r.o(n,"convertProductDimensionTypeToDimensionTypes")&&r.d(t,{convertProductDimensionTypeToDimensionTypes:function(){return n.convertProductDimensionTypeToDimensionTypes}}),r.o(n,"generateCacheKey")&&r.d(t,{generateCacheKey:function(){return n.generateCacheKey}}),r.o(n,"generateImageUrl")&&r.d(t,{generateImageUrl:function(){return n.generateImageUrl}}),r.o(n,"generateProductImageUrl")&&r.d(t,{generateProductImageUrl:function(){return n.generateProductImageUrl}}),r.o(n,"generateSwatchImageUrl")&&r.d(t,{generateSwatchImageUrl:function(){return n.generateSwatchImageUrl}}),r.o(n,"getAttributeValuesByConfiguration")&&r.d(t,{getAttributeValuesByConfiguration:function(){return n.getAttributeValuesByConfiguration}}),r.o(n,"getCategoryUrl")&&r.d(t,{getCategoryUrl:function(){return n.getCategoryUrl}}),r.o(n,"getDimensionValuesFromQuery")&&r.d(t,{getDimensionValuesFromQuery:function(){return n.getDimensionValuesFromQuery}}),r.o(n,"getFallbackImageUrl")&&r.d(t,{getFallbackImageUrl:function(){return n.getFallbackImageUrl}}),r.o(n,"getInvoiceDetailsPageUrlSync")&&r.d(t,{getInvoiceDetailsPageUrlSync:function(){return n.getInvoiceDetailsPageUrlSync}}),r.o(n,"getProductDetailsCriteriaFromActionInput")&&r.d(t,{getProductDetailsCriteriaFromActionInput:function(){return n.getProductDetailsCriteriaFromActionInput}}),r.o(n,"getProductPageUrlSync")&&r.d(t,{getProductPageUrlSync:function(){return n.getProductPageUrlSync}}),r.o(n,"getProductUrlSync")&&r.d(t,{getProductUrlSync:function(){return n.getProductUrlSync}}),r.o(n,"getSelectedProductIdFromActionInput")&&r.d(t,{getSelectedProductIdFromActionInput:function(){return n.getSelectedProductIdFromActionInput}}),r.o(n,"isCartLineItemPickUpType")&&r.d(t,{isCartLineItemPickUpType:function(){return n.isCartLineItemPickUpType}}),r.o(n,"removeDomainQspFromUrl")&&r.d(t,{removeDomainQspFromUrl:function(){return n.removeDomainQspFromUrl}}),r.o(n,"setDimensionValuesToQuery")&&r.d(t,{setDimensionValuesToQuery:function(){return n.setDimensionValuesToQuery}}),r.o(n,"validateCatalogId")&&r.d(t,{validateCatalogId:function(){return n.validateCatalogId}});var i=r(1112);r(926)},1112:(e,t,r)=>{"use strict";r.d(t,{M:()=>n,W:()=>o});r(7);var n,i=r(926);!function(e){e.InvalidMaxQueueLengthPassed="Invalid maxQueueLength value passed to FinitePromiseQueue. maxQueueLength should be more or equal to 2.",e.ProcessWasDiscardedFromTheQueue="The process was discarded from FinitePromiseQueue."}(n||(n={}));class o extends i.T{constructor(e){if(e<2)throw new Error(n.InvalidMaxQueueLengthPassed);super(),this._maxQueueLength=e}async enqueue(e){let t=this._queue.length;if(this._isBusy&&++t,t===this._maxQueueLength){const e=this._queue.shift();e&&e.reject(n.ProcessWasDiscardedFromTheQueue)}return super.enqueue(e)}}},1113:(e,t,r)=>{"use strict";r.d(t,{o:()=>y});r(105),r(106),r(107),r(108);var n,i=new Uint8Array(16);function o(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}r(12),r(15);const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const s=function(e){return"string"==typeof e&&a.test(e)};for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!s(r))throw TypeError("Stringified UUID is invalid");return r};const d=function(e,t,r){e=e||{};var n=e.random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)};var g,y;!function(e){e.generateGuid=function(){return d()}}(g||(g={})),function(e){e.Guid=g}(y||(y={}))},1114:(e,t,r)=>{"use strict";r.d(t,{eT:()=>n,Lq:()=>i,il:()=>o});class n{static get defaultRegex(){return n.html5EmailRegex}}n.html5EmailRegex=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class i{}i.defaultRegex=/^((?=.*[a-z])(?=.*[A-Z])(?=.*\d)|(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9])|(?=.*[a-z])(?=.*\d)(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]))([A-Za-z\d@#$%^&*\-_+=[\]{}|\\:',?/`~'();!]|\.(?!@)){8,16}$/;class o{}o.defaultRegex="^$|^[- +()]*[0-9][- +()0-9]*$"},1119:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>s});r(7),r(4),r(9);var n=r(2),i=r(284);function o(e,t){return e.Addresses=e.Addresses||[],t.IsPrimary&&e.Addresses.forEach((e=>e.IsPrimary=!1)),e.Addresses=[...e.Addresses.filter((e=>e.RecordId!==t.RecordId)),t],e}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/update-address",action:async function(e,t){return(0,i.qo)(e,t,o)},input:i._0}),s=a},1120:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>d});r(4);var n=r(5),i=(r(7),r(9),r(2)),o=r(115),a=r(284),s=r(24);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const l=(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/update-primary-address",action:async function(e,t){var r;const{address:n}=e,i=await(0,o.readAsync)({callerContext:t,bypassCache:"get"},"");if(!i)throw new Error("Unable to find customer");i.Addresses=g(u({},n),[...null!==(r=i.Addresses)&&void 0!==r?r:[]]);const a=await(0,o.updateAsync)({callerContext:t},i);if(!a)throw new Error("Unable to update customer");return t.update(new s.GetCustomerInput(t.requestContext.apiSettings),a),a.Addresses||[]},input:a._0,isBatched:!1}),d=l,g=(e,t)=>t.map((t=>(t.RecordId===e.RecordId?t.IsPrimary=!0:t.IsPrimary=!1,t)))},1214:(e,t,r)=>{"use strict";r.d(t,{Y:()=>n});r(9);var n,i=r(649);!function(e){function t(e){return!i._.isNullOrUndefined(e)&&e.length>0}function r(e){return t(e)?e.filter((e=>!i._.isNullOrUndefined(e))):[]}e.hasElements=t,e.firstOrDefault=function(e,r){return t(e)?e[0]:r},e.unique=function(e){return t(e)?Array.from(new Set(e)):[]},e.all=function(e,r){return!t(e)||e.filter(r).length===e.length},e.validValues=r,e.flatten=function(e){let n=[];if(!t(e))return n;for(const t of e)i._.isNullOrUndefined(t)||(n=n.concat(r(t)));return n},e.equals=function(e,t,r){if(e.length!==t.length)return!1;if(void 0===r)return JSON.stringify(e)===JSON.stringify(t);for(let n=0;n<e.length;++n)if(!r(e[n],t[n]))return!1;return!0},e.haveSameItems=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e.length!==t.length)return!1;for(const n of e)if(!t.some((e=>r(n,e))))return!1;return!0},e.calculateSum=function(e){let t=e[0];for(let r=1;r<e.length;++r)t+=e[r];return t},e.reverse=function(e){const t=[];for(let r=e.length-1;r>=0;--r)t.push(e[r]);return t}}(n||(n={}))},1215:()=>{},1216:()=>{},1217:()=>{},1218:(e,t,r)=>{"use strict";r(4);var n=r(5),i=(r(7),r(2));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}(0,i.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/checkout",action:async function(e,t){const{apiSettings:r}=t.requestContext,n=`${r.baseUrl}Commerce/Carts('${e.cartId}')/Checkout?api-version=7.3`,o={headers:{oun:r.oun,"Content-Type":"application/json"}};o.headers&&t.requestContext.user.token&&(o.headers.Authorization=`id_token ${t.requestContext.user.token}`),e.cartTenderLines&&e.cartTenderLines.length>0&&(e.cartTenderLines=e.cartTenderLines.map((t=>{if(t["@odata.type"]="#Microsoft.Dynamics.Commerce.Runtime.DataModel.CartTenderLine",t["Amount@odata.type"]="#Decimal",t.TokenizedPaymentCard&&(t.TokenizedPaymentCard["@odata.type"]="#Microsoft.Dynamics.Commerce.Runtime.DataModel.TokenizedPaymentCard",t.TokenizedPaymentCard.House||(t.TokenizedPaymentCard.House="N/A"),t.TokenizedPaymentCard.CardTokenInfo&&(t.TokenizedPaymentCard.CardTokenInfo["@odata.type"]="#Microsoft.Dynamics.Commerce.Runtime.DataModel.CardTokenInfo"),e.billingAddress)){const{Phone:r,ThreeLetterISORegionName:n="",Street:i,City:o,State:s,ZipCode:c}=e.billingAddress;t.TokenizedPaymentCard=a(a({},t.TokenizedPaymentCard),{},{Phone:r,Country:n.toUpperCase(),Address1:i,City:o,State:s,Zip:c})}return t})));const s=a({receiptEmail:e.receiptEmail,cartVersion:e.cartVersion||null},e.cartTenderLines&&{cartTenderLines:e.cartTenderLines});return(0,i.sendCommerceRequest)(n,"post",s,o).then((e=>{if(e.status>=200&&e.status<300&&e.data)return e.data;if(e.data)throw e.data;throw new Error("[checkOutAction] Invalid response recieved from RetailServer")}))}})},1219:(e,t,r)=>{"use strict";r(7),r(9);var n=r(2),i=r(284);function o(e,t){return e.Addresses=e.Addresses||[],e.Addresses=[...e.Addresses.filter((e=>e.RecordId!==t.RecordId))],e}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/delete-address",action:async function(e,t){return(0,i.qo)(e,t,o)},input:i._0,isBatched:!1})},1243:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(26),o=r(32),a=r(938),s=r.n(a),c=r(46);class u{constructor(e){this.getCacheKey=()=>(0,c.S1)("ActiveCheckoutCart",this.apiSettings),this.getCacheObjectType=()=>"ActiveCheckoutCart",this.dataCacheType=()=>"request",this.apiSettings=e}}const l=n.msdyn365Commerce.CartCookie||"cart";(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-checkout-cart",action:async function(e,t){const r=s().get(l)||"";if(r){const e=await(0,i.getCartState)(t),r=e.cart;if(r&&Object.keys(r).length>0){const e=await(0,o.copyAsync)({callerContext:t},r.Id,2);if(e)return Array.isArray(e)?e[0]:e}else t.trace("[get-checkout-cart] Can't create a checkout cart since active cart is empty")}return{}},input:e=>new u(e.requestContext.apiSettings)})},1244:(e,t,r)=>{"use strict";var n=r(2),i=r(14),o=r(30);(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-customer-loyalty-cards",action:i.retailAction,input:e=>{if(e.requestContext&&e.requestContext.user&&e.requestContext.user.isAuthenticated)return(0,o.createGetCustomerLoyaltyCardsInput)({},null);throw new Error("Unable to create order history input.  User is not authenticated.")}})},1245:(e,t,r)=>{"use strict";r.d(t,{A0:()=>o,Ay:()=>a});r(7),r(12);var n=r(2),i=r(14);class o{constructor(e,t){this.getCacheKey=()=>"ProductList",this.getCacheObjectType=()=>"ProductList",this.dataCacheType=()=>"none",this.shouldCacheOutput=()=>!1,this.productListId=e||"",this.queryResultSettings=t}}const a=(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-product-list",action:async function(e,t){const r=i.ProductListType.QuickOrder.toString(),n={ProductListType:r},o=await i.ProductListsDataActions.searchAsync({callerContext:t,queryResultSettings:e.queryResultSettings},n).then((e=>e));return o},input:(e,t,r)=>{const{requestContext:n}=e;if(!n.user.isAuthenticated)throw new Error("Unable to create get product list. User is not authenticated.");return new o(t||"",r)}})},1246:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(34),o=r(208),a=r(36),s=r(46);class c{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"FullProductsRefineSearchByCategoryInputCache",this.getCacheObjectType=()=>"FullProductsRefineSearchByCategoryInput",this.dataCacheType=()=>"none",this.queryResultSettingsProxy=e,this.categoryId=t,this.channelId=r,this.refinementCriteria=n||[],this.catalogId=null!=i?i:0,this.ProductDetailsCriteria=o}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-full-products-by-refine-search-category",action:async function(e,t){if(!e||!e.refinementCriteria)return t.trace("[getFullProductsByRefineSearchCategoryAction] Invalid input."),{};const r=e.queryResultSettingsProxy.QueryResultSettings&&e.queryResultSettingsProxy.QueryResultSettings.Sorting&&e.queryResultSettingsProxy.QueryResultSettings.Sorting.Columns&&e.queryResultSettingsProxy.QueryResultSettings.Sorting.Columns.length>0;if(0===e.refinementCriteria.length&&!r)return t.telemetry.trace("[getFullProductsByRefineSearchCategoryAction] No refiners or sorting specified."),{};const{apiSettings:a}=t.requestContext,s=(0,n.getCatalogId)(t.requestContext);let c=[];const u=await(0,i.refineSearchByCategoryAsync)({callerContext:t,queryResultSettings:e.queryResultSettingsProxy.QueryResultSettings},e.channelId||0,e.catalogId||s,e.categoryId||0,e.refinementCriteria).then((r=>(c=e.refinementCriteria,r.map((r=>new o.Tj(r.RecordId,a,e.ProductDetailsCriteria||new o.Pe,t.requestContext))))));if(u.length>0){const e=await(0,o.Ay)(u,t);return{productSearchResult:e,refinementCriteria:c}}return{productSearchResult:[],refinementCriteria:c}},input:e=>{const t=e.config&&e.config.refinementCriteria,r=a.l.fromInputData(e);if(!Array.isArray(t))return new c(r);if(e&&e.requestContext&&e.requestContext.query&&e.requestContext.query.categoryId){const n=Number(e.requestContext.query.categoryId),i=e.requestContext.apiSettings.channelId,o=(0,s.nr)(e);return new c(r,n,+i,t,void 0,o)}throw new Error("Please specify categoryId, refinerId, and refinerSourceValue query string in request.")},isBatched:!1})},1247:(e,t,r)=>{"use strict";var n=r(2),i=r(34),o=r(925),a=r(36),s=(r(7),r(208));var c=r(46);class u{constructor(e,t,r,n,i,o){this.getCacheKey=()=>"FullProductsRefineSearchByTextInputCache",this.getCacheObjectType=()=>"FullProductsRefineSearchByTextInput",this.dataCacheType=()=>"none",this.queryResultSettingsProxy=e,this.searchText=t||"",this.channelId=r,this.refinementCriteria=n||[],this.catalogId=null!=i?i:0,this.productDetailsCriteria=o}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-full-products-by-refine-search-text",action:function(e,t){const r=(0,n.getCatalogId)(t.requestContext);return async function(e,t,r){if(!e||!e.refinementCriteria)return t.trace("[getFullProductsByRefineSearchCategoryAction] Invalid input."),{};if(0===e.refinementCriteria.length)return t.trace("[getFullProductsByRefineSearchCategoryAction] No refiners specified."),{};const{apiSettings:n}=t.requestContext;let i=[];const o=await r();if(o?i=o.map((r=>new s.Tj(r.RecordId,n,e.productDetailsCriteria||new s.Pe,t.requestContext))):t.telemetry.error("[getFullProductsByRefineSearchCategoryAction] no searchResults returned"),i.length>0){const r=await(0,s.Ay)(i,t);return{productSearchResult:r,refinementCriteria:e.refinementCriteria}}return{productSearchResult:[],refinementCriteria:e.refinementCriteria}}(e,t,(()=>(0,i.refineSearchByTextAsync)({callerContext:t,queryResultSettings:e.queryResultSettingsProxy.QueryResultSettings},e.channelId||0,e.catalogId||r,e.searchText,e.refinementCriteria)))},input:e=>{const t=e.config&&e.config.refinementCriteria,r=a.l.fromInputData(e);if(!Array.isArray(t))return new u(r);const n=(0,o.o)(e),i=(0,c.nr)(e);return new u(r,n.q,n.channelId,t,void 0,i)},isBatched:!1})},1248:(e,t,r)=>{"use strict";var n=r(2),i=r(14),o=r(115);(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-order-history",action:i.retailAction,input:e=>{if(e.requestContext&&e.requestContext.user&&e.requestContext.user.isAuthenticated)return(0,o.createGetOrderShipmentsHistoryInput)({Paging:{Top:100,Skip:0}},null);throw new Error("Unable to create order history input.  User is not authenticated.")}})},1249:(e,t,r)=>{"use strict";var n=r(2),i=r(14),o=r(88);(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-org-unit-configuration",action:i.retailAction,input:()=>(0,o.createGetOrgUnitConfigurationInput)()})},1250:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(34),o=r(285),a=r(279),s=r(36),c=r(46);class u{constructor(e,t,r){this.getCacheKey=()=>(0,c.hz)(this.apiSettings,{key:"CategoryId",value:this.categoryId||this.categorySlug},{key:"CatalogId",value:this.catalogId},{key:"QueryResultSettingsCacheKeyHint",value:this.queryResultSettingsProxy.cacheKeyHint}),this.getCacheObjectType=()=>"Products-From-Search",this.dataCacheType=()=>"application",this.apiSettings=t,this.currentCategory=e,this.queryResultSettingsProxy=r,this.catalogId=t.catalogId,this.categoryId=e.categoryId,this.categorySlug=e.categorySlug}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-products-by-category",action:async function(e,t){const{apiSettings:r}=t.requestContext;let n=e.currentCategory.categoryId;if(e.currentCategory.categorySlug&&!n){const r=await(0,o.default)(e.currentCategory,t);if(!r)return t.trace("[getProductsByCategoryAction] Unable to find category"),[];n=r.RecordId}const s=await(0,i.searchByCategoryAsync)({callerContext:t,queryResultSettings:e.queryResultSettingsProxy.QueryResultSettings},+r.channelId,e.catalogId,n||0).then((e=>e.map((e=>new a.M$(e.RecordId,r,void 0,void 0,t.requestContext)))));return s.length>0?await(0,a.Ay)(s,t):[]},input:e=>{if(e&&e.requestContext){const t=new o.CurrentCategoryInput(e.requestContext),r=s.l.fromInputData(e);return new u(t,e.requestContext.apiSettings,r)}throw new Error("Please specify categoryId query string in request.")}})},1251:(e,t,r)=>{"use strict";r.d(t,{f:()=>n});class n{constructor(e,t,r){this.getCacheKey=()=>`${this.productId}-${this.tenantId}`,this.getCacheObjectType=()=>"RatingsSummary",this.dataCacheType=()=>"application",this.productId=e,this.tenantId=t,this.serviceEndpoint=r}}},1252:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(34),o=r(285),a=r(43),s=r(36);class c{constructor(e,t,r){this.getCacheKey=()=>(0,a.generateCacheKey)(void 0,{key:"CategoryKey",value:this.currentCategory.getCacheKey()},{key:"CatalogId",value:this.catalogId},{key:"QueryResultSettingsCacheKeyHint",value:this.queryResultSettingsProxy.cacheKeyHint}),this.getCacheObjectType=()=>"ProductRefiner",this.shouldCacheOutput=()=>!0,this.queryResultSettingsProxy=t,this.catalogId=r||0,this.currentCategory=e}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-refiners-by-category",action:async function(e,t){let r=e.currentCategory.categoryId;if(e.currentCategory.categorySlug&&!r){const n=await(0,o.default)(e.currentCategory,t);if(!n)return t.trace("[getRefinersByCategoryAction] Unable to find category"),[];r=n.RecordId}return(0,i.getRefinersByCategoryAsync)({callerContext:t,queryResultSettings:e.queryResultSettingsProxy.QueryResultSettings},e.catalogId,r||0)},input:e=>{if(e&&e.requestContext){const t=(0,n.getCatalogId)(e.requestContext),r=new o.CurrentCategoryInput(e.requestContext);return new c(r,s.l.fromInputData(e),t)}throw new Error("Please specify categoryId query string in request.")}})},1253:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(34),o=r(925),a=r(36),s=r(46);class c{constructor(e,t,r,n){this.getCacheKey=()=>(0,s.hz)(this.apiSettings,{key:"SearchText",value:this.searchText},{key:"CatalogId",value:this.catalogId},{key:"QueryResultSettingsCacheKeyHint",value:this.queryResultSettingsProxy.cacheKeyHint}),this.getCacheObjectType=()=>"ProductRefiner",this.dataCacheType=()=>"request",this.catalogId=t,this.searchText=e,this.queryResultSettingsProxy=r,this.apiSettings=n}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-refiners-by-text",action:async function(e,t){return(0,i.getRefinersByTextAsync)({callerContext:t,queryResultSettings:e.queryResultSettingsProxy.QueryResultSettings},e.catalogId,e.searchText)},input:e=>{const t=(0,o.o)(e),r=e.config?Number(e.config.catalogId):0;return new c(t.q,Number.isNaN(r)?0:r,a.l.fromInputData(e),e.requestContext.apiSettings)}})},1254:(e,t,r)=>{"use strict";r(7),r(4);var n=r(2),i=r(34),o=r(208),a=r(36),s=r(46);class c{constructor(e,t,r,n,i){this.getCacheKey=()=>(0,s.hz)(void 0,{key:"ProductId",value:this.productId},{key:"CatalogId",value:this.catalogId},{key:"RelationType",value:this.relationType.toLowerCase()},{key:"QueryResultSettingsCacheKeyHint",value:this.queryResultSettingsProxy.cacheKeyHint},{key:"ShouldGetPrice",value:this.ProductDetailsCriteria.getPrice}),this.getCacheObjectType=()=>"GetRelatedProducts",this.dataCacheType=()=>"none",this.productId=e,this.catalogId=t,this.relationType=r,this.queryResultSettingsProxy=n,this.ProductDetailsCriteria=i}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-related-products",action:async function(e,t){const r=t.requestContext.apiSettings,n=e.queryResultSettingsProxy.QueryResultSettings,a=await(0,i.getRelationTypesAsync)({callerContext:t,queryResultSettings:n},e.productId,+r.channelId,e.catalogId);if(!a)return t.trace(`[getProductRelationType] Unable to get product relation types for product ${e.productId}`),[];const s=function(e,t){let r;return t=t.toLowerCase(),e.forEach((e=>{e.Name&&e.Name.toLowerCase()===t&&(r=e.RecordId)})),r}(a,e.relationType);if(!s)return t.trace(`[getRelatedProducts] Unable to find relation type ${e.relationType} for product ${e.productId}`),[];const c=await(0,i.getRelatedProductsAsync)({callerContext:t,queryResultSettings:n},e.productId,+r.channelId,e.catalogId,s).then((n=>n&&n.length>0?n.map((n=>new o.Tj(n.RecordId,r,e.ProductDetailsCriteria,t.requestContext))):(t.trace("[getRelatedProductsAction] Invalid response from server"),[]))).catch((e=>(t.trace(e.message),t.trace(e.stack||""),t.telemetry.exception(e),t.telemetry.debug("[getRelatedProductsAction] Unable to Fetch Products."),t.trace("[getRelatedProductsAction] Unable to Fetch Products."),[])));return c.length>0?(0,o.Ay)(c,t):[]},input:e=>{if(e&&e.requestContext&&e.config){const t=(0,n.getCatalogId)(e.requestContext),r=e.config.relationType;let i=e.requestContext.urlTokens?Number(e.requestContext.urlTokens.recordId):0;const o=(0,s.nr)(e);if(!r)throw new Error("Input relation type is invalid.");if(e.requestContext.query&&e.requestContext.query.productId&&(i=Number(e.requestContext.query.productId)),Number.isNaN(i)||i<=0)throw new Error("No valid product id available in url or query string.");const u=a.l.fromInputData(e);return new c(i,t,r,u,o)}throw new Error("Invalid input data or request context")}})},1255:(e,t,r)=>{"use strict";r(7);var n=r(2),i=r(30),o=r(6);class a{constructor(e){this.getCacheKey=()=>(0,o.buildCacheKey)("SearchConfig",this.apiSettings),this.getCacheObjectType=()=>"SearchConfiguration",this.dataCacheType=()=>"request",this.apiSettings=e}}(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/get-search-configurations",action:async function(e,t){return(0,i.getSearchConfigurationAsync)({callerContext:t})},input:e=>new a(e.requestContext.apiSettings)})},1256:(e,t,r)=>{"use strict";var n=r(2),i=r(34),o=r(65),a=r(36);r(46);(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/regin-search-by-category",action:o.S_,input:e=>{const t=e.config&&e.config.refinementCriteria;if(e&&e.requestContext&&e.requestContext.query&&e.requestContext.query.categoryId)return(0,i.createRefineSearchByCategoryInput)(a.l.fromInputData(e).QueryResultSettings,+e.requestContext.apiSettings.channelId,e.config?Number(e.config.catalogId):0,+e.requestContext.query.categoryId,Array.isArray(t)?t.map((e=>e)):[]);throw new Error("Please specify categoryId, refinerId, and refinerSourceValue query string in request.")}})},1257:(e,t,r)=>{"use strict";var n=r(2),i=r(14),o=r(34),a=r(36);(0,n.createObservableDataAction)({id:"@msdyn365-commerce-modules/retail-actions/search-by-text",action:i.retailAction,input:function(e){const{requestContext:{query:t,apiSettings:{channelId:r}}}=e,n=t&&t.q;if(!n)throw new Error("Unable to preform search without search text. Query string ?q={searchText} must be present or should be configued in module data.");const i=a.l.fromInputData(e);return(0,o.createSearchByTextInput)(i.QueryResultSettings,Number(r),0,n)}})}}]);
//# sourceMappingURL=b05710d8b4128fcfcc25.bundle.js.map